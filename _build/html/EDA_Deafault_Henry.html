
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Parcial práctico 2 Machine Learning &#8212; Parcial 2</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'EDA_Deafault_Henry';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Ejercicio 3" href="Ejercicio3.html" />
    <link rel="prev" title="Velocidad del viento" href="windspeedEDA.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Parcial 2 - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Parcial 2 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Parcial 2
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="windspeedEDA.html">Velocidad del viento</a></li>




<li class="toctree-l1 current active"><a class="current reference internal" href="#">Parcial práctico 2 Machine Learning</a></li>


<li class="toctree-l1"><a class="reference internal" href="Ejercicio3.html">Ejercicio 3</a></li>

<li class="toctree-l1"><a class="reference internal" href="ML2_Default_Test_HENRY.html">Codificación de variables categóricas</a></li>




</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FEDA_Deafault_Henry.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/EDA_Deafault_Henry.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Parcial práctico 2 Machine Learning</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Parcial práctico 2 Machine Learning</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#henry-saenz-kelly-beltran">Henry Saenz &amp; Kelly Beltrán</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-descriptivo-de-default-probability-prediction">Análisis descriptivo de <code class="docutils literal notranslate"><span class="pre">Default</span> <span class="pre">Probability</span> <span class="pre">Prediction</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importacion-de-librerias">Importación de librerías</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#carga-de-archivos">Carga de archivos</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-exploratorio-de-los-datos-eda">Análisis Exploratorio de los Datos (EDA)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cambiar-nombre">Cambiar nombre</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#concatenar-conjuntos-de-datos">Concatenar conjuntos de datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-datos-faltantes">Anàlisis de datos faltantes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#identificar-variables-con-ausencia-de-datos-superior-a-50">Identificar variables con ausencia de datos superior a 50%</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matriz-de-datos-faltantes-por-grupo">Matriz de datos faltantes por grupo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#top-10-variables-faltantes-por-grupo">Top 10 Variables faltantes por grupo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-dentro-del-grupo">Comparación dentro del grupo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-de-normalidad">Prueba de normalidad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-entre-grupos">Comparación entre grupos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#test-de-kruskal-wallis-para-diferencia-entre-grupos"><strong>Test de Kruskal-Wallis para diferencia entre grupos</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tratamiento-de-datos-faltantes-por-grupo">Tratamiento de datos faltantes por grupo</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imputacion-de-datos-faltantes">Imputaciòn de datos faltantes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#identificar-variables-categoricas-previo-a-la-imputacion-de-datos">Identificar variables categóricas previo a la imputación de datos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#imputacion-de-datos-categoricos">Imputacion de datos categoricos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#imputacion-de-variables-numericas">Imputación de variables numéricas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inputacion-de-datos-numericos">Inputacion de datos numericos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verificacion-de-multicolinealidad"><strong>Verificación de multicolinealidad</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#correlaciones-entre-variables"><em><strong>Correlaciones entre variables</strong></em></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#correlaciones-numericas">Correlaciones numéricas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#vif-factor-de-inflacion-de-la-varianza">VIF - Factor de inflación de la varianza</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Verificación de multicolinealidad</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-exploratorio-de-los-datos">Análisis Exploratorio de los datos</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-descriptiva">Visualización descriptiva</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variable-objetivo">Variable Objetivo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-predictoras-numericas">Variables predictoras numéricas</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#para-el-grupo-payment">Para el grupo <code class="docutils literal notranslate"><span class="pre">Payment</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#para-el-grupo-spend">Para el grupo <code class="docutils literal notranslate"><span class="pre">spend</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#para-el-grupo-risk">Para el grupo <code class="docutils literal notranslate"><span class="pre">Risk</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#para-el-grupo-balance">Para el grupo <code class="docutils literal notranslate"><span class="pre">Balance</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#para-el-grupo-delinquency">Para el grupo <code class="docutils literal notranslate"><span class="pre">Delinquency</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="parcial-practico-2-machine-learning">
<h1>Parcial práctico 2 Machine Learning<a class="headerlink" href="#parcial-practico-2-machine-learning" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="henry-saenz-kelly-beltran">
<h1>Henry Saenz &amp; Kelly Beltrán<a class="headerlink" href="#henry-saenz-kelly-beltran" title="Link to this heading">#</a></h1>
<section id="analisis-descriptivo-de-default-probability-prediction">
<h2>Análisis descriptivo de <code class="docutils literal notranslate"><span class="pre">Default</span> <span class="pre">Probability</span> <span class="pre">Prediction</span></code><a class="headerlink" href="#analisis-descriptivo-de-default-probability-prediction" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Descripción de tipos de variables</p></li>
<li><p>Reducción de nombres extensos en columnas</p></li>
<li><p>calcular número de
observaciones, media, desviación estándar, mínimo, máximo, cuartiles</p></li>
<li><p>Realizar conteo de datos
faltantes y su porcentaje</p></li>
<li><p>histograma o diagrama de barras para la variable respuesta e independientes según corresponda, seleccionar un mínimo de 10 variables independientes, para este análisis.
Análisis de simetría, datos atípicos y dispersión, etc,… por medio de boxplot(). Análisis bivariado.
Trazado de scatterplot() y regplot() para un mínimo de 10 pares de variables explicativas. En cada
figura agregar un análisis y descripción.</p></li>
</ul>
</section>
<section id="importacion-de-librerias">
<h2>Importación de librerías<a class="headerlink" href="#importacion-de-librerias" title="Link to this heading">#</a></h2>
<p>Se realiza la instalación y carga respectiva de las librerías necesarias para la limpieza, análisis, visualización, estandarización, escalamiento, inspección, etc. De los datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">statsmodels</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">sklearn</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">dask</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">tabulate</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">missingno</span> <span class="n">dask</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">dask</span><span class="p">[</span><span class="n">dataframe</span><span class="p">]</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">ace_tools</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: statsmodels in /usr/local/lib/python3.10/dist-packages (0.14.4)
Requirement already satisfied: numpy&lt;3,&gt;=1.22.3 in /usr/local/lib/python3.10/dist-packages (from statsmodels) (1.26.4)
Requirement already satisfied: scipy!=1.9.2,&gt;=1.8 in /usr/local/lib/python3.10/dist-packages (from statsmodels) (1.13.1)
Requirement already satisfied: pandas!=2.1.0,&gt;=1.4 in /usr/local/lib/python3.10/dist-packages (from statsmodels) (2.2.2)
Requirement already satisfied: patsy&gt;=0.5.6 in /usr/local/lib/python3.10/dist-packages (from statsmodels) (0.5.6)
Requirement already satisfied: packaging&gt;=21.3 in /usr/local/lib/python3.10/dist-packages (from statsmodels) (24.1)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas!=2.1.0,&gt;=1.4-&gt;statsmodels) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas!=2.1.0,&gt;=1.4-&gt;statsmodels) (2024.2)
Requirement already satisfied: tzdata&gt;=2022.7 in /usr/local/lib/python3.10/dist-packages (from pandas!=2.1.0,&gt;=1.4-&gt;statsmodels) (2024.2)
Requirement already satisfied: six in /usr/local/lib/python3.10/dist-packages (from patsy&gt;=0.5.6-&gt;statsmodels) (1.16.0)
Collecting sklearn
  Using cached sklearn-0.0.post12.tar.gz (2.6 kB)
  <span class=" -Color -Color-Bold -Color-Bold-Red">error</span>: <span class=" -Color -Color-Bold">subprocess-exited-with-error</span>
  
  <span class=" -Color -Color-Red">×</span> <span class=" -Color -Color-Green">python setup.py egg_info</span> did not run successfully.
  <span class=" -Color -Color-Red">│</span> exit code: <span class=" -Color -Color-Bold -Color-Bold-Cyan">1</span>
  <span class=" -Color -Color-Red">╰─&gt;</span> See above for output.
  
  <span class=" -Color -Color-Bold -Color-Bold-Magenta">note</span>: This error originates from a subprocess, and is likely not a problem with pip.
  Preparing metadata (setup.py) ... ?25l?25herror
<span class=" -Color -Color-Bold -Color-Bold-Red">error</span>: <span class=" -Color -Color-Bold">metadata-generation-failed</span>

<span class=" -Color -Color-Red">×</span> Encountered error while generating package metadata.
<span class=" -Color -Color-Red">╰─&gt;</span> See above for output.

<span class=" -Color -Color-Bold -Color-Bold-Magenta">note</span>: This is an issue with the package mentioned above, not pip.
<span class=" -Color -Color-Bold -Color-Bold-Cyan">hint</span>: See above for details.
Requirement already satisfied: dask in /usr/local/lib/python3.10/dist-packages (2024.8.2)
Requirement already satisfied: click&gt;=8.1 in /usr/local/lib/python3.10/dist-packages (from dask) (8.1.7)
Requirement already satisfied: cloudpickle&gt;=3.0.0 in /usr/local/lib/python3.10/dist-packages (from dask) (3.1.0)
Requirement already satisfied: fsspec&gt;=2021.09.0 in /usr/local/lib/python3.10/dist-packages (from dask) (2024.6.1)
Requirement already satisfied: packaging&gt;=20.0 in /usr/local/lib/python3.10/dist-packages (from dask) (24.1)
Requirement already satisfied: partd&gt;=1.4.0 in /usr/local/lib/python3.10/dist-packages (from dask) (1.4.2)
Requirement already satisfied: pyyaml&gt;=5.3.1 in /usr/local/lib/python3.10/dist-packages (from dask) (6.0.2)
Requirement already satisfied: toolz&gt;=0.10.0 in /usr/local/lib/python3.10/dist-packages (from dask) (0.12.1)
Requirement already satisfied: importlib-metadata&gt;=4.13.0 in /usr/local/lib/python3.10/dist-packages (from dask) (8.5.0)
Requirement already satisfied: zipp&gt;=3.20 in /usr/local/lib/python3.10/dist-packages (from importlib-metadata&gt;=4.13.0-&gt;dask) (3.20.2)
Requirement already satisfied: locket in /usr/local/lib/python3.10/dist-packages (from partd&gt;=1.4.0-&gt;dask) (1.0.0)
Requirement already satisfied: tabulate in /usr/local/lib/python3.10/dist-packages (0.9.0)
Requirement already satisfied: missingno in /usr/local/lib/python3.10/dist-packages (0.5.2)
Requirement already satisfied: dask in /usr/local/lib/python3.10/dist-packages (2024.8.2)
Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from missingno) (1.26.4)
Requirement already satisfied: matplotlib in /usr/local/lib/python3.10/dist-packages (from missingno) (3.7.1)
Requirement already satisfied: scipy in /usr/local/lib/python3.10/dist-packages (from missingno) (1.13.1)
Requirement already satisfied: seaborn in /usr/local/lib/python3.10/dist-packages (from missingno) (0.13.2)
Requirement already satisfied: click&gt;=8.1 in /usr/local/lib/python3.10/dist-packages (from dask) (8.1.7)
Requirement already satisfied: cloudpickle&gt;=3.0.0 in /usr/local/lib/python3.10/dist-packages (from dask) (3.1.0)
Requirement already satisfied: fsspec&gt;=2021.09.0 in /usr/local/lib/python3.10/dist-packages (from dask) (2024.6.1)
Requirement already satisfied: packaging&gt;=20.0 in /usr/local/lib/python3.10/dist-packages (from dask) (24.1)
Requirement already satisfied: partd&gt;=1.4.0 in /usr/local/lib/python3.10/dist-packages (from dask) (1.4.2)
Requirement already satisfied: pyyaml&gt;=5.3.1 in /usr/local/lib/python3.10/dist-packages (from dask) (6.0.2)
Requirement already satisfied: toolz&gt;=0.10.0 in /usr/local/lib/python3.10/dist-packages (from dask) (0.12.1)
Requirement already satisfied: importlib-metadata&gt;=4.13.0 in /usr/local/lib/python3.10/dist-packages (from dask) (8.5.0)
Requirement already satisfied: zipp&gt;=3.20 in /usr/local/lib/python3.10/dist-packages (from importlib-metadata&gt;=4.13.0-&gt;dask) (3.20.2)
Requirement already satisfied: locket in /usr/local/lib/python3.10/dist-packages (from partd&gt;=1.4.0-&gt;dask) (1.0.0)
Requirement already satisfied: contourpy&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib-&gt;missingno) (1.3.0)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib-&gt;missingno) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib-&gt;missingno) (4.54.1)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib-&gt;missingno) (1.4.7)
Requirement already satisfied: pillow&gt;=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib-&gt;missingno) (10.4.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib-&gt;missingno) (3.2.0)
Requirement already satisfied: python-dateutil&gt;=2.7 in /usr/local/lib/python3.10/dist-packages (from matplotlib-&gt;missingno) (2.8.2)
Requirement already satisfied: pandas&gt;=1.2 in /usr/local/lib/python3.10/dist-packages (from seaborn-&gt;missingno) (2.2.2)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=1.2-&gt;seaborn-&gt;missingno) (2024.2)
Requirement already satisfied: tzdata&gt;=2022.7 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=1.2-&gt;seaborn-&gt;missingno) (2024.2)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil&gt;=2.7-&gt;matplotlib-&gt;missingno) (1.16.0)
Requirement already satisfied: dask[dataframe] in /usr/local/lib/python3.10/dist-packages (2024.8.2)
Requirement already satisfied: click&gt;=8.1 in /usr/local/lib/python3.10/dist-packages (from dask[dataframe]) (8.1.7)
Requirement already satisfied: cloudpickle&gt;=3.0.0 in /usr/local/lib/python3.10/dist-packages (from dask[dataframe]) (3.1.0)
Requirement already satisfied: fsspec&gt;=2021.09.0 in /usr/local/lib/python3.10/dist-packages (from dask[dataframe]) (2024.6.1)
Requirement already satisfied: packaging&gt;=20.0 in /usr/local/lib/python3.10/dist-packages (from dask[dataframe]) (24.1)
Requirement already satisfied: partd&gt;=1.4.0 in /usr/local/lib/python3.10/dist-packages (from dask[dataframe]) (1.4.2)
Requirement already satisfied: pyyaml&gt;=5.3.1 in /usr/local/lib/python3.10/dist-packages (from dask[dataframe]) (6.0.2)
Requirement already satisfied: toolz&gt;=0.10.0 in /usr/local/lib/python3.10/dist-packages (from dask[dataframe]) (0.12.1)
Requirement already satisfied: importlib-metadata&gt;=4.13.0 in /usr/local/lib/python3.10/dist-packages (from dask[dataframe]) (8.5.0)
Requirement already satisfied: pandas&gt;=2.0 in /usr/local/lib/python3.10/dist-packages (from dask[dataframe]) (2.2.2)
Requirement already satisfied: dask-expr&lt;1.2,&gt;=1.1 in /usr/local/lib/python3.10/dist-packages (from dask[dataframe]) (1.1.13)
Requirement already satisfied: pyarrow&gt;=14.0.1 in /usr/local/lib/python3.10/dist-packages (from dask-expr&lt;1.2,&gt;=1.1-&gt;dask[dataframe]) (16.1.0)
Requirement already satisfied: zipp&gt;=3.20 in /usr/local/lib/python3.10/dist-packages (from importlib-metadata&gt;=4.13.0-&gt;dask[dataframe]) (3.20.2)
Requirement already satisfied: numpy&gt;=1.22.4 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=2.0-&gt;dask[dataframe]) (1.26.4)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=2.0-&gt;dask[dataframe]) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=2.0-&gt;dask[dataframe]) (2024.2)
Requirement already satisfied: tzdata&gt;=2022.7 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=2.0-&gt;dask[dataframe]) (2024.2)
Requirement already satisfied: locket in /usr/local/lib/python3.10/dist-packages (from partd&gt;=1.4.0-&gt;dask[dataframe]) (1.0.0)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil&gt;=2.8.2-&gt;pandas&gt;=2.0-&gt;dask[dataframe]) (1.16.0)
Requirement already satisfied: ace_tools in /usr/local/lib/python3.10/dist-packages (0.0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">dask.dataframe</span> <span class="k">as</span> <span class="nn">dd</span> <span class="c1">#Lectura de csv grandes</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">shapiro</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">normaltest</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">missingno</span> <span class="k">as</span> <span class="nn">msno</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">from</span> <span class="nn">plotly.subplots</span> <span class="kn">import</span> <span class="n">make_subplots</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.outliers_influence</span> <span class="kn">import</span> <span class="n">variance_inflation_factor</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">sklearn.experimental</span> <span class="kn">import</span> <span class="n">enable_iterative_imputer</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">IterativeImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">RobustScaler</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2_contingency</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">kstest</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(&quot;/content/drive&quot;, force_remount=True).
</pre></div>
</div>
</div>
</div>
<section id="carga-de-archivos">
<h3>Carga de archivos<a class="headerlink" href="#carga-de-archivos" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="err">!</span><span class="n">ls</span> <span class="s1">&#39;/content/drive/My Drive/&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Coaching entry form (1).csv&#39;			    &#39;KPI (2).csv&#39;
&#39;Coaching tactic.csv&#39;				    &#39;KPI (2).gsheet&#39;
&#39;Coaching tactic.gsheet&#39;			     ML2_Henry.ipynb
&#39;Colab Notebooks&#39;				     module_UnderA.ipynb
&#39; Data_viz&#39;					    &#39;Parcial 2&#39;
 days_data_eurusd_futures-20240419T231103Z-002.zip  &#39;Qué es la justicia.odp&#39;
 df_cateim.csv					    &#39;Team distribution.csv&#39;
 df_vif-d.csv					     train_data.csv
 final_results					     train_labels.csv
 for_drive					     X_clasificacion.parquet
&#39;Hoja de cálculo sin título.gsheet&#39;		     X_res.parquet
&#39;KPI (2) (1).gsheet&#39;				     y_clasificacion.parquet
&#39;KPI (2) (2).gsheet&#39;				     y_res.parquet
&#39;KPI (2) (3).gsheet&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data_train</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/My Drive/train_data.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">label_train</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/My Drive/train_labels.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="analisis-exploratorio-de-los-datos-eda">
<h2>Análisis Exploratorio de los Datos (EDA)<a class="headerlink" href="#analisis-exploratorio-de-los-datos-eda" title="Link to this heading">#</a></h2>
<p>Inicialmente se realiza la carga e inspecciòn superficial de las caraterísticas de los datos, tales como el nùmero de observaciones, filas, columnas, tipos de variables, se concantena el conjunto de datos de las variables predictoras y el conjunto de datos de variable respuesta.</p>
<p>Es relevante mencionar que el conjunto de datos <code class="docutils literal notranslate"><span class="pre">train</span></code> posee 5531451 de onservaciones o registros de transacciones y 190 variables/columnas, de las cuales 185 son flotantes, 1 entero y 4 caracteres.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data_train</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;dask.dataframe.core.DataFrame&#39;&gt;
Columns: 190 entries, customer_ID to D_145
dtypes: float64(185), int64(1), string(4)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">n_columnas</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_train</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">n_filas</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_train</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;El conjunto de entrenamiento para las predictoras tiene </span><span class="si">{</span><span class="n">n_filas</span><span class="si">}</span><span class="s2"> filas y </span><span class="si">{</span><span class="n">n_columnas</span><span class="si">}</span><span class="s2"> columnas.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>El conjunto de entrenamiento para las predictoras tiene 5531451 filas y 190 columnas.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">data_train</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">headers</span><span class="o">=</span><span class="s1">&#39;keys&#39;</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s1">&#39;fancy_grid&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>╒═══════╤══════════════════════════════════════════════════════════════════╤════════════╤══════════╤════════════╤═════════════╤══════════╤═════════════╤═══════════╤═════════════╤════════════╤════════╤════════════╤════════════╤═════════════╤══════════╤════════════╤════════════╤══════════╤══════════╤════════════╤════════╤═══════════╤═══════════╤═════════════╤═══════════╤════════════╤════════════╤════════════╤══════════╤══════════╤══════════╤════════╤════════════╤════════════╤═════════════╤═════════╤═════════════╤═══════════╤═══════════╤════════════╤═══════════╤══════════╤═══════════╤═════════════╤════════════╤══════════════╤════════════╤══════════╤═══════════╤═════════════╤════════════╤══════════╤═══════════╤════════╤════════╤═════════════╤══════════╤════════════╤══════════╤═════════════╤════════╤═════════════╤════════╤══════════╤═════════════╤═════════════╤════════════╤═════════════╤════════════╤════════════╤════════════╤═════════════╤══════════╤════════════╤════════╤═════════════╤═════════════╤════════════╤════════╤═════════════╤═════════════╤═══════════╤═════════════╤═════════════╤═════════════╤═════════════╤═════════════╤═══════╤═════════════╤═════════════╤════════════╤═════════════╤═════════════╤═════════════╤══════════╤═════════════╤═════════╤════════════╤════════════╤═════════════╤═════════════╤════════════╤════════════╤═════════════╤════════╤════════╤═════════════╤════════════╤════════╤═════════════╤════════════╤════════╤════════╤═════════════╤════════════╤═════════════╤═════════════╤════════════╤═════════════╤════════════╤═════════════╤═════════════╤═════════════╤═════════════╤════════════╤═════════════╤═════════════╤════════════╤═════════════╤════════════╤══════════╤══════════╤═══════════╤══════════╤═════════════╤════════════╤═════════════╤═════════════╤═════════╤═════════╤═════════════╤═════════════╤════════════╤════════╤═════════╤════════╤═════════╤════════════╤═════════╤═════════╤════════╤═════════╤════════════╤═════════════╤══════════╤═════════╤═══════════╤═════════╤═════════╤═══════════╤═══════════╤═════════╤══════════╤══════════╤════════════╤══════════╤═════════════╤═════════╤════════════╤═════════╤═════════╤════════════╤════════╤════════════╤═════════════╤═════════╤═════════════╤═════════════╤═════════╤═════════╤═════════╤═════════╤═════════╤════════════╤════════════╤═════════════╤═════════╤════════════╤════════════╤════════════╕
│       │ customer_ID                                                      │ S_2        │      P_2 │       D_39 │         B_1 │      B_2 │         R_1 │       S_3 │        D_41 │        B_3 │   D_42 │       D_43 │       D_44 │         B_4 │     D_45 │        B_5 │        R_2 │     D_46 │     D_47 │       D_48 │   D_49 │       B_6 │       B_7 │         B_8 │      D_50 │       D_51 │        B_9 │        R_3 │     D_52 │      P_3 │     B_10 │   D_53 │        S_5 │       B_11 │         S_6 │    D_54 │         R_4 │       S_7 │      B_12 │        S_8 │      D_55 │     D_56 │      B_13 │         R_5 │       D_58 │          S_9 │       B_14 │     D_59 │      D_60 │        D_61 │       B_15 │     S_11 │      D_62 │ D_63   │ D_64   │        D_65 │     B_16 │       B_17 │     B_18 │        B_19 │   D_66 │        B_20 │   D_68 │     S_12 │         R_6 │        S_13 │       B_21 │        D_69 │       B_22 │       D_70 │       D_71 │        D_72 │     S_15 │       B_23 │   D_73 │         P_4 │        D_74 │       D_75 │   D_76 │        B_24 │         R_7 │      D_77 │        B_25 │        B_26 │        D_78 │        D_79 │         R_8 │   R_9 │        S_16 │        D_80 │       R_10 │        R_11 │        B_27 │        D_81 │     D_82 │        S_17 │    R_12 │       B_28 │       R_13 │        D_83 │        R_14 │       R_15 │       D_84 │        R_16 │   B_29 │   B_30 │        S_18 │       D_86 │   D_87 │        R_17 │       R_18 │   D_88 │   B_31 │        S_19 │       R_19 │        B_32 │        S_20 │       R_20 │        R_21 │       B_33 │        D_89 │        R_22 │        R_23 │        D_91 │       D_92 │        D_93 │        D_94 │       R_24 │        R_25 │       D_96 │     S_22 │     S_23 │      S_24 │     S_25 │        S_26 │      D_102 │       D_103 │       D_104 │   D_105 │   D_106 │       D_107 │        B_36 │       B_37 │   R_26 │    R_27 │   B_38 │   D_108 │      D_109 │   D_110 │   D_111 │   B_39 │   D_112 │       B_40 │        S_27 │    D_113 │   D_114 │     D_115 │   D_116 │   D_117 │     D_118 │     D_119 │   D_120 │    D_121 │    D_122 │      D_123 │    D_124 │       D_125 │   D_126 │      D_127 │   D_128 │   D_129 │       B_41 │   B_42 │      D_130 │       D_131 │   D_132 │       D_133 │        R_28 │   D_134 │   D_135 │   D_136 │   D_137 │   D_138 │      D_139 │      D_140 │       D_141 │   D_142 │      D_143 │      D_144 │      D_145 │
╞═══════╪══════════════════════════════════════════════════════════════════╪════════════╪══════════╪════════════╪═════════════╪══════════╪═════════════╪═══════════╪═════════════╪════════════╪════════╪════════════╪════════════╪═════════════╪══════════╪════════════╪════════════╪══════════╪══════════╪════════════╪════════╪═══════════╪═══════════╪═════════════╪═══════════╪════════════╪════════════╪════════════╪══════════╪══════════╪══════════╪════════╪════════════╪════════════╪═════════════╪═════════╪═════════════╪═══════════╪═══════════╪════════════╪═══════════╪══════════╪═══════════╪═════════════╪════════════╪══════════════╪════════════╪══════════╪═══════════╪═════════════╪════════════╪══════════╪═══════════╪════════╪════════╪═════════════╪══════════╪════════════╪══════════╪═════════════╪════════╪═════════════╪════════╪══════════╪═════════════╪═════════════╪════════════╪═════════════╪════════════╪════════════╪════════════╪═════════════╪══════════╪════════════╪════════╪═════════════╪═════════════╪════════════╪════════╪═════════════╪═════════════╪═══════════╪═════════════╪═════════════╪═════════════╪═════════════╪═════════════╪═══════╪═════════════╪═════════════╪════════════╪═════════════╪═════════════╪═════════════╪══════════╪═════════════╪═════════╪════════════╪════════════╪═════════════╪═════════════╪════════════╪════════════╪═════════════╪════════╪════════╪═════════════╪════════════╪════════╪═════════════╪════════════╪════════╪════════╪═════════════╪════════════╪═════════════╪═════════════╪════════════╪═════════════╪════════════╪═════════════╪═════════════╪═════════════╪═════════════╪════════════╪═════════════╪═════════════╪════════════╪═════════════╪════════════╪══════════╪══════════╪═══════════╪══════════╪═════════════╪════════════╪═════════════╪═════════════╪═════════╪═════════╪═════════════╪═════════════╪════════════╪════════╪═════════╪════════╪═════════╪════════════╪═════════╪═════════╪════════╪═════════╪════════════╪═════════════╪══════════╪═════════╪═══════════╪═════════╪═════════╪═══════════╪═══════════╪═════════╪══════════╪══════════╪════════════╪══════════╪═════════════╪═════════╪════════════╪═════════╪═════════╪════════════╪════════╪════════════╪═════════════╪═════════╪═════════════╪═════════════╪═════════╪═════════╪═════════╪═════════╪═════════╪════════════╪════════════╪═════════════╪═════════╪════════════╪════════════╪════════════╡
│ 21597 │ fffff1d38b785cef84adeace64f8f83db3a0c31e8d92eaba8b115f71cab04681 │ 2017-06-19 │ 1.00577  │ 0.206469   │ 0.0299987   │ 0.620975 │ 0.00817603  │ 0.0334448 │ 0.00377809  │ 0.0380973  │    nan │ 0.0141827  │ 0.00915957 │ 0.0183385   │ 0.730693 │ 0.00761889 │ 0.00511123 │ 0.388366 │ 0.521325 │ 0.0165054  │    nan │ 0.0849644 │ 0.0316723 │ 0.00583511  │ 0.0778536 │ 0.0026232  │ 0.0292914  │ 0.00550298 │ 0.287587 │ 0.752543 │ 0.208905 │    nan │ 0.138998   │ 0.0189006  │ 0.000609664 │ 1.00125 │ 2.7557e-05  │ 0.0355896 │ 0.0542612 │ 0.603181   │ 0.0514548 │ 0.133702 │ 0.0810835 │ 0.00597887  │ 0.00553644 │ nan          │ 0.0295727  │ 0.441927 │ 0.732607  │  0.016805   │ 0.0093656  │ 0.284206 │ 0.0935156 │ CL     │ O      │ 0.00697219  │ 0.8376   │ 0.376522   │ 0.379425 │ 0.0832235   │    nan │ 0.182068    │      5 │ 0.190582 │ 0.00141897  │ 0.00023662  │ 0.00953663 │ 0.000398995 │ 0.00736328 │ 0.00116158 │ 0.0146651  │ 0.0070723   │ 0.104036 │ 0.0177832  │    nan │ 0.00392638  │ 0.00992467  │ 0.071454   │    nan │ 0.00671428  │ 0.00403784  │ 0.0825719 │ 0.0485326   │ 0.00284016  │ 0.00891418  │ 0.00422623  │ 0.000153369 │   nan │ 0.000181279 │ 0.00139106  │ 0.0048826  │ 0.00126554  │ 0.0065323   │ 0.00317604  │ 0.501036 │ 0.00462589  │ 1.00855 │ 0.0201636  │ 0.0082739  │ 0.00241216  │ 3.33165e-05 │ 0.00751017 │ 0.00579755 │ 0.00285603  │    nan │      0 │ 0.00872685  │ 0.00908509 │    nan │ 0.00689294  │ 0.00165669 │    nan │      1 │ 0.00748096  │ 0.0054714  │ 0.00865157  │ 0.00886455  │ 0.00604456 │ 0.00829391  │ 0.00249159 │ 0.00136918  │ 0.00355721  │ 0.00170306  │ 0.00512137  │ 0.00435876 │ 0.000230646 │ 0.00310229  │ 0.00153179 │ 0.00627206  │ 0.00186117 │ 0.960194 │ 0.133776 │ 0.959114  │ 0.970989 │ 0.000476884 │ 0.00941777 │ 9.94393e-05 │ 0.000399992 │     nan │     nan │ 0.00290686  │ 0.000927619 │ 0.0328996  │    nan │ 1.00035 │      3 │     nan │ 0.00342363 │     nan │     nan │    nan │ 1.00345 │ 0.0170355  │ 0.000910624 │ 0.200928 │       1 │ 0.0131735 │       0 │       3 │ 0.0128377 │ 0.0196046 │       0 │ 0.710688 │ 0.294562 │ 1.00524    │ 0.464491 │ 1.00041     │       1 │ 1.00503    │ 1.00895 │ 1.00674 │ 0.00627281 │    nan │ 0.00879174 │ 8.64917e-05 │     nan │ 0.000926402 │ 0.000448853 │     nan │     nan │     nan │     nan │     nan │ 0.00709889 │ 0.00403158 │ 0.00604425  │     nan │ 0.00931603 │ 0.002273   │ 0.0025678  │
├───────┼──────────────────────────────────────────────────────────────────┼────────────┼──────────┼────────────┼─────────────┼──────────┼─────────────┼───────────┼─────────────┼────────────┼────────┼────────────┼────────────┼─────────────┼──────────┼────────────┼────────────┼──────────┼──────────┼────────────┼────────┼───────────┼───────────┼─────────────┼───────────┼────────────┼────────────┼────────────┼──────────┼──────────┼──────────┼────────┼────────────┼────────────┼─────────────┼─────────┼─────────────┼───────────┼───────────┼────────────┼───────────┼──────────┼───────────┼─────────────┼────────────┼──────────────┼────────────┼──────────┼───────────┼─────────────┼────────────┼──────────┼───────────┼────────┼────────┼─────────────┼──────────┼────────────┼──────────┼─────────────┼────────┼─────────────┼────────┼──────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼────────────┼────────────┼─────────────┼──────────┼────────────┼────────┼─────────────┼─────────────┼────────────┼────────┼─────────────┼─────────────┼───────────┼─────────────┼─────────────┼─────────────┼─────────────┼─────────────┼───────┼─────────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────────┼──────────┼─────────────┼─────────┼────────────┼────────────┼─────────────┼─────────────┼────────────┼────────────┼─────────────┼────────┼────────┼─────────────┼────────────┼────────┼─────────────┼────────────┼────────┼────────┼─────────────┼────────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────────┼─────────────┼────────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼──────────┼──────────┼───────────┼──────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────┼─────────┼─────────────┼─────────────┼────────────┼────────┼─────────┼────────┼─────────┼────────────┼─────────┼─────────┼────────┼─────────┼────────────┼─────────────┼──────────┼─────────┼───────────┼─────────┼─────────┼───────────┼───────────┼─────────┼──────────┼──────────┼────────────┼──────────┼─────────────┼─────────┼────────────┼─────────┼─────────┼────────────┼────────┼────────────┼─────────────┼─────────┼─────────────┼─────────────┼─────────┼─────────┼─────────┼─────────┼─────────┼────────────┼────────────┼─────────────┼─────────┼────────────┼────────────┼────────────┤
│ 21598 │ fffff1d38b785cef84adeace64f8f83db3a0c31e8d92eaba8b115f71cab04681 │ 2017-07-20 │ 0.965709 │ 0.207843   │ 0.0427817   │ 0.279508 │ 0.00108802  │ 0.0208154 │ 0.00645991  │ 0.0535843  │    nan │ 0.0176114  │ 0.00723369 │ 0.0155021   │ 0.731322 │ 0.0348319  │ 0.00662689 │ 0.410001 │ 0.519332 │ 0.0466752  │    nan │ 0.0871235 │ 0.0282778 │ 0.0042356   │ 0.0724097 │ 0.00720158 │ 0.0238644  │ 0.00274608 │ 0.289895 │ 0.635963 │ 0.157152 │    nan │ 0.0412885  │ 0.0267713  │ 0.00285385  │ 1.00072 │ 0.00111879  │ 0.0258155 │ 0.0557528 │ 0.665898   │ 0.0507348 │ 0.132462 │ 0.0776814 │ 0.00602198  │ 0.00426678 │   0.0109981  │ 0.0365954  │ 0.40098  │ 0.735786  │  0.0188036  │ 0.0241655  │ 1.04388  │ 0.331136  │ CL     │ O      │ 0.00107264  │ 0.920613 │ 0.427228   │ 0.379839 │ 0.0815408   │    nan │ 0.237612    │      5 │ 0.188247 │ 0.00612887  │ 0.563323    │ 0.00865786 │ 0.00740258  │ 0.00464164 │ 0.00836932 │ 0.00524675 │ 0.00468721  │ 0.205073 │ 0.0163339  │    nan │ 0.00857837  │ 0.00883294  │ 0.0749844  │    nan │ 0.000908029 │ 0.00345079  │ 0.300504  │ 0.0431583   │ 0.00742064  │ 0.00919014  │ 0.000290711 │ 0.0040542   │   nan │ 0.00584295  │ 0.00525227  │ 0.00639009 │ 0.50443     │ 8.809e-05   │ 0.00956144  │ 0.501465 │ 0.00861024  │ 1.00999 │ 0.0287363  │ 0.00501262 │ 0.00462492  │ 0.00236661  │ 0.0019197  │ 0.00304166 │ 0.0096281   │    nan │      0 │ 0.000884287 │ 0.00981552 │    nan │ 0.00404481  │ 0.00247854 │    nan │      1 │ 0.000346645 │ 0.00982422 │ 0.00983113  │ 0.00530668  │ 0.00364089 │ 0.00740558  │ 0.00128508 │ 0.00926655  │ 0.00475832  │ 0.00285616  │ 0.00909615  │ 0.00956023 │ 0.00836622  │ 0.00201235  │ 0.00631086 │ 0.00930652  │ 0.00191944 │ 0.930102 │ 0.134767 │ 0.948851  │ 0.979035 │ 0.00023005  │ 0.00445231 │ 0.00827527  │ 0.00517315  │     nan │     nan │ 0.00195831  │ 0.00100076  │ 0.0391105  │    nan │ 1.00792 │      3 │     nan │ 0.0093149  │     nan │     nan │    nan │ 1.00995 │ 0.0113333  │ 0.219747    │ 0.205282 │       1 │ 0.0158852 │       0 │       3 │ 0.0156655 │ 0.0187112 │       0 │ 0.709866 │ 0.286248 │ 1.00606    │ 0.463689 │ 1.00002     │       1 │ 1.00563    │ 1.00412 │ 1.00835 │ 0.00797848 │    nan │ 0.00306894 │ 0.00706968  │     nan │ 0.00140115  │ 0.00644056  │     nan │     nan │     nan │     nan │     nan │ 0.00911989 │ 0.00199188 │ 0.00461623  │     nan │ 0.0049605  │ 0.00962686 │ 0.00915047 │
├───────┼──────────────────────────────────────────────────────────────────┼────────────┼──────────┼────────────┼─────────────┼──────────┼─────────────┼───────────┼─────────────┼────────────┼────────┼────────────┼────────────┼─────────────┼──────────┼────────────┼────────────┼──────────┼──────────┼────────────┼────────┼───────────┼───────────┼─────────────┼───────────┼────────────┼────────────┼────────────┼──────────┼──────────┼──────────┼────────┼────────────┼────────────┼─────────────┼─────────┼─────────────┼───────────┼───────────┼────────────┼───────────┼──────────┼───────────┼─────────────┼────────────┼──────────────┼────────────┼──────────┼───────────┼─────────────┼────────────┼──────────┼───────────┼────────┼────────┼─────────────┼──────────┼────────────┼──────────┼─────────────┼────────┼─────────────┼────────┼──────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼────────────┼────────────┼─────────────┼──────────┼────────────┼────────┼─────────────┼─────────────┼────────────┼────────┼─────────────┼─────────────┼───────────┼─────────────┼─────────────┼─────────────┼─────────────┼─────────────┼───────┼─────────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────────┼──────────┼─────────────┼─────────┼────────────┼────────────┼─────────────┼─────────────┼────────────┼────────────┼─────────────┼────────┼────────┼─────────────┼────────────┼────────┼─────────────┼────────────┼────────┼────────┼─────────────┼────────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────────┼─────────────┼────────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼──────────┼──────────┼───────────┼──────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────┼─────────┼─────────────┼─────────────┼────────────┼────────┼─────────┼────────┼─────────┼────────────┼─────────┼─────────┼────────┼─────────┼────────────┼─────────────┼──────────┼─────────┼───────────┼─────────┼─────────┼───────────┼───────────┼─────────┼──────────┼──────────┼────────────┼──────────┼─────────────┼─────────┼────────────┼─────────┼─────────┼────────────┼────────┼────────────┼─────────────┼─────────┼─────────────┼─────────────┼─────────┼─────────┼─────────┼─────────┼─────────┼────────────┼────────────┼─────────────┼─────────┼────────────┼────────────┼────────────┤
│ 21599 │ fffff1d38b785cef84adeace64f8f83db3a0c31e8d92eaba8b115f71cab04681 │ 2017-08-09 │ 0.968892 │ 0.563736   │ 0.034385    │ 0.435834 │ 3.66403e-05 │ 0.0283948 │ 0.00163119  │ 0.044833   │    nan │ 0.00946088 │ 0.00297947 │ 0.0149924   │ 0.732781 │ 0.0281625  │ 0.00655852 │ 0.40632  │ 0.521531 │ 0.0362353  │    nan │ 0.090321  │ 0.0292198 │ 0.0035506   │ 0.07758   │ 0.00813166 │ 0.0211706  │ 0.00679298 │ 0.28827  │ 0.640528 │ 0.179    │    nan │ 0.0400954  │ 0.017228   │ 0.00682164  │ 1.00315 │ 0.00707833  │ 0.0233392 │ 0.0577092 │ 0.465825   │ 0.0472062 │ 0.136325 │ 0.076419  │ 0.00685426  │ 0.00817425 │   0.0145567  │ 0.0359191  │ 0.3832   │ 0.738183  │  0.0232675  │ 0.0254289  │ 0.603067 │ 0.330805  │ CL     │ O      │ 0.0055709   │ 0.839752 │ 0.428727   │ 0.376584 │ 0.00496851  │    nan │ 0.244655    │      5 │ 0.193686 │ 0.00201299  │ 0.000357256 │ 0.00377185 │ 0.00582324  │ 0.00746909 │ 0.00744177 │ 0.0110897  │ 0.00228606  │ 0.206492 │ 0.0158955  │    nan │ 0.00540009  │ 0.00973061  │ 0.0702742  │    nan │ 0.00533529  │ 0.00399805  │ 0.303727  │ 0.0262328   │ 0.000633261 │ 0.00160987  │ 0.00364015  │ 0.00710997  │   nan │ 0.00952083  │ 0.000148674 │ 0.00528339 │ 0.000420128 │ 0.00403469  │ 0.00635404  │ 0.504486 │ 0.00784264  │ 1.00098 │ 0.0247881  │ 0.00866164 │ 0.00913888  │ 0.00205701  │ 0.00932501 │ 0.00821941 │ 0.00500996  │    nan │      0 │ 0.00849148  │ 0.00385951 │    nan │ 0.00735742  │ 0.00333895 │    nan │      1 │ 0.00334082  │ 0.00445888 │ 0.0090863   │ 0.000972936 │ 0.00895326 │ 0.00972535  │ 0.00662015 │ 0.0026163   │ 0.00767035  │ 0.00563353  │ 0.0083854   │ 0.00805091 │ 0.00764649  │ 0.0053266   │ 0.00323154 │ 0.00944331  │ 0.00174941 │ 0.936726 │ 0.137554 │ 0.956288  │ 0.970099 │ 0.00242208  │ 0.00781879 │ 0.00217661  │ 0.00727098  │     nan │     nan │ 0.00487251  │ 0.00599483  │ 0.0315392  │    nan │ 1.00034 │      3 │     nan │ 0.00866519 │     nan │     nan │    nan │ 1.00316 │ 0.00944433 │ 0.178687    │ 0.203964 │       1 │ 0.0212762 │       0 │       3 │ 0.0193145 │ 0.0113153 │       0 │ 0.708846 │ 0.286624 │ 1.00126    │ 0.455785 │ 1.00741     │       1 │ 1.00328    │ 1.00896 │ 1.00279 │ 0.00648893 │    nan │ 0.00481795 │ 0.00959314  │     nan │ 0.00575178  │ 0.000214976 │     nan │     nan │     nan │     nan │     nan │ 0.00477204 │ 0.00838621 │ 0.00241315  │     nan │ 0.00552437 │ 0.0085186  │ 0.00901328 │
├───────┼──────────────────────────────────────────────────────────────────┼────────────┼──────────┼────────────┼─────────────┼──────────┼─────────────┼───────────┼─────────────┼────────────┼────────┼────────────┼────────────┼─────────────┼──────────┼────────────┼────────────┼──────────┼──────────┼────────────┼────────┼───────────┼───────────┼─────────────┼───────────┼────────────┼────────────┼────────────┼──────────┼──────────┼──────────┼────────┼────────────┼────────────┼─────────────┼─────────┼─────────────┼───────────┼───────────┼────────────┼───────────┼──────────┼───────────┼─────────────┼────────────┼──────────────┼────────────┼──────────┼───────────┼─────────────┼────────────┼──────────┼───────────┼────────┼────────┼─────────────┼──────────┼────────────┼──────────┼─────────────┼────────┼─────────────┼────────┼──────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼────────────┼────────────┼─────────────┼──────────┼────────────┼────────┼─────────────┼─────────────┼────────────┼────────┼─────────────┼─────────────┼───────────┼─────────────┼─────────────┼─────────────┼─────────────┼─────────────┼───────┼─────────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────────┼──────────┼─────────────┼─────────┼────────────┼────────────┼─────────────┼─────────────┼────────────┼────────────┼─────────────┼────────┼────────┼─────────────┼────────────┼────────┼─────────────┼────────────┼────────┼────────┼─────────────┼────────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────────┼─────────────┼────────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼──────────┼──────────┼───────────┼──────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────┼─────────┼─────────────┼─────────────┼────────────┼────────┼─────────┼────────┼─────────┼────────────┼─────────┼─────────┼────────┼─────────┼────────────┼─────────────┼──────────┼─────────┼───────────┼─────────┼─────────┼───────────┼───────────┼─────────┼──────────┼──────────┼────────────┼──────────┼─────────────┼─────────┼────────────┼─────────┼─────────┼────────────┼────────┼────────────┼─────────────┼─────────┼─────────────┼─────────────┼─────────┼─────────┼─────────┼─────────┼─────────┼────────────┼────────────┼─────────────┼─────────┼────────────┼────────────┼────────────┤
│ 21600 │ fffff1d38b785cef84adeace64f8f83db3a0c31e8d92eaba8b115f71cab04681 │ 2017-09-20 │ 0.97378  │ 0.239892   │ 0.0462458   │ 0.732382 │ 0.00709277  │ 0.0816267 │ 0.00354323  │ 0.0307788  │    nan │ 0.0160511  │ 0.00688192 │ 0.0352354   │ 0.736701 │ 0.0300554  │ 0.00321639 │ 0.388536 │ 0.523351 │ 0.00902949 │    nan │ 0.111282  │ 0.0316511 │ 0.00973667  │ 0.077721  │ 0.00152011 │ 0.010383   │ 0.00672107 │ 0.282512 │ 0.690183 │ 0.238478 │    nan │ 0.00545784 │ 0.0306862  │ 0.00457776  │ 1.00802 │ 0.00816138  │ 0.0613092 │ 0.0520991 │ 0.706353   │ 0.0420095 │ 0.133101 │ 0.021544  │ 0.00291073  │ 0.00334762 │   0.0204161  │ 0.0447493  │ 0.358039 │ 0.805551  │  0.0190117  │ 0.0481656  │ 0.680559 │ 0.328902  │ CL     │ O      │ 0.00745538  │ 0.836001 │ 0.225732   │ 0.449966 │ 0.00202127  │    nan │ 0.295153    │      5 │ 0.185956 │ 0.00470352  │ 0.695611    │ 0.00561002 │ 0.000998323 │ 0.00992574 │ 0.00684797 │ 0.00585232 │ 0.00954911  │ 0.201694 │ 0.0254028  │    nan │ 0.00806883  │ 0.00800569  │ 0.0672365  │    nan │ 0.00544191  │ 0.000536818 │ 0.309987  │ 0.021288    │ 0.00629973  │ 0.00790094  │ 0.00736968  │ 0.00514302  │   nan │ 0.00694918  │ 0.00499125  │ 0.0063947  │ 0.00107302  │ 0.0066256   │ 0.0059414   │ 0.504392 │ 0.00315377  │ 1.00039 │ 0.0253798  │ 0.00220097 │ 0.00805138  │ 0.00321479  │ 0.00217675 │ 0.00151409 │ 0.00402702  │    nan │      0 │ 0.00618059  │ 0.00636332 │    nan │ 0.00983898  │ 0.00215393 │    nan │      1 │ 0.00932755  │ 0.00442738 │ 0.00671155  │ 0.00613979  │ 0.00476742 │ 0.00233038  │ 0.00175018 │ 0.0072907   │ 0.00511799  │ 0.0082789   │ 0.00404986  │ 0.00248061 │ 0.00806931  │ 0.00285545  │ 0.00742025 │ 0.00228291  │ 0.00707162 │ 0.946211 │ 0.133306 │ 0.966319  │ 0.97667  │ 0.00330648  │ 0.00642375 │ 2.75872e-06 │ 0.00540257  │     nan │     nan │ 0.00393401  │ 0.00984321  │ 0.042893   │    nan │ 1.00307 │      3 │     nan │ 0.00533103 │     nan │     nan │    nan │ 1.00926 │ 0.00724349 │ 0.197849    │ 0.200949 │       1 │ 0.0207894 │       0 │       3 │ 0.021606  │ 0.0216215 │       0 │ 0.714318 │ 0.295233 │ 0.00308215 │ 0.455907 │ 0.00767572  │       1 │ 1.00991    │ 1.0029  │ 1.00875 │ 0.00877503 │    nan │ 0.00843446 │ 0.00720791  │     nan │ 0.00722125  │ 0.00937658  │     nan │     nan │     nan │     nan │     nan │ 0.003733   │ 0.00965794 │ 0.00978926  │     nan │ 0.003017   │ 0.00459911 │ 0.00929053 │
├───────┼──────────────────────────────────────────────────────────────────┼────────────┼──────────┼────────────┼─────────────┼──────────┼─────────────┼───────────┼─────────────┼────────────┼────────┼────────────┼────────────┼─────────────┼──────────┼────────────┼────────────┼──────────┼──────────┼────────────┼────────┼───────────┼───────────┼─────────────┼───────────┼────────────┼────────────┼────────────┼──────────┼──────────┼──────────┼────────┼────────────┼────────────┼─────────────┼─────────┼─────────────┼───────────┼───────────┼────────────┼───────────┼──────────┼───────────┼─────────────┼────────────┼──────────────┼────────────┼──────────┼───────────┼─────────────┼────────────┼──────────┼───────────┼────────┼────────┼─────────────┼──────────┼────────────┼──────────┼─────────────┼────────┼─────────────┼────────┼──────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼────────────┼────────────┼─────────────┼──────────┼────────────┼────────┼─────────────┼─────────────┼────────────┼────────┼─────────────┼─────────────┼───────────┼─────────────┼─────────────┼─────────────┼─────────────┼─────────────┼───────┼─────────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────────┼──────────┼─────────────┼─────────┼────────────┼────────────┼─────────────┼─────────────┼────────────┼────────────┼─────────────┼────────┼────────┼─────────────┼────────────┼────────┼─────────────┼────────────┼────────┼────────┼─────────────┼────────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────────┼─────────────┼────────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼──────────┼──────────┼───────────┼──────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────┼─────────┼─────────────┼─────────────┼────────────┼────────┼─────────┼────────┼─────────┼────────────┼─────────┼─────────┼────────┼─────────┼────────────┼─────────────┼──────────┼─────────┼───────────┼─────────┼─────────┼───────────┼───────────┼─────────┼──────────┼──────────┼────────────┼──────────┼─────────────┼─────────┼────────────┼─────────┼─────────┼────────────┼────────┼────────────┼─────────────┼─────────┼─────────────┼─────────────┼─────────┼─────────┼─────────┼─────────┼─────────┼────────────┼────────────┼─────────────┼─────────┼────────────┼────────────┼────────────┤
│ 21601 │ fffff1d38b785cef84adeace64f8f83db3a0c31e8d92eaba8b115f71cab04681 │ 2017-10-20 │ 0.979511 │ 0.00222956 │ 0.0226947   │ 0.557029 │ 0.00889743  │ 0.0915652 │ 0.000880042 │ 0.0454706  │    nan │ 0.00856195 │ 0.00174745 │ 0.00650609  │ 0.744973 │ 0.0275915  │ 0.00744817 │ 0.393926 │ 0.531019 │ 0.00790981 │    nan │ 0.108105  │ 0.0238092 │ 0.00576571  │ 0.0815332 │ 0.00289376 │ 0.0207905  │ 0.00929924 │ 0.284644 │ 0.681757 │ 0.190385 │    nan │ 0.0304788  │ 0.00998809 │ 0.00480757  │ 1.00984 │ 0.00533616  │ 0.0603085 │ 0.0517794 │ 0.317725   │ 0.0348031 │ 0.136475 │ 0.0458323 │ 0.00275315  │ 0.00414463 │   0.0256473  │ 0.0182126  │ 0.337406 │ 0.94552   │  0.00504731 │ 0.00734616 │ 0.448719 │ 0.332181  │ CL     │ O      │ 0.00342748  │ 0.834962 │ 0.00986485 │ 0.442007 │ 0.00732266  │    nan │ 0.359783    │      5 │ 0.191793 │ 0.0050538   │ 0.428394    │ 0.00313057 │ 0.00350612  │ 0.0011521  │ 0.00664265 │ 0.00830721 │ 0.000993739 │ 0.403021 │ 0.0124558  │    nan │ 0.000556339 │ 0.000682805 │ 0.0691537  │    nan │ 0.00483985  │ 0.00812385  │ 0.308609  │ 0.0361147   │ 0.00190956  │ 0.00038257  │ 0.00731306  │ 0.00407035  │   nan │ 0.00763121  │ 0.00416275  │ 0.00462068 │ 0.00526651  │ 0.00742481  │ 0.000450618 │ 0.509447 │ 0.000625647 │ 1.00914 │ 0.0122     │ 0.00340149 │ 0.000794894 │ 0.00294765  │ 0.00321122 │ 0.00234325 │ 0.00650346  │    nan │      0 │ 0.00977061  │ 0.00879644 │    nan │ 0.00938335  │ 0.00706935 │    nan │      1 │ 0.00587958  │ 0.00181024 │ 0.00819697  │ 0.00429057  │ 0.00609978 │ 0.000676344 │ 0.00645021 │ 0.00446261  │ 0.00955648  │ 0.000274057 │ 8.13246e-05 │ 0.00171885 │ 0.00785341  │ 0.00718016  │ 0.00814581 │ 0.000676525 │ 0.00804408 │ 0.97474  │ 0.137417 │ 0.970358  │ 0.969983 │ 0.0016504   │ 0.00565956 │ 0.00749205  │ 0.00214351  │     nan │     nan │ 0.00892725  │ 0.003407    │ 0.0248357  │    nan │ 1.00606 │      3 │     nan │ 0.00286752 │     nan │     nan │    nan │ 1.00067 │ 0.00517366 │ 0.258416    │ 0.209596 │       1 │ 0.0214474 │       0 │       3 │ 0.0226914 │ 0.0217967 │       0 │ 0.716531 │ 0.291352 │ 0.008359   │ 0.458794 │ 0.00672218  │       1 │ 0.00204589 │ 1.00868 │ 1.00918 │ 0.00931939 │    nan │ 0.00509212 │ 0.00725376  │     nan │ 0.00266514  │ 0.00289876  │     nan │     nan │     nan │     nan │     nan │ 0.003243   │ 0.00876844 │ 0.00580695  │     nan │ 0.00137403 │ 0.00381082 │ 0.00852039 │
├───────┼──────────────────────────────────────────────────────────────────┼────────────┼──────────┼────────────┼─────────────┼──────────┼─────────────┼───────────┼─────────────┼────────────┼────────┼────────────┼────────────┼─────────────┼──────────┼────────────┼────────────┼──────────┼──────────┼────────────┼────────┼───────────┼───────────┼─────────────┼───────────┼────────────┼────────────┼────────────┼──────────┼──────────┼──────────┼────────┼────────────┼────────────┼─────────────┼─────────┼─────────────┼───────────┼───────────┼────────────┼───────────┼──────────┼───────────┼─────────────┼────────────┼──────────────┼────────────┼──────────┼───────────┼─────────────┼────────────┼──────────┼───────────┼────────┼────────┼─────────────┼──────────┼────────────┼──────────┼─────────────┼────────┼─────────────┼────────┼──────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼────────────┼────────────┼─────────────┼──────────┼────────────┼────────┼─────────────┼─────────────┼────────────┼────────┼─────────────┼─────────────┼───────────┼─────────────┼─────────────┼─────────────┼─────────────┼─────────────┼───────┼─────────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────────┼──────────┼─────────────┼─────────┼────────────┼────────────┼─────────────┼─────────────┼────────────┼────────────┼─────────────┼────────┼────────┼─────────────┼────────────┼────────┼─────────────┼────────────┼────────┼────────┼─────────────┼────────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────────┼─────────────┼────────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼──────────┼──────────┼───────────┼──────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────┼─────────┼─────────────┼─────────────┼────────────┼────────┼─────────┼────────┼─────────┼────────────┼─────────┼─────────┼────────┼─────────┼────────────┼─────────────┼──────────┼─────────┼───────────┼─────────┼─────────┼───────────┼───────────┼─────────┼──────────┼──────────┼────────────┼──────────┼─────────────┼─────────┼────────────┼─────────┼─────────┼────────────┼────────┼────────────┼─────────────┼─────────┼─────────────┼─────────────┼─────────┼─────────┼─────────┼─────────┼─────────┼────────────┼────────────┼─────────────┼─────────┼────────────┼────────────┼────────────┤
│ 21602 │ fffff1d38b785cef84adeace64f8f83db3a0c31e8d92eaba8b115f71cab04681 │ 2017-11-05 │ 0.979332 │ 0.416013   │ 0.0208183   │ 0.828199 │ 0.00348746  │ 0.0907429 │ 0.00533956  │ 0.0251395  │    nan │ 0.0142254  │ 0.00217796 │ 2.86337e-05 │ 0.738777 │ 0.0355754  │ 0.0024724  │ 0.395745 │ 0.530723 │ 0.0625242  │    nan │ 0.122715  │ 0.0181206 │ 0.000667579 │ 0.0871546 │ 0.00806035 │ 0.013776   │ 0.0020558  │ 0.281378 │ 0.683896 │ 0.25084  │    nan │ 0.0367003  │ 0.0107524  │ 3.76098e-05 │ 1.0009  │ 0.00536593  │ 0.0556947 │ 0.0569819 │ 0.705097   │ 0.0398668 │ 0.134237 │ 0.0525057 │ 0.00270023  │ 0.0017844  │   0.0214708  │ 0.0223022  │ 0.420651 │ 0.889792  │  0.00529337 │ 0.0106531  │ 0.483833 │ 0.324893  │ CL     │ O      │ 0.0023123   │ 0.835932 │ 0.00450367 │ 0.442891 │ 0.0035501   │    nan │ 0.415415    │      5 │ 0.188514 │ 0.00323391  │ 0.511308    │ 0.00155533 │ 0.00411648  │ 0.00244354 │ 0.00329195 │ 0.0096428  │ 0.0065364   │ 0.204409 │ 0.00934621 │    nan │ 0.00375361  │ 0.00969866  │ 0.0752622  │    nan │ 0.00481596  │ 0.00277191  │ 0.305819  │ 0.0214095   │ 0.00381216  │ 0.00190612  │ 0.00866865  │ 0.00211966  │   nan │ 0.00861153  │ 0.000113302 │ 0.00699039 │ 0.00623445  │ 0.00142899  │ 0.000297851 │ 0.507415 │ 0.00602356  │ 1.00771 │ 0.0179203  │ 0.00409721 │ 0.00332801  │ 0.00785005  │ 0.00013024 │ 0.00978457 │ 0.000893871 │    nan │      0 │ 0.000671157 │ 0.00811293 │    nan │ 0.000511433 │ 0.00318458 │    nan │      1 │ 0.0031723   │ 0.00507471 │ 0.000481104 │ 0.00444574  │ 0.00599596 │ 0.00271812  │ 0.00865703 │ 0.00990804  │ 0.00940933  │ 0.000184727 │ 0.00777418  │ 0.0011105  │ 0.00232148  │ 0.00972975  │ 0.00874043 │ 0.00306114  │ 0.00979049 │ 0.971546 │ 0.132063 │ 0.975162  │ 0.970563 │ 0.00620794  │ 0.00963975 │ 0.00987066  │ 0.00374523  │     nan │     nan │ 0.00499483  │ 0.00361831  │ 0.0228971  │    nan │ 1.00991 │      3 │     nan │ 0.00242903 │     nan │     nan │    nan │ 1.00854 │ 0.00250083 │ 0.257406    │ 0.202654 │       1 │ 0.0211733 │       0 │       3 │ 0.0168939 │ 0.0161408 │       0 │ 0.713049 │ 0.293002 │ 0.00973983 │ 0.45687  │ 0.000183948 │       1 │ 1.00929    │ 1.00309 │ 1.00554 │ 0.00807812 │    nan │ 0.00889384 │ 0.00450816  │     nan │ 0.000776278 │ 0.00706944  │     nan │     nan │     nan │     nan │     nan │ 0.00683779 │ 0.0036795  │ 0.000456601 │     nan │ 0.00090536 │ 0.00149756 │ 0.00277432 │
├───────┼──────────────────────────────────────────────────────────────────┼────────────┼──────────┼────────────┼─────────────┼──────────┼─────────────┼───────────┼─────────────┼────────────┼────────┼────────────┼────────────┼─────────────┼──────────┼────────────┼────────────┼──────────┼──────────┼────────────┼────────┼───────────┼───────────┼─────────────┼───────────┼────────────┼────────────┼────────────┼──────────┼──────────┼──────────┼────────┼────────────┼────────────┼─────────────┼─────────┼─────────────┼───────────┼───────────┼────────────┼───────────┼──────────┼───────────┼─────────────┼────────────┼──────────────┼────────────┼──────────┼───────────┼─────────────┼────────────┼──────────┼───────────┼────────┼────────┼─────────────┼──────────┼────────────┼──────────┼─────────────┼────────┼─────────────┼────────┼──────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼────────────┼────────────┼─────────────┼──────────┼────────────┼────────┼─────────────┼─────────────┼────────────┼────────┼─────────────┼─────────────┼───────────┼─────────────┼─────────────┼─────────────┼─────────────┼─────────────┼───────┼─────────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────────┼──────────┼─────────────┼─────────┼────────────┼────────────┼─────────────┼─────────────┼────────────┼────────────┼─────────────┼────────┼────────┼─────────────┼────────────┼────────┼─────────────┼────────────┼────────┼────────┼─────────────┼────────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────────┼─────────────┼────────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼──────────┼──────────┼───────────┼──────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────┼─────────┼─────────────┼─────────────┼────────────┼────────┼─────────┼────────┼─────────┼────────────┼─────────┼─────────┼────────┼─────────┼────────────┼─────────────┼──────────┼─────────┼───────────┼─────────┼─────────┼───────────┼───────────┼─────────┼──────────┼──────────┼────────────┼──────────┼─────────────┼─────────┼────────────┼─────────┼─────────┼────────────┼────────┼────────────┼─────────────┼─────────┼─────────────┼─────────────┼─────────┼─────────┼─────────┼─────────┼─────────┼────────────┼────────────┼─────────────┼─────────┼────────────┼────────────┼────────────┤
│ 21603 │ fffff1d38b785cef84adeace64f8f83db3a0c31e8d92eaba8b115f71cab04681 │ 2017-12-23 │ 0.984907 │ 0.296536   │ 0.0072093   │ 0.81261  │ 0.00590385  │ 0.0798862 │ 0.00224314  │ 0.0236906  │    nan │ 0.00946712 │ 0.0052172  │ 0.0143543   │ 0.74418  │ 0.0296123  │ 0.00871671 │ 0.394486 │ 0.534473 │ 0.0515023  │    nan │ 0.171524  │ 0.0218534 │ 0.00686334  │ 0.100331  │ 0.00499728 │ 0.00564465 │ 0.00246009 │ 0.286289 │ 0.705934 │ 0.284274 │    nan │ 0.00877664 │ 0.00511916 │ 0.00461875  │ 1.00835 │ 0.00262849  │ 0.0496325 │ 0.0580019 │ 0.705059   │ 0.035277  │ 0.141704 │ 0.0498787 │ 0.000881124 │ 0.00299744 │   0.0254498  │ 0.0121125  │ 0.396883 │ 0.171943  │  0.0181791  │ 0.0109906  │ 0.244838 │ 0.328528  │ CL     │ O      │ 0.00869966  │ 0.755125 │ 0.177476   │ 1.00709  │ 0.00155766  │    nan │ 1.86436e-05 │      5 │ 0.18805  │ 0.00774565  │ 0.423013    │ 0.00106889 │ 0.00592355  │ 0.00523946 │ 0.00438245 │ 0.0150312  │ 0.00651415  │ 0.203718 │ 0.00782307 │    nan │ 0.00976282  │ 0.00717343  │ 0.00515333 │    nan │ 0.00669154  │ 1.68668e-05 │ 0.303197  │ 0.00760322  │ 0.0025544   │ 0.00805531  │ 0.00701904  │ 0.0035867   │   nan │ 0.00806535  │ 0.00417198  │ 0.00514936 │ 0.00721965  │ 0.000454041 │ 9.86978e-05 │ 0.500572 │ 0.000252393 │ 1.00394 │ 0.0242376  │ 0.00898507 │ 0.00515675  │ 0.00434013  │ 0.00316093 │ 0.0019808  │ 0.00741056  │    nan │      0 │ 0.000641883 │ 0.00380215 │    nan │ 0.00787752  │ 0.00990207 │    nan │      1 │ 0.00940781  │ 0.00633086 │ 0.0097343   │ 0.00797947  │ 0.0072556  │ 0.00291049  │ 1.00777    │ 0.000333857 │ 0.00663736  │ 0.00308357  │ 0.0092913   │ 0.00320032 │ 6.09387e-06 │ 0.000904491 │ 0.00334796 │ 0.00817109  │ 0.00225042 │ 0.8788   │ 0.137596 │ 0.900471  │ 0.97474  │ 0.00472212  │ 0.00574052 │ 0.0083807   │ 0.00801598  │     nan │     nan │ 0.00698241  │ 0.00647536  │ 0.0134447  │    nan │ 1.00735 │      3 │     nan │ 0.00650298 │     nan │     nan │    nan │ 1.00177 │ 0.0289882  │ 0.253864    │ 0.200897 │       1 │ 0.0309049 │       0 │       3 │ 0.0317536 │ 0.0300339 │       0 │ 0.715156 │ 0.437259 │ 0.0043291  │ 0.456621 │ 0.0091804   │       1 │ 1.00405    │ 1.00883 │ 1.0085  │ 0.00320819 │    nan │ 0.00509388 │ 0.00340632  │     nan │ 0.00174142  │ 0.00205599  │     nan │     nan │     nan │     nan │     nan │ 0.00331017 │ 0.00709705 │ 0.0078575   │     nan │ 0.00277689 │ 0.00822523 │ 0.00885638 │
├───────┼──────────────────────────────────────────────────────────────────┼────────────┼──────────┼────────────┼─────────────┼──────────┼─────────────┼───────────┼─────────────┼────────────┼────────┼────────────┼────────────┼─────────────┼──────────┼────────────┼────────────┼──────────┼──────────┼────────────┼────────┼───────────┼───────────┼─────────────┼───────────┼────────────┼────────────┼────────────┼──────────┼──────────┼──────────┼────────┼────────────┼────────────┼─────────────┼─────────┼─────────────┼───────────┼───────────┼────────────┼───────────┼──────────┼───────────┼─────────────┼────────────┼──────────────┼────────────┼──────────┼───────────┼─────────────┼────────────┼──────────┼───────────┼────────┼────────┼─────────────┼──────────┼────────────┼──────────┼─────────────┼────────┼─────────────┼────────┼──────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼────────────┼────────────┼─────────────┼──────────┼────────────┼────────┼─────────────┼─────────────┼────────────┼────────┼─────────────┼─────────────┼───────────┼─────────────┼─────────────┼─────────────┼─────────────┼─────────────┼───────┼─────────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────────┼──────────┼─────────────┼─────────┼────────────┼────────────┼─────────────┼─────────────┼────────────┼────────────┼─────────────┼────────┼────────┼─────────────┼────────────┼────────┼─────────────┼────────────┼────────┼────────┼─────────────┼────────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────────┼─────────────┼────────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼──────────┼──────────┼───────────┼──────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────┼─────────┼─────────────┼─────────────┼────────────┼────────┼─────────┼────────┼─────────┼────────────┼─────────┼─────────┼────────┼─────────┼────────────┼─────────────┼──────────┼─────────┼───────────┼─────────┼─────────┼───────────┼───────────┼─────────┼──────────┼──────────┼────────────┼──────────┼─────────────┼─────────┼────────────┼─────────┼─────────┼────────────┼────────┼────────────┼─────────────┼─────────┼─────────────┼─────────────┼─────────┼─────────┼─────────┼─────────┼─────────┼────────────┼────────────┼─────────────┼─────────┼────────────┼────────────┼────────────┤
│ 21604 │ fffff1d38b785cef84adeace64f8f83db3a0c31e8d92eaba8b115f71cab04681 │ 2018-01-06 │ 0.983019 │ 0.443984   │ 0.0131506   │ 0.815422 │ 0.00345666  │ 0.100503  │ 0.00211136  │ 0.0123429  │    nan │ 0.0065908  │ 0.00235049 │ 0.0164248   │ 0.747021 │ 0.0118573  │ 0.00836593 │ 0.39605  │ 0.530051 │ 0.0320045  │    nan │ 0.181703  │ 0.0161388 │ 0.00205031  │ 0.0942802 │ 0.0070141  │ 0.00408982 │ 0.0096977  │ 0.284209 │ 0.711415 │ 0.891591 │    nan │ 0.00430822 │ 0.00812099 │ 0.00973736  │ 1.00662 │ 0.00941841  │ 0.0513312 │ 0.061328  │ 0.32698    │ 0.0226323 │ 0.138062 │ 0.0451061 │ 0.00820883  │ 0.00243311 │   0.0255705  │ 0.0107452  │ 0.31268  │ 0.176868  │  0.0130287  │ 0.0121847  │ 0.800476 │ 0.328972  │ CL     │ O      │ 0.000904041 │ 0.757985 │ 0.178055   │ 1.002    │ 0.000679138 │    nan │ 0.00138746  │      5 │ 0.192534 │ 0.000888265 │ 0.00609963  │ 0.00427331 │ 0.00101051  │ 0.00692996 │ 0.00680301 │ 0.0121078  │ 0.00931326  │ 0.20047  │ 0.0130412  │    nan │ 0.00551576  │ 0.00622886  │ 0.0032797  │    nan │ 0.00630154  │ 0.00292608  │ 0.300316  │ 0.000706332 │ 0.00816389  │ 0.00718466  │ 0.00236253  │ 0.00187878  │   nan │ 0.00589711  │ 0.00512095  │ 0.00642161 │ 0.00571174  │ 0.00353871  │ 0.00902542  │ 0.502683 │ 0.00616393  │ 1.00331 │ 0.0188456  │ 0.00618801 │ 0.00245985  │ 0.00558085  │ 0.00169432 │ 0.00789482 │ 0.00669533  │    nan │      0 │ 0.00394038  │ 0.00723228 │    nan │ 0.00524287  │ 0.00418006 │    nan │      1 │ 0.00689965  │ 0.00907128 │ 0.00485114  │ 0.00748933  │ 0.00112946 │ 0.000365128 │ 1.00894    │ 0.0095033   │ 0.000864763 │ 0.00568987  │ 0.00334932  │ 0.0098897  │ 0.0040175   │ 0.0087748   │ 0.00863152 │ 0.00745615  │ 0.00806786 │ 0.862615 │ 0.138715 │ 0.883456  │ 0.97263  │ 0.00291029  │ 0.00409241 │ 0.00498011  │ 0.00159919  │     nan │     nan │ 0.00228788  │ 0.00427194  │ 0.00906144 │    nan │ 1.00432 │      3 │     nan │ 0.00512786 │     nan │     nan │    nan │ 1.00944 │ 0.0261515  │ 0.345503    │ 0.206613 │       1 │ 0.0296029 │       0 │       3 │ 0.0328637 │ 0.0258646 │       0 │ 0.720331 │ 0.429396 │ 0.00881769 │ 0.461599 │ 0.00470693  │       1 │ 1.00908    │ 1.00081 │ 1.00355 │ 0.00755355 │    nan │ 0.0091471  │ 0.00294629  │     nan │ 0.0060599   │ 0.00507639  │     nan │     nan │     nan │     nan │     nan │ 0.00995528 │ 0.00999359 │ 0.0010882   │     nan │ 0.00569324 │ 0.00677317 │ 0.00556634 │
├───────┼──────────────────────────────────────────────────────────────────┼────────────┼──────────┼────────────┼─────────────┼──────────┼─────────────┼───────────┼─────────────┼────────────┼────────┼────────────┼────────────┼─────────────┼──────────┼────────────┼────────────┼──────────┼──────────┼────────────┼────────┼───────────┼───────────┼─────────────┼───────────┼────────────┼────────────┼────────────┼──────────┼──────────┼──────────┼────────┼────────────┼────────────┼─────────────┼─────────┼─────────────┼───────────┼───────────┼────────────┼───────────┼──────────┼───────────┼─────────────┼────────────┼──────────────┼────────────┼──────────┼───────────┼─────────────┼────────────┼──────────┼───────────┼────────┼────────┼─────────────┼──────────┼────────────┼──────────┼─────────────┼────────┼─────────────┼────────┼──────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼────────────┼────────────┼─────────────┼──────────┼────────────┼────────┼─────────────┼─────────────┼────────────┼────────┼─────────────┼─────────────┼───────────┼─────────────┼─────────────┼─────────────┼─────────────┼─────────────┼───────┼─────────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────────┼──────────┼─────────────┼─────────┼────────────┼────────────┼─────────────┼─────────────┼────────────┼────────────┼─────────────┼────────┼────────┼─────────────┼────────────┼────────┼─────────────┼────────────┼────────┼────────┼─────────────┼────────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────────┼─────────────┼────────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼──────────┼──────────┼───────────┼──────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────┼─────────┼─────────────┼─────────────┼────────────┼────────┼─────────┼────────┼─────────┼────────────┼─────────┼─────────┼────────┼─────────┼────────────┼─────────────┼──────────┼─────────┼───────────┼─────────┼─────────┼───────────┼───────────┼─────────┼──────────┼──────────┼────────────┼──────────┼─────────────┼─────────┼────────────┼─────────┼─────────┼────────────┼────────┼────────────┼─────────────┼─────────┼─────────────┼─────────────┼─────────┼─────────┼─────────┼─────────┼─────────┼────────────┼────────────┼─────────────┼─────────┼────────────┼────────────┼────────────┤
│ 21605 │ fffff1d38b785cef84adeace64f8f83db3a0c31e8d92eaba8b115f71cab04681 │ 2018-02-06 │ 0.969861 │ 0.442553   │ 0.00985513  │ 1.00354  │ 0.00511708  │ 0.101802  │ 0.00993036  │ 0.00857845 │    nan │ 0.0142348  │ 0.00650907 │ 0.00442393  │ 0.74819  │ 0.0195315  │ 0.00470438 │ 0.434467 │ 0.531355 │ 0.0215759  │    nan │ 0.161841  │ 0.0147985 │ 0.00190997  │ 0.099241  │ 0.00318313 │ 0.00662782 │ 0.00572258 │ 0.286614 │ 0.643626 │ 0.298447 │    nan │ 0.00488334 │ 0.0074309  │ 0.00540302  │ 1.00162 │ 0.00954366  │ 0.0571642 │ 0.0488864 │ 0.327939   │ 0.0197211 │ 0.144218 │ 0.0505855 │ 0.00458074  │ 0.00647321 │   0.0170403  │ 0.00376026 │ 0.300423 │ 0.114578  │  0.0322048  │ 0.00988386 │ 0.965168 │ 0.330719  │ CL     │ O      │ 0.00787754  │ 0.671669 │ 0.00735174 │ 1.00851  │ 0.00240323  │    nan │ 0.00829777  │      5 │ 0.187689 │ 0.00994163  │ 0.00391274  │ 0.0024208  │ 0.00822021  │ 0.00514851 │ 0.00419156 │ 0.0116529  │ 0.00955005  │ 0.209341 │ 0.0018004  │    nan │ 0.00267784  │ 0.00490734  │ 0.0068387  │    nan │ 1.75538e-05 │ 0.00544411  │ 0.305354  │ 0.00233757  │ 0.000951692 │ 0.000388893 │ 0.000617    │ 0.00799858  │   nan │ 0.00280428  │ 0.00624843  │ 4.1435e-05 │ 0.00688351  │ 0.00622679  │ 0.000845709 │ 0.502655 │ 0.00112122  │ 1.00091 │ 0.00963493 │ 0.00906724 │ 0.00501833  │ 0.00521382  │ 0.00968889 │ 0.00740218 │ 0.000242821 │    nan │      0 │ 0.00174143  │ 0.00791741 │    nan │ 0.00434306  │ 0.0031086  │    nan │      1 │ 0.00546168  │ 0.0060389  │ 0.00234227  │ 0.00503443  │ 0.00708575 │ 0.00768648  │ 1.00274    │ 0.00810213  │ 0.00651381  │ 0.00495602  │ 0.00953594  │ 0.00669058 │ 0.00425012  │ 0.000501563 │ 8.7703e-05 │ 0.000125749 │ 0.0006356  │ 0.872319 │ 0.132014 │ 0.886145  │ 0.975976 │ 0.00187745  │ 0.00816108 │ 0.0056038   │ 0.0082986   │     nan │     nan │ 0.00920261  │ 0.00656612  │ 0.00806324 │    nan │ 1.00178 │      3 │     nan │ 0.00837661 │     nan │     nan │    nan │ 1.00962 │ 0.0147374  │ 0.208531    │ 0.203652 │       1 │ 0.0284625 │       0 │       3 │ 0.0334803 │ 0.0270279 │       0 │ 0.71733  │ 0.429582 │ 0.00778327 │ 0.459615 │ 0.00328052  │       1 │ 1          │ 1.00619 │ 1.00542 │ 0.00837285 │    nan │ 0.00932034 │ 0.00851143  │     nan │ 0.00381109  │ 0.00868222  │     nan │     nan │     nan │     nan │     nan │ 0.00554102 │ 0.00656426 │ 0.00988268  │     nan │ 0.00812339 │ 0.00116799 │ 0.00398257 │
├───────┼──────────────────────────────────────────────────────────────────┼────────────┼──────────┼────────────┼─────────────┼──────────┼─────────────┼───────────┼─────────────┼────────────┼────────┼────────────┼────────────┼─────────────┼──────────┼────────────┼────────────┼──────────┼──────────┼────────────┼────────┼───────────┼───────────┼─────────────┼───────────┼────────────┼────────────┼────────────┼──────────┼──────────┼──────────┼────────┼────────────┼────────────┼─────────────┼─────────┼─────────────┼───────────┼───────────┼────────────┼───────────┼──────────┼───────────┼─────────────┼────────────┼──────────────┼────────────┼──────────┼───────────┼─────────────┼────────────┼──────────┼───────────┼────────┼────────┼─────────────┼──────────┼────────────┼──────────┼─────────────┼────────┼─────────────┼────────┼──────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼────────────┼────────────┼─────────────┼──────────┼────────────┼────────┼─────────────┼─────────────┼────────────┼────────┼─────────────┼─────────────┼───────────┼─────────────┼─────────────┼─────────────┼─────────────┼─────────────┼───────┼─────────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────────┼──────────┼─────────────┼─────────┼────────────┼────────────┼─────────────┼─────────────┼────────────┼────────────┼─────────────┼────────┼────────┼─────────────┼────────────┼────────┼─────────────┼────────────┼────────┼────────┼─────────────┼────────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────────┼─────────────┼────────────┼─────────────┼─────────────┼────────────┼─────────────┼────────────┼──────────┼──────────┼───────────┼──────────┼─────────────┼────────────┼─────────────┼─────────────┼─────────┼─────────┼─────────────┼─────────────┼────────────┼────────┼─────────┼────────┼─────────┼────────────┼─────────┼─────────┼────────┼─────────┼────────────┼─────────────┼──────────┼─────────┼───────────┼─────────┼─────────┼───────────┼───────────┼─────────┼──────────┼──────────┼────────────┼──────────┼─────────────┼─────────┼────────────┼─────────┼─────────┼────────────┼────────┼────────────┼─────────────┼─────────┼─────────────┼─────────────┼─────────┼─────────┼─────────┼─────────┼─────────┼────────────┼────────────┼─────────────┼─────────┼────────────┼────────────┼────────────┤
│ 21606 │ fffff1d38b785cef84adeace64f8f83db3a0c31e8d92eaba8b115f71cab04681 │ 2018-03-14 │ 0.982175 │ 0.00247371 │ 7.69387e-05 │ 0.99288  │ 0.000809297 │ 0.119165  │ 0.00328729  │ 0.0140916  │    nan │ 0.0134545  │ 0.00679392 │ 0.0183351   │ 0.750784 │ 0.00661706 │ 0.00101603 │ 0.459745 │ 0.53161  │ 0.0185772  │    nan │ 0.233117  │ 0.0281845 │ 0.00791978  │ 0.088608  │ 0.00805739 │ 0.00197626 │ 0.00501446 │ 0.281229 │ 0.611945 │ 0.291345 │    nan │ 0.00458005 │ 0.00565379 │ 0.00560943  │ 1.00355 │ 0.000762599 │ 0.0654661 │ 0.0280857 │ 0.00667417 │ 0.025615  │ 0.142516 │ 0.0484984 │ 0.00811181  │ 0.0167101  │   0.00585367 │ 0.00861382 │ 0.299138 │ 0.0231363 │ -0.0035556  │ 0.00300076 │ 0.280465 │ 0.0788301 │ CL     │ O      │ 0.00316832  │ 0.583801 │ 0.00377119 │ 0.689411 │ 0.00816809  │    nan │ 0.00674287  │      5 │ 0.191495 │ 0.00961445  │ 0.00773618  │ 0.00709129 │ 0.0043876   │ 0.00872127 │ 0.258259   │ 0.0137469  │ 0.00654186  │ 0.505329 │ 0.0179351  │    nan │ 0.00767364  │ 0.08031     │ 0.0716808  │    nan │ 0.00593036  │ 0.00770892  │ 0.0777245 │ 0.00291845  │ 4.5367e-05  │ 0.00637454  │ 0.000248292 │ 0.000835566 │   nan │ 0.00723114  │ 0.00390096  │ 0.00412366 │ 0.00954836  │ 0.00236517  │ 0.00860746  │ 0.501835 │ 0.00243186  │ 1.00661 │ 0.0161454  │ 0.00613457 │ 0.00806499  │ 0.00723782  │ 0.00678782 │ 0.00225419 │ 0.00633582  │    nan │      0 │ 0.00836454  │ 0.00475822 │    nan │ 0.00719428  │ 0.00103103 │    nan │      1 │ 0.00603285  │ 0.00626225 │ 0.0089818   │ 0.0092644   │ 0.00715451 │ 0.00594361  │ 1.00518    │ 0.00704084  │ 0.00567061  │ 0.00820278  │ 0.00208198  │ 0.00886933 │ 0.00373651  │ 0.000146032 │ 0.00979295 │ 0.00971192  │ 0.00219998 │ 0.295251 │ 0.131636 │ 0.0805137 │ 0.97469  │ 0.00534633  │ 0.0034592  │ 0.00578538  │ 0.00910069  │     nan │     nan │ 0.000520197 │ 0.0077809   │ 0.00800425 │    nan │ 1.00518 │      3 │     nan │ 0.00986277 │     nan │     nan │    nan │ 1.00968 │ 0.0517409  │ 0.000567647 │ 0.200206 │       1 │ 0.0375318 │       0 │       3 │ 0.037342  │ 0.033036  │       0 │ 0.728418 │ 0.429784 │ 0.00261789 │ 0.461738 │ 0.00710487  │       1 │ 1.00231    │ 1.00567 │ 1.00066 │ 0.00239206 │    nan │ 0.00063346 │ 0.00134913  │     nan │ 0.00631154  │ 0.00542911  │     nan │     nan │     nan │     nan │     nan │ 0.00731646 │ 0.00288779 │ 0.00620741  │     nan │ 0.00511039 │ 0.00318361 │ 0.00191411 │
╘═══════╧══════════════════════════════════════════════════════════════════╧════════════╧══════════╧════════════╧═════════════╧══════════╧═════════════╧═══════════╧═════════════╧════════════╧════════╧════════════╧════════════╧═════════════╧══════════╧════════════╧════════════╧══════════╧══════════╧════════════╧════════╧═══════════╧═══════════╧═════════════╧═══════════╧════════════╧════════════╧════════════╧══════════╧══════════╧══════════╧════════╧════════════╧════════════╧═════════════╧═════════╧═════════════╧═══════════╧═══════════╧════════════╧═══════════╧══════════╧═══════════╧═════════════╧════════════╧══════════════╧════════════╧══════════╧═══════════╧═════════════╧════════════╧══════════╧═══════════╧════════╧════════╧═════════════╧══════════╧════════════╧══════════╧═════════════╧════════╧═════════════╧════════╧══════════╧═════════════╧═════════════╧════════════╧═════════════╧════════════╧════════════╧════════════╧═════════════╧══════════╧════════════╧════════╧═════════════╧═════════════╧════════════╧════════╧═════════════╧═════════════╧═══════════╧═════════════╧═════════════╧═════════════╧═════════════╧═════════════╧═══════╧═════════════╧═════════════╧════════════╧═════════════╧═════════════╧═════════════╧══════════╧═════════════╧═════════╧════════════╧════════════╧═════════════╧═════════════╧════════════╧════════════╧═════════════╧════════╧════════╧═════════════╧════════════╧════════╧═════════════╧════════════╧════════╧════════╧═════════════╧════════════╧═════════════╧═════════════╧════════════╧═════════════╧════════════╧═════════════╧═════════════╧═════════════╧═════════════╧════════════╧═════════════╧═════════════╧════════════╧═════════════╧════════════╧══════════╧══════════╧═══════════╧══════════╧═════════════╧════════════╧═════════════╧═════════════╧═════════╧═════════╧═════════════╧═════════════╧════════════╧════════╧═════════╧════════╧═════════╧════════════╧═════════╧═════════╧════════╧═════════╧════════════╧═════════════╧══════════╧═════════╧═══════════╧═════════╧═════════╧═══════════╧═══════════╧═════════╧══════════╧══════════╧════════════╧══════════╧═════════════╧═════════╧════════════╧═════════╧═════════╧════════════╧════════╧════════════╧═════════════╧═════════╧═════════════╧═════════════╧═════════╧═════════╧═════════╧═════════╧═════════╧════════════╧════════════╧═════════════╧═════════╧════════════╧════════════╧════════════╛
</pre></div>
</div>
</div>
</div>
<p>Observando las características superficiales del conjunto de datos de tipo <code class="docutils literal notranslate"><span class="pre">label</span></code>, que contiene la etiqueta para cada cliente que realizò una transaciòn y la variable respuesta o <code class="docutils literal notranslate"><span class="pre">target</span></code> que indica si fue o no una transacciòn fraudulenta. El conjunto de datos posee 458913 identificadores de cliente diferentes de dos variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">n_columnas</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">label_train</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">n_filas</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">label_train</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;El conjunto de entrenamiento para la variable respuesta tiene </span><span class="si">{</span><span class="n">n_filas</span><span class="si">}</span><span class="s2"> filas y </span><span class="si">{</span><span class="n">n_columnas</span><span class="si">}</span><span class="s2"> columnas.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>El conjunto de entrenamiento para la variable respuesta tiene 458913 filas y 2 columnas.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">label_train</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">headers</span><span class="o">=</span><span class="s1">&#39;keys&#39;</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s1">&#39;fancy_grid&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>╒════════╤══════════════════════════════════════════════════════════════════╤══════════╕
│        │ customer_ID                                                      │   target │
╞════════╪══════════════════════════════════════════════════════════════════╪══════════╡
│ 458903 │ fffec7d7e1ca804c86f1ffdaac389c33f8039ed35bf412b12d2e3548e49d54fa │        0 │
├────────┼──────────────────────────────────────────────────────────────────┼──────────┤
│ 458904 │ fffee056e120fb326c9413fca5a7ab6618cc49be9bb6b19c34f3fb13fd50fdd3 │        0 │
├────────┼──────────────────────────────────────────────────────────────────┼──────────┤
│ 458905 │ fffee847c5c1af7dbdd36d98fea882893256c422cde86cc927c7cce6e958dab4 │        0 │
├────────┼──────────────────────────────────────────────────────────────────┼──────────┤
│ 458906 │ fffef3305f19a11fb6c15f4ebe9be1bd664540e57c0a6aa2ed6a31c31c8069f8 │        0 │
├────────┼──────────────────────────────────────────────────────────────────┼──────────┤
│ 458907 │ ffff39cc22a375d07369980d02d617883dd28ad81a6aa36d506127604c66301c │        0 │
├────────┼──────────────────────────────────────────────────────────────────┼──────────┤
│ 458908 │ ffff41c8a52833b56430603969b9ca48d208e7c192c6a4081a6acc28cf4f8af7 │        0 │
├────────┼──────────────────────────────────────────────────────────────────┼──────────┤
│ 458909 │ ffff518bb2075e4816ee3fe9f3b152c57fc0e6f01bf7fdd3e5b57cfcbee30286 │        0 │
├────────┼──────────────────────────────────────────────────────────────────┼──────────┤
│ 458910 │ ffff9984b999fccb2b6127635ed0736dda94e544e67e026eee4d20f680639ff6 │        0 │
├────────┼──────────────────────────────────────────────────────────────────┼──────────┤
│ 458911 │ ffffa5c46bc8de74f5a4554e74e239c8dee6b9baf388145b2c3d01967fcce461 │        1 │
├────────┼──────────────────────────────────────────────────────────────────┼──────────┤
│ 458912 │ fffff1d38b785cef84adeace64f8f83db3a0c31e8d92eaba8b115f71cab04681 │        0 │
╘════════╧══════════════════════════════════════════════════════════════════╧══════════╛
</pre></div>
</div>
</div>
</div>
<p>Para poder identificar las variables o caracterìsticas de manera màs cercana, se extrae el nombre y tipo de cada una, se cambia el nombre de la variable <code class="docutils literal notranslate"><span class="pre">S_2</span></code> a <code class="docutils literal notranslate"><span class="pre">Date</span></code>, ya que esta representa la fecha en la que se realizó la transacción y se identifica que variables son las que corresponde a cada grupo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data_train</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;customer_ID&#39;, &#39;S_2&#39;, &#39;P_2&#39;, &#39;D_39&#39;, &#39;B_1&#39;, &#39;B_2&#39;, &#39;R_1&#39;, &#39;S_3&#39;, &#39;D_41&#39;, &#39;B_3&#39;, &#39;D_42&#39;, &#39;D_43&#39;, &#39;D_44&#39;, &#39;B_4&#39;, &#39;D_45&#39;, &#39;B_5&#39;, &#39;R_2&#39;, &#39;D_46&#39;, &#39;D_47&#39;, &#39;D_48&#39;, &#39;D_49&#39;, &#39;B_6&#39;, &#39;B_7&#39;, &#39;B_8&#39;, &#39;D_50&#39;, &#39;D_51&#39;, &#39;B_9&#39;, &#39;R_3&#39;, &#39;D_52&#39;, &#39;P_3&#39;, &#39;B_10&#39;, &#39;D_53&#39;, &#39;S_5&#39;, &#39;B_11&#39;, &#39;S_6&#39;, &#39;D_54&#39;, &#39;R_4&#39;, &#39;S_7&#39;, &#39;B_12&#39;, &#39;S_8&#39;, &#39;D_55&#39;, &#39;D_56&#39;, &#39;B_13&#39;, &#39;R_5&#39;, &#39;D_58&#39;, &#39;S_9&#39;, &#39;B_14&#39;, &#39;D_59&#39;, &#39;D_60&#39;, &#39;D_61&#39;, &#39;B_15&#39;, &#39;S_11&#39;, &#39;D_62&#39;, &#39;D_63&#39;, &#39;D_64&#39;, &#39;D_65&#39;, &#39;B_16&#39;, &#39;B_17&#39;, &#39;B_18&#39;, &#39;B_19&#39;, &#39;D_66&#39;, &#39;B_20&#39;, &#39;D_68&#39;, &#39;S_12&#39;, &#39;R_6&#39;, &#39;S_13&#39;, &#39;B_21&#39;, &#39;D_69&#39;, &#39;B_22&#39;, &#39;D_70&#39;, &#39;D_71&#39;, &#39;D_72&#39;, &#39;S_15&#39;, &#39;B_23&#39;, &#39;D_73&#39;, &#39;P_4&#39;, &#39;D_74&#39;, &#39;D_75&#39;, &#39;D_76&#39;, &#39;B_24&#39;, &#39;R_7&#39;, &#39;D_77&#39;, &#39;B_25&#39;, &#39;B_26&#39;, &#39;D_78&#39;, &#39;D_79&#39;, &#39;R_8&#39;, &#39;R_9&#39;, &#39;S_16&#39;, &#39;D_80&#39;, &#39;R_10&#39;, &#39;R_11&#39;, &#39;B_27&#39;, &#39;D_81&#39;, &#39;D_82&#39;, &#39;S_17&#39;, &#39;R_12&#39;, &#39;B_28&#39;, &#39;R_13&#39;, &#39;D_83&#39;, &#39;R_14&#39;, &#39;R_15&#39;, &#39;D_84&#39;, &#39;R_16&#39;, &#39;B_29&#39;, &#39;B_30&#39;, &#39;S_18&#39;, &#39;D_86&#39;, &#39;D_87&#39;, &#39;R_17&#39;, &#39;R_18&#39;, &#39;D_88&#39;, &#39;B_31&#39;, &#39;S_19&#39;, &#39;R_19&#39;, &#39;B_32&#39;, &#39;S_20&#39;, &#39;R_20&#39;, &#39;R_21&#39;, &#39;B_33&#39;, &#39;D_89&#39;, &#39;R_22&#39;, &#39;R_23&#39;, &#39;D_91&#39;, &#39;D_92&#39;, &#39;D_93&#39;, &#39;D_94&#39;, &#39;R_24&#39;, &#39;R_25&#39;, &#39;D_96&#39;, &#39;S_22&#39;, &#39;S_23&#39;, &#39;S_24&#39;, &#39;S_25&#39;, &#39;S_26&#39;, &#39;D_102&#39;, &#39;D_103&#39;, &#39;D_104&#39;, &#39;D_105&#39;, &#39;D_106&#39;, &#39;D_107&#39;, &#39;B_36&#39;, &#39;B_37&#39;, &#39;R_26&#39;, &#39;R_27&#39;, &#39;B_38&#39;, &#39;D_108&#39;, &#39;D_109&#39;, &#39;D_110&#39;, &#39;D_111&#39;, &#39;B_39&#39;, &#39;D_112&#39;, &#39;B_40&#39;, &#39;S_27&#39;, &#39;D_113&#39;, &#39;D_114&#39;, &#39;D_115&#39;, &#39;D_116&#39;, &#39;D_117&#39;, &#39;D_118&#39;, &#39;D_119&#39;, &#39;D_120&#39;, &#39;D_121&#39;, &#39;D_122&#39;, &#39;D_123&#39;, &#39;D_124&#39;, &#39;D_125&#39;, &#39;D_126&#39;, &#39;D_127&#39;, &#39;D_128&#39;, &#39;D_129&#39;, &#39;B_41&#39;, &#39;B_42&#39;, &#39;D_130&#39;, &#39;D_131&#39;, &#39;D_132&#39;, &#39;D_133&#39;, &#39;R_28&#39;, &#39;D_134&#39;, &#39;D_135&#39;, &#39;D_136&#39;, &#39;D_137&#39;, &#39;D_138&#39;, &#39;D_139&#39;, &#39;D_140&#39;, &#39;D_141&#39;, &#39;D_142&#39;, &#39;D_143&#39;, &#39;D_144&#39;, &#39;D_145&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data_train</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[string[pyarrow], string[pyarrow], dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), string[pyarrow], string[pyarrow], dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;int64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;), dtype(&#39;float64&#39;)]
</pre></div>
</div>
</div>
</div>
</section>
<section id="cambiar-nombre">
<h2>Cambiar nombre<a class="headerlink" href="#cambiar-nombre" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rename_columns</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;S_2&#39;</span><span class="p">:</span> <span class="s1">&#39;Date&#39;</span>
<span class="p">}</span>

<span class="n">data_train</span> <span class="o">=</span> <span class="n">data_train</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">rename_columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Las estadìsticas iniciales de los datos se identifican a continuaciòn ùnicamente con el 10% de los datos extraidos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_describe</span> <span class="o">=</span> <span class="n">data_train</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>  <span class="c1"># Muestra del 10% de los datos</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">tabulate</span><span class="p">(</span><span class="n">df_describe</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s1">&#39;keys&#39;</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s1">&#39;grid&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-------+---------------+------------------+-----------------+------------------+------------------+---------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+------------------+---------------+----------------+-----------------+-----------------+-----------------+----------------+------------------+----------------+------------------+------------------+------------------+-----------------+---------------+-----------------+------------------+------------------+------------------+------------------+----------------+------------------+----------------+------------------+-----------------+------------------+----------------+------------------+------------------+------------------+-----------------+-----------------+----------------+------------------+-----------------+-----------------+---------------+-----------------+------------------+------------------+------------------+------------------+------------------+--------------+------------------+--------------+---------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+---------------+------------------+--------------+-----------------+------------------+------------------+----------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+----------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+-----------------+---------------+------------------+------------------+--------+------------------+------------------+---------------+----------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+---------------+---------------+---------------+---------------+------------------+------------------+------------------+------------------+----------------+-----------------+------------------+------------------+-----------------+-----------------+----------------+--------------+----------------+------------------+--------------+----------------+-------------+------------------+------------------+------------------+------------------+---------------+------------------+-----------------+--------------+------------------+------------------+---------------+----------------+------------------+------------------+----------------+------------------+---------------+------------------+------------------+------------------+------------------+----------------+------------------+------------------+---------------+------------------+------------------+---------------+----------------+-----------------+----------------+-----------------+------------------+------------------+------------------+---------------+------------------+------------------+------------------+
|       |           P_2 |             D_39 |             B_1 |              B_2 |              R_1 |           S_3 |             D_41 |              B_3 |            D_42 |             D_43 |             D_44 |              B_4 |             D_45 |              B_5 |              R_2 |          D_46 |           D_47 |            D_48 |            D_49 |             B_6 |            B_7 |              B_8 |           D_50 |             D_51 |              B_9 |              R_3 |            D_52 |           P_3 |            B_10 |             D_53 |              S_5 |             B_11 |              S_6 |           D_54 |              R_4 |            S_7 |             B_12 |             S_8 |             D_55 |           D_56 |             B_13 |              R_5 |             D_58 |             S_9 |            B_14 |           D_59 |             D_60 |            D_61 |            B_15 |          S_11 |            D_62 |             D_65 |             B_16 |             B_17 |             B_18 |             B_19 |         D_66 |             B_20 |         D_68 |          S_12 |              R_6 |             S_13 |             B_21 |             D_69 |             B_22 |             D_70 |             D_71 |             D_72 |          S_15 |             B_23 |         D_73 |             P_4 |             D_74 |             D_75 |           D_76 |             B_24 |              R_7 |             D_77 |            B_25 |             B_26 |             D_78 |             D_79 |              R_8 |             R_9 |             S_16 |             D_80 |             R_10 |             R_11 |             B_27 |            D_81 |             D_82 |             S_17 |           R_12 |             B_28 |             R_13 |             D_83 |             R_14 |             R_15 |            D_84 |             R_16 |            B_29 |          B_30 |             S_18 |             D_86 |   D_87 |             R_17 |             R_18 |          D_88 |           B_31 |             S_19 |            R_19 |             B_32 |             S_20 |             R_20 |             R_21 |             B_33 |             D_89 |            R_22 |             R_23 |             D_91 |             D_92 |            D_93 |             D_94 |             R_24 |             R_25 |             D_96 |          S_22 |          S_23 |          S_24 |          S_25 |             S_26 |            D_102 |            D_103 |            D_104 |          D_105 |           D_106 |            D_107 |             B_36 |            B_37 |            R_26 |           R_27 |         B_38 |          D_108 |            D_109 |        D_110 |          D_111 |        B_39 |            D_112 |             B_40 |             S_27 |            D_113 |         D_114 |            D_115 |           D_116 |        D_117 |            D_118 |            D_119 |         D_120 |          D_121 |            D_122 |            D_123 |          D_124 |            D_125 |         D_126 |            D_127 |            D_128 |            D_129 |             B_41 |           B_42 |            D_130 |            D_131 |         D_132 |            D_133 |             R_28 |         D_134 |          D_135 |           D_136 |          D_137 |           D_138 |            D_139 |            D_140 |            D_141 |         D_142 |            D_143 |            D_144 |            D_145 |
+=======+===============+==================+=================+==================+==================+===============+==================+==================+=================+==================+==================+==================+==================+==================+==================+===============+================+=================+=================+=================+================+==================+================+==================+==================+==================+=================+===============+=================+==================+==================+==================+==================+================+==================+================+==================+=================+==================+================+==================+==================+==================+=================+=================+================+==================+=================+=================+===============+=================+==================+==================+==================+==================+==================+==============+==================+==============+===============+==================+==================+==================+==================+==================+==================+==================+==================+===============+==================+==============+=================+==================+==================+================+==================+==================+==================+=================+==================+==================+==================+==================+=================+==================+==================+==================+==================+==================+=================+==================+==================+================+==================+==================+==================+==================+==================+=================+==================+=================+===============+==================+==================+========+==================+==================+===============+================+==================+=================+==================+==================+==================+==================+==================+==================+=================+==================+==================+==================+=================+==================+==================+==================+==================+===============+===============+===============+===============+==================+==================+==================+==================+================+=================+==================+==================+=================+=================+================+==============+================+==================+==============+================+=============+==================+==================+==================+==================+===============+==================+=================+==============+==================+==================+===============+================+==================+==================+================+==================+===============+==================+==================+==================+==================+================+==================+==================+===============+==================+==================+===============+================+=================+================+=================+==================+==================+==================+===============+==================+==================+==================+
| count | 548513        | 553155           | 553155          | 552959           | 553155           | 451156        | 552959           | 552959           | 79569           | 387675           | 525996           | 553155           | 552959           | 553155           | 553155           | 432420        | 553155         | 481523          | 55249           | 553136          | 553155         | 550859           | 238420         | 553155           | 553155           | 553155           | 550196          | 522921        | 553155          | 144763           | 553155           | 553155           | 553155           | 552959         | 553155           | 451156         | 553155           | 553155          | 534762           | 253673         | 548128           | 553155           | 553155           | 259528          | 553155          | 542358         | 553155           | 493644          | 552486          | 553155        | 477739          | 553155           | 552959           | 239220           | 553155           | 552959           | 62827        | 552959           | 531427       | 553155        | 553155           | 553155           | 553155           | 533644           | 552959           | 543599           | 553155           | 550788           | 553155        | 553155           | 5698         | 553155          | 550983           | 553155           | 62219          | 553155           | 553155           | 301911           | 552486          | 552959           | 525996           | 545427           | 553155           | 31566           | 553155           | 550983           | 553155           | 553155           | 552959           | 550579          | 147662           | 553155           | 553147         | 553155           | 553155           | 533644           | 553155           | 553155           | 550196          | 553155           | 37968           | 552959        | 553155           | 553155           |    429 | 553155           | 553155           | 643           | 553155         | 553155           | 553155          | 553155           | 553155           | 553149           | 553155           | 552959           | 550196           | 553155          | 553155           | 537320           | 553155           | 553155          | 553155           | 553155           | 553155           | 553155           | 551195        | 553114        | 551247        | 551891        | 553092           | 549079           | 542769           | 542769           | 250766         | 54845           | 542769           | 553155           | 553151          | 61086           | 540352         | 552959       | 2907           | 552993           | 3104         | 3104           | 3330        | 552896           | 553151           | 412758           | 535377           | 535377        | 535377           | 535377          | 535377       | 535377           | 535377           | 535377        | 535377         | 535377           | 535377           | 535377         | 535377           | 541422        | 553155           | 542769           | 542769           | 553084           | 7038           | 542769           | 542769           | 54950         | 548864           | 553155           | 19553         | 19553          | 19553           | 19553          | 19553           | 542769           | 549081           | 542769           | 94603         | 542769           | 549072           | 542769           |
+-------+---------------+------------------+-----------------+------------------+------------------+---------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+------------------+---------------+----------------+-----------------+-----------------+-----------------+----------------+------------------+----------------+------------------+------------------+------------------+-----------------+---------------+-----------------+------------------+------------------+------------------+------------------+----------------+------------------+----------------+------------------+-----------------+------------------+----------------+------------------+------------------+------------------+-----------------+-----------------+----------------+------------------+-----------------+-----------------+---------------+-----------------+------------------+------------------+------------------+------------------+------------------+--------------+------------------+--------------+---------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+---------------+------------------+--------------+-----------------+------------------+------------------+----------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+----------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+-----------------+---------------+------------------+------------------+--------+------------------+------------------+---------------+----------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+---------------+---------------+---------------+---------------+------------------+------------------+------------------+------------------+----------------+-----------------+------------------+------------------+-----------------+-----------------+----------------+--------------+----------------+------------------+--------------+----------------+-------------+------------------+------------------+------------------+------------------+---------------+------------------+-----------------+--------------+------------------+------------------+---------------+----------------+------------------+------------------+----------------+------------------+---------------+------------------+------------------+------------------+------------------+----------------+------------------+------------------+---------------+------------------+------------------+---------------+----------------+-----------------+----------------+-----------------+------------------+------------------+------------------+---------------+------------------+------------------+------------------+
| mean  |      0.655986 |      0.152873    |      0.123891   |      0.62124     |      0.0788969   |      0.226108 |      0.0598101   |      0.132709    |     0.185753    |      0.155042    |      0.11869     |      0.17281     |      0.251591    |      0.0829444   |      0.0475238   |      0.475626 |      0.406848  |      0.381845   |     0.191264    |      0.152121   |      0.186241  |      0.45195     |      0.172053  |      0.144461    |      0.189568    |      0.121069    |      0.179748   |      0.601356 |      0.230498   |      0.0763171   |      0.0881868   |      0.110817    |      0.24434     |      0.98457   |      0.0310322   |      0.223482  |      0.0927684   |      0.327252   |      0.298679    |      0.203462  |      0.0999791   |      0.0346476   |      0.215989    |      0.0739254  |      0.100987   |      0.362664  |      0.375094    |      0.429432   |      0.0526117  |      0.375356 |      0.190164   |      0.0403707   |      0.348934    |      0.714564    |      0.59574     |      0.150434    |     0.989161 |      0.23634     |      5.01084 |      0.24023  |      0.0591661   |      0.254567    |      0.0530828   |      0.167967    |      0.10736     |      0.11091     |      0.0706678   |      0.0376785   |      0.37496  |      0.171615    |    0.153528  |      0.144678   |      0.153798    |      0.171476    |     0.140384   |      0.039296    |      0.0887904   |      0.255793    |      0.10387    |      0.0943908   |      0.0624662   |      0.0698765   |      0.0386062   |     0.228378    |      0.0503193   |      0.112206    |      0.0645404   |      0.0509283   |      0.00500395  |      0.0548006  |      0.4578      |      0.0395767   |      0.979318  |      0.154741    |      0.00547571  |      0.0410514   |      0.252479    |      0.0202812   |      0.0448544  |      0.0584468   |     0.0344515   |      0.158388 |      0.0311019   |      0.0375636   |      1 |      0.00531456  |      0.00501508  |   0.158574    |      0.997015  |      0.00502417  |      0.0227225  |      0.0272778   |      0.0175115   |      0.0375259   |      0.021731    |      0.612174    |      0.00642389  |      0.00860497 |      0.0053044   |      0.0619359   |      0.0898624   |      0.0150382  |      0.0223682   |      0.0189877   |      0.00828705  |      0.0356252   |      0.778442 |      0.178395 |      0.733712 |      0.925174 |      0.0670753   |      0.189412    |      0.467014    |      0.450378    |      0.369858  |     0.201736    |      0.206706    |      0.00632864  |      0.123072   |     0.0852084   |      0.893439  |      2.71814 |    0.0793552   |      0.00663352  |    0.739009  |    0.873606    |    0.260146 |      0.841911    |      0.21593     |      0.27826     |      0.15713     |      0.619403 |      0.277872    |      0.00130936 |      2.31842 |      0.283313    |      0.27928     |      0.117224 |      0.531948  |      0.404102    |      0.0501164   |      0.305228  |      0.0844701   |      0.738297 |      0.106947    |      0.583784    |      0.439039    |      0.0322831   |    0.108301    |      0.203699    |      0.104677    |     0.210626  |      0.0467108   |      0.00576655  |     0.329045  |     0.0303584  |     0.244649    |     0.0140761  |     0.164849    |      0.1793      |      0.0264582   |      0.164882    |     0.391423  |      0.179168    |      0.0524816   |      0.0625097   |
+-------+---------------+------------------+-----------------+------------------+------------------+---------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+------------------+---------------+----------------+-----------------+-----------------+-----------------+----------------+------------------+----------------+------------------+------------------+------------------+-----------------+---------------+-----------------+------------------+------------------+------------------+------------------+----------------+------------------+----------------+------------------+-----------------+------------------+----------------+------------------+------------------+------------------+-----------------+-----------------+----------------+------------------+-----------------+-----------------+---------------+-----------------+------------------+------------------+------------------+------------------+------------------+--------------+------------------+--------------+---------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+---------------+------------------+--------------+-----------------+------------------+------------------+----------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+----------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+-----------------+---------------+------------------+------------------+--------+------------------+------------------+---------------+----------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+---------------+---------------+---------------+---------------+------------------+------------------+------------------+------------------+----------------+-----------------+------------------+------------------+-----------------+-----------------+----------------+--------------+----------------+------------------+--------------+----------------+-------------+------------------+------------------+------------------+------------------+---------------+------------------+-----------------+--------------+------------------+------------------+---------------+----------------+------------------+------------------+----------------+------------------+---------------+------------------+------------------+------------------+------------------+----------------+------------------+------------------+---------------+------------------+------------------+---------------+----------------+-----------------+----------------+-----------------+------------------+------------------+------------------+---------------+------------------+------------------+------------------+
| std   |      0.244415 |      0.270011    |      0.211601   |      0.401435    |      0.2262      |      0.193377 |      0.203371    |      0.235073    |     0.229215    |      0.212713    |      0.222026    |      0.222545    |      0.242563    |      0.399751    |      0.201814    |      0.170412 |      0.234613  |      0.326452   |     0.249282    |      1.57888    |      0.230198  |      0.49709     |      0.478562  |      0.241369    |      0.28711     |      0.210202    |      0.173364   |      0.170787 |      3.96665    |      0.205224    |      0.418148    |      0.207874    |      0.426686    |      0.141336  |      0.159262    |      0.206489  |      0.590365    |      0.302965   |      0.288952    |      0.208306  |      0.489415    |      0.257214    |      0.260736    |      0.19445    |      0.286702   |      0.193121  |      0.371527    |      0.339293   |      0.303713   |      0.19078  |      0.231142   |      0.418992    |      0.402493    |      0.38695     |      0.365657    |      0.289845    |     0.103547 |      0.373707    |      1.35193 |      0.226063 |      0.645582    |      0.296848    |      0.745716    |     19.3399      |      0.223645    |      0.22782     |      0.314101    |      0.202745    |      0.195345 |      0.229073    |    0.197996  |      0.339015   |      0.219583    |      0.224546    |     0.300964   |      0.311169    |      1.49756     |      0.23412     |      0.209667   |      3.04839     |      0.259021    |      0.220202    |      0.310153    |     0.186804    |      0.728904    |      0.21479     |      0.304099    |      0.176553    |      0.0029585   |      0.339577   |      0.190145    |      0.240762    |      0.153371  |      0.228688    |      0.00723058  |      0.309231    |      8.8157      |      0.122694    |      0.28594    |      0.237115    |     0.281319    |      0.391752 |      0.159466    |      0.177518    |      0 |      0.00623306  |      0.00334208  |   0.207013    |      0.0545508 |      0.00302249  |      0.131967   |      0.14762     |      0.111174    |      0.38618     |      0.128307    |      0.488396    |      0.0186092   |      0.0599879  |      0.0176717   |      0.185705    |      0.291982    |      0.0997264  |      0.130676    |      0.117498    |      0.0573113   |      0.172338    |      0.742231 |      0.331682 |      0.891323 |      0.206555 |      0.486302    |      0.274489    |      0.498562    |      0.480716    |      0.250229  |     0.46236     |      0.257061    |      0.0208424   |      0.211437   |     0.24584     |      0.312605  |      1.58311 |    0.359684    |      0.0405013   |    0.31128   |    0.268625    |    0.297473 |      0.368631    |     11.8286      |      0.327143    |      0.225969    |      0.485534 |      0.256323    |      0.0361614  |      2.28872 |      0.255988    |      0.256542    |      0.321687 |      0.233835  |      0.236815    |      0.222195    |      0.22609   |      0.292428    |      0.538634 |      0.302597    |      0.493202    |      0.495634    |      0.220961    |    0.295698    |      0.399035    |      0.297073    |     0.251981  |      0.173229    |      0.0277965   |     0.296727  |     0.157322   |     0.210192    |     0.0950458  |     0.270415    |      0.379377    |      0.144947    |      0.34863     |     0.237305  |      0.379261    |      0.182571    |      0.194126    |
+-------+---------------+------------------+-----------------+------------------+------------------+---------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+------------------+---------------+----------------+-----------------+-----------------+-----------------+----------------+------------------+----------------+------------------+------------------+------------------+-----------------+---------------+-----------------+------------------+------------------+------------------+------------------+----------------+------------------+----------------+------------------+-----------------+------------------+----------------+------------------+------------------+------------------+-----------------+-----------------+----------------+------------------+-----------------+-----------------+---------------+-----------------+------------------+------------------+------------------+------------------+------------------+--------------+------------------+--------------+---------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+---------------+------------------+--------------+-----------------+------------------+------------------+----------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+----------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+-----------------+---------------+------------------+------------------+--------+------------------+------------------+---------------+----------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+---------------+---------------+---------------+---------------+------------------+------------------+------------------+------------------+----------------+-----------------+------------------+------------------+-----------------+-----------------+----------------+--------------+----------------+------------------+--------------+----------------+-------------+------------------+------------------+------------------+------------------+---------------+------------------+-----------------+--------------+------------------+------------------+---------------+----------------+------------------+------------------+----------------+------------------+---------------+------------------+------------------+------------------+------------------+----------------+------------------+------------------+---------------+------------------+------------------+---------------+----------------+-----------------+----------------+-----------------+------------------+------------------+------------------+---------------+------------------+------------------+------------------+
| min   |     -0.371125 |      6.57543e-08 |     -0.834858   |      5.33625e-07 |      3.24039e-09 |     -0.498407 |      1.53098e-08 |      1.07313e-07 |    -0.000243172 |      9.98698e-07 |      5.15309e-10 |      2.17517e-08 |      3.35074e-06 |      2.80482e-11 |      6.18323e-08 |     -5.75948  |     -0.0266202 |     -0.00961356 |     7.79665e-06 |     -0.00483231 |     -0.29774   |      2.98675e-08 |     -4.49826   |      1.08796e-08 |      3.92699e-08 |      1.73584e-08 |     -0.00700937 |     -1.29021  |     -0.00295848 |      6.53033e-08 |      6.40258e-08 |      5.88467e-08 |      2.19166e-08 |     -0.0020018 |      6.93068e-08 |     -0.367757  |      1.03997e-06 |      2.0804e-07 |      7.55224e-07 |     -0.0168426 |      1.90585e-08 |      3.97425e-08 |      4.96895e-09 |      6.7135e-07 |     -3.98914    |     -0.0833184 |      9.31538e-08 |     -0.00925804 |     -4.72106    |     -0.199998 |     -0.00213078 |      3.64636e-08 |      3.60938e-09 |      3.77455e-08 |      2.28739e-07 |      7.95831e-09 |     0        |      7.53154e-08 |      0       |     -0.388353 |      4.65068e-10 |      3.38042e-08 |      4.82039e-08 |      4.08091e-08 |      2.30722e-08 |      1.21463e-09 |      4.16147e-07 |      5.43966e-09 |     -0.299953 |      4.36384e-08 |   -0.0452615 |      1.0099e-08 |      7.13489e-09 |      7.98161e-08 |     1.2696e-06 |      2.06467e-08 |      3.31652e-08 |      2.62756e-06 |     -3.7256     |      3.43615e-08 |      2.68667e-08 |      3.74301e-10 |      2.26893e-08 |     4.60541e-07 |      2.91367e-08 |      1.89042e-09 |      2.04636e-08 |      5.31283e-09 |      6.02503e-08 |      2.3081e-08 |      1.87142e-07 |      3.13327e-09 |     -0.0917065 |     -1.82682e-05 |      5.14527e-08 |      5.51171e-09 |      1.74479e-09 |      7.36061e-10 |      2.0118e-09 |      1.57489e-08 |     1.76999e-07 |      0        |      9.59299e-09 |      5.98549e-09 |      1 |      4.09655e-09 |      1.36856e-08 |   0.000847524 |      0         |      2.45771e-08 |      9.078e-09  |      2.41102e-08 |      2.28293e-08 |      1.45197e-08 |      4.01603e-08 |      6.52787e-08 |      7.12388e-09 |      2.2909e-08 |      5.14023e-09 |      1.11768e-09 |      1.68395e-08 |      1.6049e-08 |      7.74804e-09 |      7.80196e-08 |      3.04144e-08 |      8.14067e-10 |    -91.9982   |   -113.385    |    -90.4838   |     -2.45345  |      1.25312e-07 |      1.31594e-08 |      8.60586e-09 |      1.52485e-07 |     -0.0243503 |     4.01513e-07 |      1.43378e-08 |      3.77232e-08 |     -3.22606    |     1.99453e-07 |     -0.0246689 |      1       |    2.39845e-05 |      2.35226e-09 |   -0.0234135 |    7.96419e-05 |   -0.858043 |      9.14336e-07 |      1.83843e-08 |      4.41708e-10 |      1.46347e-11 |      0        |      3.50465e-07 |      0          |     -1       |      9.61365e-08 |      7.07671e-08 |      0        |     -0.0320747 |      6.97848e-07 |      9.52338e-09 |     -0.0454475 |      2.75202e-08 |     -1        |      1.00601e-09 |      2.89862e-08 |      6.12925e-08 |      1.05384e-08 |    3.10857e-06 |      7.95628e-09 |      1.95443e-08 |    -0.0146772 |      4.33532e-09 |      1.49222e-08 |    -0.0116112 |     1.7086e-07 |     3.62364e-06 |     4.1297e-08 |     8.25727e-08 |      2.46299e-09 |      1.95859e-08 |      5.84996e-09 |    -0.0112119 |      7.30819e-09 |      2.50099e-09 |      2.81185e-09 |
+-------+---------------+------------------+-----------------+------------------+------------------+---------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+------------------+---------------+----------------+-----------------+-----------------+-----------------+----------------+------------------+----------------+------------------+------------------+------------------+-----------------+---------------+-----------------+------------------+------------------+------------------+------------------+----------------+------------------+----------------+------------------+-----------------+------------------+----------------+------------------+------------------+------------------+-----------------+-----------------+----------------+------------------+-----------------+-----------------+---------------+-----------------+------------------+------------------+------------------+------------------+------------------+--------------+------------------+--------------+---------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+---------------+------------------+--------------+-----------------+------------------+------------------+----------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+----------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+-----------------+---------------+------------------+------------------+--------+------------------+------------------+---------------+----------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+---------------+---------------+---------------+---------------+------------------+------------------+------------------+------------------+----------------+-----------------+------------------+------------------+-----------------+-----------------+----------------+--------------+----------------+------------------+--------------+----------------+-------------+------------------+------------------+------------------+------------------+---------------+------------------+-----------------+--------------+------------------+------------------+---------------+----------------+------------------+------------------+----------------+------------------+---------------+------------------+------------------+------------------+------------------+----------------+------------------+------------------+---------------+------------------+------------------+---------------+----------------+-----------------+----------------+-----------------+------------------+------------------+------------------+---------------+------------------+------------------+------------------+
| 25%   |      0.512277 |      0.00510493  |      0.00995881 |      0.171975    |      0.00320211  |      0.135668 |      0.00321818  |      0.00594535  |     0.0587152   |      0.047461    |      0.00434301  |      0.0321963   |      0.0627255   |      0.00824012  |      0.0028948   |      0.43168  |      0.25383   |      0.0978535  |     0.093441    |      0.0254665  |      0.0307387 |      0.00498091  |      0.0745922 |      0.00410862  |      0.0065039   |      0.00521855  |      0.086335   |      0.555957 |      0.0346488  |      0.00760646  |      0.00646878  |      0.00747104  |      0.00365602  |      1.00258   |      0.00284444  |      0.0991286 |      0.0117155   |      0.00868051 |      0.0666425   |      0.105381  |      0.0106457   |      0.00288627  |      0.00659973  |      0.0107674  |      0.00967464 |      0.271392  |      0.0530051   |      0.118925   |      0.00347665 |      0.283316 |      0.0371111  |      0.00283977  |      0.00690161  |      0.653312    |      0.24271     |      0.00384922  |     1        |      0.00445525  |      5       |      0.187297 |      0.00289725  |      0.00546709  |      0.00281468  |      0.00284943  |      0.00334871  |      0.00379219  |      0.0091876   |      0.00291319  |      0.209396 |      0.0195295   |    0.0787154 |      0.00325452 |      0.00676308  |      0.00770851  |     0.0296044  |      0.00291856  |      0.00282881  |      0.100402    |      0.00662508 |      0.00291327  |      0.0029649   |      0.00313054  |      0.00284798  |     0.171125    |      0.00285021  |      0.00412495  |      0.0029344   |      0.00295899  |      0.00282281  |      0.00282784 |      0.502252    |      0.00290168  |      1.00254   |      0.0324105   |      0.00284156  |      0.00279843  |      0.00279354  |      0.00280033  |      0.00292614 |      0.00300071  |     0.00384528  |      0        |      0.00284338  |      0.00284319  |      1 |      0.00273412  |      0.0028066   |   0.050081    |      1         |      0.00279791  |      0.00282642 |      0.00287529  |      0.00276635  |      0.0028056   |      0.0028298   |      0.00728262  |      0.00279262  |      0.00272432 |      0.0027472   |      0.00307351  |      0.00299346  |      0.00283458 |      0.00279687  |      0.00276926  |      0.0027829   |      0.00284298  |      0.8887   |      0.133663 |      0.89046  |      0.97123  |      0.00375307  |      0.00505147  |      0.00520956  |      0.00523158  |      0.204551  |     0.091535    |      0.00516953  |      0.00280568  |      0.00991208 |     0.00708398  |      1.00188   |      2       |    0.00422119  |      0.00278763  |    0.717627  |    1.0021      |    0.112344 |      1.00142     |      0.0210729   |      0.00755607  |      0.00487493  |      0        |      0.0840671   |      0          |      1       |      0.0883239   |      0.0834586   |      0        |      0.392327  |      0.152701    |      0.0028783   |      0.144825  |      0.00294174  |      1        |      0.00311877  |      0.00692191  |      0.00491437  |      0.00282597  |    0.010456    |      0.00351342  |      0.00301212  |     0.107901  |      0.00297966  |      0.00285543  |     0.158499  |     0.00389638 |     0.251867    |     0.00379434 |     0.00518568  |      0.00340135  |      0.00282109  |      0.00341874  |     0.269519  |      0.00342897  |      0.0031611   |      0.00344891  |
+-------+---------------+------------------+-----------------+------------------+------------------+---------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+------------------+---------------+----------------+-----------------+-----------------+-----------------+----------------+------------------+----------------+------------------+------------------+------------------+-----------------+---------------+-----------------+------------------+------------------+------------------+------------------+----------------+------------------+----------------+------------------+-----------------+------------------+----------------+------------------+------------------+------------------+-----------------+-----------------+----------------+------------------+-----------------+-----------------+---------------+-----------------+------------------+------------------+------------------+------------------+------------------+--------------+------------------+--------------+---------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+---------------+------------------+--------------+-----------------+------------------+------------------+----------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+----------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+-----------------+---------------+------------------+------------------+--------+------------------+------------------+---------------+----------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+---------------+---------------+---------------+---------------+------------------+------------------+------------------+------------------+----------------+-----------------+------------------+------------------+-----------------+-----------------+----------------+--------------+----------------+------------------+--------------+----------------+-------------+------------------+------------------+------------------+------------------+---------------+------------------+-----------------+--------------+------------------+------------------+---------------+----------------+------------------+------------------+----------------+------------------+---------------+------------------+------------------+------------------+------------------+----------------+------------------+------------------+---------------+------------------+------------------+---------------+----------------+-----------------+----------------+-----------------+------------------+------------------+------------------+---------------+------------------+------------------+------------------+
| 50%   |      0.723279 |      0.00963093  |      0.0377999  |      0.815664    |      0.00628893  |      0.168871 |      0.00617049  |      0.0122133   |     0.157153    |      0.0984732   |      0.00847216  |      0.0972415   |      0.212143    |      0.0181797   |      0.00547561  |      0.465885 |      0.40596   |      0.343175   |     0.164093    |      0.109124   |      0.0958464 |      0.00979684  |      0.124604  |      0.00778321  |      0.0408208   |      0.100433    |      0.151415   |      0.625806 |      0.152261   |      0.019268    |      0.0192222   |      0.0248828   |      0.00702483  |      1.00517   |      0.00541579  |      0.163105  |      0.0241296   |      0.324582   |      0.222997    |      0.169609  |      0.0341509   |      0.0054484   |      0.143391    |      0.0228773  |      0.0339091  |      0.397951  |      0.291402    |      0.443432   |      0.00676544 |      0.32574  |      0.112222   |      0.00551012  |      0.171199    |      0.949453    |      0.651284    |      0.00739926  |     1        |      0.00860405  |      6       |      0.191223 |      0.00556359  |      0.282749    |      0.00540499  |      0.00550793  |      0.00655218  |      0.00725605  |      0.0135286   |      0.00559114  |      0.405013 |      0.0777104   |    0.131863  |      0.00620688 |      0.0783348   |      0.133837    |     0.0979848  |      0.00546416  |      0.00543586  |      0.225276    |      0.0263765  |      0.00556326  |      0.00580878  |      0.00592697  |      0.00539518  |     0.17453     |      0.00539754  |      0.00785972  |      0.00558085  |      0.00573269  |      0.00533242  |      0.00545016 |      0.505135    |      0.00579751  |      1.00515   |      0.0881388   |      0.0054186   |      0.00548303  |      0.00535546  |      0.00539689  |      0.00548744 |      0.00575963  |     0.00622156  |      0        |      0.00548629  |      0.0054697   |      1 |      0.00530924  |      0.00528765  |   0.121624    |      1         |      0.00525712  |      0.00541597 |      0.00545223  |      0.0053447   |      0.00544676  |      0.00537602  |      1.00248     |      0.00539697  |      0.00531089 |      0.00534258  |      0.00598009  |      0.0057847   |      0.00547535 |      0.00534415  |      0.0054657   |      0.00530055  |      0.00541334  |      0.946888 |      0.136501 |      0.954092 |      0.974015 |      0.00715525  |      0.00956847  |      1.00001     |      0.946094    |      0.368575  |     0.179382    |      0.333343    |      0.00534155  |      0.0378498  |     0.0411705   |      1.00472   |      2       |    0.00655868  |      0.0052702   |    0.999955  |    1.00522     |    0.2135   |      1.00436     |      0.0779406   |      0.320895    |      0.00938419  |      1        |      0.236432    |      0          |      3       |      0.266743    |      0.25944     |      0        |      0.616694  |      0.431165    |      0.00550272  |      0.278321  |      0.00569795  |      1        |      0.00590568  |      1.00119     |      0.00954157  |      0.00536584  |    0.0478568   |      0.00674776  |      0.00608856  |     0.208907  |      0.00579754  |      0.00533847  |     0.315925  |     0.00639175 |     0.256406    |     0.0061696  |     0.00873887  |      0.00643151  |      0.00540552  |      0.00649048  |     0.447309  |      0.00646925  |      0.00585904  |      0.00645326  |
+-------+---------------+------------------+-----------------+------------------+------------------+---------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+------------------+---------------+----------------+-----------------+-----------------+-----------------+----------------+------------------+----------------+------------------+------------------+------------------+-----------------+---------------+-----------------+------------------+------------------+------------------+------------------+----------------+------------------+----------------+------------------+-----------------+------------------+----------------+------------------+------------------+------------------+-----------------+-----------------+----------------+------------------+-----------------+-----------------+---------------+-----------------+------------------+------------------+------------------+------------------+------------------+--------------+------------------+--------------+---------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+---------------+------------------+--------------+-----------------+------------------+------------------+----------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+----------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+-----------------+---------------+------------------+------------------+--------+------------------+------------------+---------------+----------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+---------------+---------------+---------------+---------------+------------------+------------------+------------------+------------------+----------------+-----------------+------------------+------------------+-----------------+-----------------+----------------+--------------+----------------+------------------+--------------+----------------+-------------+------------------+------------------+------------------+------------------+---------------+------------------+-----------------+--------------+------------------+------------------+---------------+----------------+------------------+------------------+----------------+------------------+---------------+------------------+------------------+------------------+------------------+----------------+------------------+------------------+---------------+------------------+------------------+---------------+----------------+-----------------+----------------+-----------------+------------------+------------------+------------------+---------------+------------------+------------------+------------------+
| 75%   |      0.882259 |      0.272139    |      0.164698   |      1.00312     |      0.00906487  |      0.29161  |      0.00893205  |      0.207188    |     0.337525    |      0.204537    |      0.134143    |      0.283077    |      0.402861    |      0.0669446   |      0.00817363  |      0.528746 |      0.585963  |      0.72977    |     0.360315    |      0.197918   |      0.321024  |      1.00487     |      0.217381  |      0.33723     |      0.422901    |      0.203249    |      0.246345   |      0.699323 |      0.296404   |      0.100809    |      0.0864821   |      0.137721    |      1.00088     |      1.00768   |      0.00792583  |      0.328509  |      0.0817767   |      0.600732   |      0.558245    |      0.289958  |      0.107376    |      0.00795835  |      0.42795     |      0.0649976  |      0.118637   |      0.482852  |      0.797529    |      0.810946   |      0.00973984 |      0.484871 |      0.326183   |      0.00811439  |      0.918073    |      1.00325     |      1.00416     |      0.205769    |     1        |      0.531632    |      6       |      0.225232 |      0.00809088  |      0.429375    |      0.00792785  |      0.0080111   |      0.00970154  |      0.253032    |      0.042177    |      0.00815589  |      0.505668 |      0.294656    |    0.244247  |      0.00915556 |      0.286123    |      0.274365    |     0.274151   |      0.00808745  |      0.00806146  |      0.407193    |      0.140012   |      0.00815849  |      0.00838768  |      0.00864603  |      0.00792385  |     0.339885    |      0.00788004  |      0.204952    |      0.00810504  |      0.008428    |      0.00773132  |      0.00803524 |      0.508069    |      0.0083392   |      1.00767   |      0.231094    |      0.00781071  |      0.00802973  |      0.00785973  |      0.0079803   |      0.00813695 |      0.00838539  |     0.00854895  |      0        |      0.00800643  |      0.00802723  |      1 |      0.00777735  |      0.0077205   |   0.243911    |      1         |      0.00778149  |      0.00790045 |      0.0080048   |      0.00784561  |      0.00786869  |      0.00788475  |      1.00651     |      0.00779215  |      0.00776516 |      0.00778667  |      0.00877937  |      0.00842023  |      0.0078203  |      0.00788716  |      0.00786451  |      0.00776508  |      0.00803152  |      0.967457 |      0.139268 |      0.97381  |      0.976718 |      0.0240193   |      0.3803      |      1.00531     |      0.966561    |      0.580734  |     0.349259    |      0.340234    |      0.00779713  |      0.160745   |     0.144837    |      1.00751   |      3       |    0.00882482  |      0.00780026  |    1.00626   |    1.00811     |    0.49632  |      1.00731     |      0.306405    |      0.466261    |      0.209045    |      1        |      0.474005    |      0          |      4       |      0.48246     |      0.471118    |      0        |      0.731707  |      0.577933    |      0.00815849  |      0.457747  |      0.00843532  |      1        |      0.00865076  |      1.00515     |      1.00489     |      0.00793895  |    0.231858    |      0.00983204  |      0.00867572  |     0.349874  |      0.00853334  |      0.00779655  |     0.836969  |     0.00884122 |     0.504064    |     0.00901305 |     0.506918    |      0.00946845  |      0.00796178  |      0.0094331   |     0.614771  |      0.00950435  |      0.00865392  |      0.00950143  |
+-------+---------------+------------------+-----------------+------------------+------------------+---------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+------------------+---------------+----------------+-----------------+-----------------+-----------------+----------------+------------------+----------------+------------------+------------------+------------------+-----------------+---------------+-----------------+------------------+------------------+------------------+------------------+----------------+------------------+----------------+------------------+-----------------+------------------+----------------+------------------+------------------+------------------+-----------------+-----------------+----------------+------------------+-----------------+-----------------+---------------+-----------------+------------------+------------------+------------------+------------------+------------------+--------------+------------------+--------------+---------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+---------------+------------------+--------------+-----------------+------------------+------------------+----------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+----------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+-----------------+---------------+------------------+------------------+--------+------------------+------------------+---------------+----------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+---------------+---------------+---------------+---------------+------------------+------------------+------------------+------------------+----------------+-----------------+------------------+------------------+-----------------+-----------------+----------------+--------------+----------------+------------------+--------------+----------------+-------------+------------------+------------------+------------------+------------------+---------------+------------------+-----------------+--------------+------------------+------------------+---------------+----------------+------------------+------------------+----------------+------------------+---------------+------------------+------------------+------------------+------------------+----------------+------------------+------------------+---------------+------------------+------------------+---------------+----------------+-----------------+----------------+-----------------+------------------+------------------+------------------+---------------+------------------+------------------+------------------+
| max   |      1.01     |      5.38962     |      1.32406    |      1.01        |      2.75912     |      4.38174  |      7.1397      |      1.53621     |     4.19079     |     10.0756      |      5.62593     |      6.09159     |      1.60355     |     80.9968      |      1.01        |     14.8066   |      1.37407   |      8.97067    |    19.9449      |    798.706      |      1.25275   |      1.01262     |     89.099     |      2.66724     |     16.2387      |      8.20511     |      1.01       |      2.13939  |   1722.19       |      6.5338      |     92.6287      |      1.70604     |      1.01        |      1.01      |      1.01        |      3.33098   |    212.202       |      1.23141    |      2.73524     |      9.9864    |    129.356       |     19.0076      |      1.26188     |      2.83956    |     43.5162     |      1.98739   |      1.01        |      3.70177    |     51.1723     |      2.84251  |     10.8584     |    151.95        |      1.01        |      1.01        |      1.01        |      1.01        |     1        |      1.01        |      6       |     35.6421   |     14.4482      |      1.01        |    161.854       |  13000.9         |      3.5071      |      6.00243     |     45.8921      |      3.01        |      5.30697  |      1.5195      |    3.21526   |      1.25105    |      4.50049     |      4.27295     |    15.129      |     37.283       |    242.723       |     10.0089      |     14.6346     |   1481.76        |     12.5053      |      9.50783     |     22.0091      |     1.50993     |    146.392       |      6.20849     |     10.0053      |      7.50612     |      0.249603    |      8.0098     |      3.00258     |      4.04901     |      1.01      |     20.1745      |      0.710332    |     38.0072      |   1798.24        |      1.01        |     16.0074     |     11.5038      |     6.89696     |      2        |      1.01        |      1.01        |      1 |      0.635062    |      0.551067    |   2.08131     |      1         |      0.139537    |      1.01       |      1.01        |      1.01        |     40.0031      |      1.01        |      1.01        |      1.00943     |      1.01       |      1.00995     |      3.00666     |      2.01        |      1.01       |      1.00999     |      1.01        |      1.01        |      1.01        |      1.03258  |     82.1619   |      1.05429  |      2.87083  |     89.293       |      1.09        |      1.01        |      1.21107     |      5.14671   |    49.2189      |      7.00674     |      0.524035    |      1.32781    |     9.18855     |      1.01      |      7       |    7.0009      |      1.01        |    1.00999   |    1.01        |    1.05779  |      1.01        |   5755.08        |      4.65618     |      6.80637     |      1        |      1.99903     |      1          |      6       |      1.96811     |      1.97603     |      1        |      1.79062   |      2.00306     |     55.0071      |      2.78056   |      6.00701     |      1        |      1.01        |      1.0199      |      1.01        |     16.0074      |    9.05184     |      1.02114     |      1.48281     |     5.98892   |      1.50999     |      1.00994     |     1.00999   |     1.00999    |     1.75975     |     1.00999    |     3.00477     |      1.01        |      1.01        |      1.33174     |     2.22848   |      1.01        |      1.34332     |      4.54587     |
+-------+---------------+------------------+-----------------+------------------+------------------+---------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+------------------+---------------+----------------+-----------------+-----------------+-----------------+----------------+------------------+----------------+------------------+------------------+------------------+-----------------+---------------+-----------------+------------------+------------------+------------------+------------------+----------------+------------------+----------------+------------------+-----------------+------------------+----------------+------------------+------------------+------------------+-----------------+-----------------+----------------+------------------+-----------------+-----------------+---------------+-----------------+------------------+------------------+------------------+------------------+------------------+--------------+------------------+--------------+---------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+---------------+------------------+--------------+-----------------+------------------+------------------+----------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+----------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+-----------------+---------------+------------------+------------------+--------+------------------+------------------+---------------+----------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+---------------+---------------+---------------+---------------+------------------+------------------+------------------+------------------+----------------+-----------------+------------------+------------------+-----------------+-----------------+----------------+--------------+----------------+------------------+--------------+----------------+-------------+------------------+------------------+------------------+------------------+---------------+------------------+-----------------+--------------+------------------+------------------+---------------+----------------+------------------+------------------+----------------+------------------+---------------+------------------+------------------+------------------+------------------+----------------+------------------+------------------+---------------+------------------+------------------+---------------+----------------+-----------------+----------------+-----------------+------------------+------------------+------------------+---------------+------------------+------------------+------------------+
</pre></div>
</div>
</div>
</div>
</section>
<section id="concatenar-conjuntos-de-datos">
<h2>Concatenar conjuntos de datos<a class="headerlink" href="#concatenar-conjuntos-de-datos" title="Link to this heading">#</a></h2>
<p>Se verifica que las etiquetas únicas para cada cliente que se encuentran en el conjunto label coincidan con las etiquetas en el conjunto de entrenamiento para los valores de las predictoras. Se concluye que si coinciden todas por lo que se hace una concatenaión a través de un <code class="docutils literal notranslate"><span class="pre">left</span> <span class="pre">join</span></code> con la variable ‘<code class="docutils literal notranslate"><span class="pre">costumer_ID</span></code>’. Cada etiqueta de predicción para los clientes se agrega con base a esa llave.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="s1">&#39;customer_ID&#39;</span> <span class="ow">in</span> <span class="n">label_train</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="s1">&#39;customer_ID&#39;</span> <span class="ow">in</span> <span class="n">data_train</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="c1"># Encontrar los valores en común entre los &#39;customer_ID&#39; de ambos DataFrames</span>
    <span class="n">common_customer_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">label_train</span><span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_train</span><span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">]))</span>

    <span class="c1"># Contar cuántos valores son comunes</span>
    <span class="n">num_common_ids</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">common_customer_ids</span><span class="p">)</span>

    <span class="c1"># Mostrar el número de valores comunes y algunos ejemplos</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Número de customer_IDs en común: </span><span class="si">{</span><span class="n">num_common_ids</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ejemplos de customer_IDs en común: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">common_customer_ids</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;customer_ID&#39; no se encuentra en ambos DataFrames.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Número de customer_IDs en común: 458913
Ejemplos de customer_IDs en común: [&#39;cc78f6810929e4badab36c5a6a0eadf22f4f00854d9aafdd8da0491ff1f3a184&#39;, &#39;4ee9844a98c859f5d3f864c6fd71d48f3d8787c27d8f2365991e721d0c289d41&#39;, &#39;35d750c24f6799ed92b239135595187420bc10091212ab6be81cddd1345f5c51&#39;, &#39;1f9a0de2d4538bb2cb2de9a78d2f22a6e57aaaf1240c298ad68f3d7edd36496d&#39;, &#39;b8f3dbac0223003a1ddce30b86ee9872477607203abc8868d812cfdc6f2a9631&#39;, &#39;6d11f33a83df1a4d09383d6ea2092aafba1eed1dfb21dd64be8b38a3e88137df&#39;, &#39;4f84b89574a8ffee830a6db8e5a1eca02566eee4a5fcbab0f8fe249cd04415a1&#39;, &#39;87122ab09e19ce698f67d6ddd5e151e19bef4ef483da7e5dc6d0043d3b1ff27b&#39;, &#39;1aa7998e863639b6167a3e6ad04d0ce74e0044b8f4f24c6b469d48ed2b900619&#39;, &#39;551241999843f9185d8eb28c2197e9235e35e3217d7bb27dea8f88f93c5e5756&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="s1">&#39;customer_ID&#39;</span> <span class="ow">in</span> <span class="n">label_train</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="s1">&#39;customer_ID&#39;</span> <span class="ow">in</span> <span class="n">data_train</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

    <span class="c1"># Unir los DataFrames usando &#39;customer_ID&#39; como clave (merge left join)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data_train</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">label_train</span><span class="p">[[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">]],</span>
                                         <span class="n">on</span><span class="o">=</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span>
                                         <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">headers</span> <span class="o">=</span> <span class="s1">&#39;keys&#39;</span><span class="p">,</span> <span class="n">tablefmt</span> <span class="o">=</span> <span class="s1">&#39;grid&#39;</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;customer_ID&#39; no se encuentra en ambos DataFrames.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-------+------------------------------------------------------------------+------------+----------+------------+-------------+----------+-------------+-----------+-------------+------------+--------+------------+------------+-------------+----------+------------+------------+----------+----------+------------+--------+-----------+-----------+-------------+-----------+------------+------------+------------+----------+----------+----------+--------+------------+------------+-------------+---------+-------------+-----------+-----------+------------+-----------+----------+-----------+-------------+------------+--------------+------------+----------+-----------+-------------+------------+----------+-----------+--------+--------+-------------+----------+------------+----------+-------------+--------+-------------+--------+----------+-------------+-------------+------------+-------------+------------+------------+------------+-------------+----------+------------+--------+-------------+-------------+------------+--------+-------------+-------------+-----------+-------------+-------------+-------------+-------------+-------------+-------+-------------+-------------+------------+-------------+-------------+-------------+----------+-------------+---------+------------+------------+-------------+-------------+------------+------------+-------------+--------+--------+-------------+------------+--------+-------------+------------+--------+--------+-------------+------------+-------------+-------------+------------+-------------+------------+-------------+-------------+-------------+-------------+------------+-------------+-------------+------------+-------------+------------+----------+----------+-----------+----------+-------------+------------+-------------+-------------+---------+---------+-------------+-------------+------------+--------+---------+--------+---------+------------+---------+---------+--------+---------+------------+-------------+----------+---------+-----------+---------+---------+-----------+-----------+---------+----------+----------+------------+----------+-------------+---------+------------+---------+---------+------------+--------+------------+-------------+---------+-------------+-------------+---------+---------+---------+---------+---------+------------+------------+-------------+---------+------------+------------+------------+----------+
|       | customer_ID                                                      | Date       |      P_2 |       D_39 |         B_1 |      B_2 |         R_1 |       S_3 |        D_41 |        B_3 |   D_42 |       D_43 |       D_44 |         B_4 |     D_45 |        B_5 |        R_2 |     D_46 |     D_47 |       D_48 |   D_49 |       B_6 |       B_7 |         B_8 |      D_50 |       D_51 |        B_9 |        R_3 |     D_52 |      P_3 |     B_10 |   D_53 |        S_5 |       B_11 |         S_6 |    D_54 |         R_4 |       S_7 |      B_12 |        S_8 |      D_55 |     D_56 |      B_13 |         R_5 |       D_58 |          S_9 |       B_14 |     D_59 |      D_60 |        D_61 |       B_15 |     S_11 |      D_62 | D_63   | D_64   |        D_65 |     B_16 |       B_17 |     B_18 |        B_19 |   D_66 |        B_20 |   D_68 |     S_12 |         R_6 |        S_13 |       B_21 |        D_69 |       B_22 |       D_70 |       D_71 |        D_72 |     S_15 |       B_23 |   D_73 |         P_4 |        D_74 |       D_75 |   D_76 |        B_24 |         R_7 |      D_77 |        B_25 |        B_26 |        D_78 |        D_79 |         R_8 |   R_9 |        S_16 |        D_80 |       R_10 |        R_11 |        B_27 |        D_81 |     D_82 |        S_17 |    R_12 |       B_28 |       R_13 |        D_83 |        R_14 |       R_15 |       D_84 |        R_16 |   B_29 |   B_30 |        S_18 |       D_86 |   D_87 |        R_17 |       R_18 |   D_88 |   B_31 |        S_19 |       R_19 |        B_32 |        S_20 |       R_20 |        R_21 |       B_33 |        D_89 |        R_22 |        R_23 |        D_91 |       D_92 |        D_93 |        D_94 |       R_24 |        R_25 |       D_96 |     S_22 |     S_23 |      S_24 |     S_25 |        S_26 |      D_102 |       D_103 |       D_104 |   D_105 |   D_106 |       D_107 |        B_36 |       B_37 |   R_26 |    R_27 |   B_38 |   D_108 |      D_109 |   D_110 |   D_111 |   B_39 |   D_112 |       B_40 |        S_27 |    D_113 |   D_114 |     D_115 |   D_116 |   D_117 |     D_118 |     D_119 |   D_120 |    D_121 |    D_122 |      D_123 |    D_124 |       D_125 |   D_126 |      D_127 |   D_128 |   D_129 |       B_41 |   B_42 |      D_130 |       D_131 |   D_132 |       D_133 |        R_28 |   D_134 |   D_135 |   D_136 |   D_137 |   D_138 |      D_139 |      D_140 |       D_141 |   D_142 |      D_143 |      D_144 |      D_145 |   target |
+=======+==================================================================+============+==========+============+=============+==========+=============+===========+=============+============+========+============+============+=============+==========+============+============+==========+==========+============+========+===========+===========+=============+===========+============+============+============+==========+==========+==========+========+============+============+=============+=========+=============+===========+===========+============+===========+==========+===========+=============+============+==============+============+==========+===========+=============+============+==========+===========+========+========+=============+==========+============+==========+=============+========+=============+========+==========+=============+=============+============+=============+============+============+============+=============+==========+============+========+=============+=============+============+========+=============+=============+===========+=============+=============+=============+=============+=============+=======+=============+=============+============+=============+=============+=============+==========+=============+=========+============+============+=============+=============+============+============+=============+========+========+=============+============+========+=============+============+========+========+=============+============+=============+=============+============+=============+============+=============+=============+=============+=============+============+=============+=============+============+=============+============+==========+==========+===========+==========+=============+============+=============+=============+=========+=========+=============+=============+============+========+=========+========+=========+============+=========+=========+========+=========+============+=============+==========+=========+===========+=========+=========+===========+===========+=========+==========+==========+============+==========+=============+=========+============+=========+=========+============+========+============+=============+=========+=============+=============+=========+=========+=========+=========+=========+============+============+=============+=========+============+============+============+==========+
| 21597 | fffff1d38b785cef84adeace64f8f83db3a0c31e8d92eaba8b115f71cab04681 | 2017-06-19 | 1.00577  | 0.206469   | 0.0299987   | 0.620975 | 0.00817603  | 0.0334448 | 0.00377809  | 0.0380973  |    nan | 0.0141827  | 0.00915957 | 0.0183385   | 0.730693 | 0.00761889 | 0.00511123 | 0.388366 | 0.521325 | 0.0165054  |    nan | 0.0849644 | 0.0316723 | 0.00583511  | 0.0778536 | 0.0026232  | 0.0292914  | 0.00550298 | 0.287587 | 0.752543 | 0.208905 |    nan | 0.138998   | 0.0189006  | 0.000609664 | 1.00125 | 2.7557e-05  | 0.0355896 | 0.0542612 | 0.603181   | 0.0514548 | 0.133702 | 0.0810835 | 0.00597887  | 0.00553644 | nan          | 0.0295727  | 0.441927 | 0.732607  |  0.016805   | 0.0093656  | 0.284206 | 0.0935156 | CL     | O      | 0.00697219  | 0.8376   | 0.376522   | 0.379425 | 0.0832235   |    nan | 0.182068    |      5 | 0.190582 | 0.00141897  | 0.00023662  | 0.00953663 | 0.000398995 | 0.00736328 | 0.00116158 | 0.0146651  | 0.0070723   | 0.104036 | 0.0177832  |    nan | 0.00392638  | 0.00992467  | 0.071454   |    nan | 0.00671428  | 0.00403784  | 0.0825719 | 0.0485326   | 0.00284016  | 0.00891418  | 0.00422623  | 0.000153369 |   nan | 0.000181279 | 0.00139106  | 0.0048826  | 0.00126554  | 0.0065323   | 0.00317604  | 0.501036 | 0.00462589  | 1.00855 | 0.0201636  | 0.0082739  | 0.00241216  | 3.33165e-05 | 0.00751017 | 0.00579755 | 0.00285603  |    nan |      0 | 0.00872685  | 0.00908509 |    nan | 0.00689294  | 0.00165669 |    nan |      1 | 0.00748096  | 0.0054714  | 0.00865157  | 0.00886455  | 0.00604456 | 0.00829391  | 0.00249159 | 0.00136918  | 0.00355721  | 0.00170306  | 0.00512137  | 0.00435876 | 0.000230646 | 0.00310229  | 0.00153179 | 0.00627206  | 0.00186117 | 0.960194 | 0.133776 | 0.959114  | 0.970989 | 0.000476884 | 0.00941777 | 9.94393e-05 | 0.000399992 |     nan |     nan | 0.00290686  | 0.000927619 | 0.0328996  |    nan | 1.00035 |      3 |     nan | 0.00342363 |     nan |     nan |    nan | 1.00345 | 0.0170355  | 0.000910624 | 0.200928 |       1 | 0.0131735 |       0 |       3 | 0.0128377 | 0.0196046 |       0 | 0.710688 | 0.294562 | 1.00524    | 0.464491 | 1.00041     |       1 | 1.00503    | 1.00895 | 1.00674 | 0.00627281 |    nan | 0.00879174 | 8.64917e-05 |     nan | 0.000926402 | 0.000448853 |     nan |     nan |     nan |     nan |     nan | 0.00709889 | 0.00403158 | 0.00604425  |     nan | 0.00931603 | 0.002273   | 0.0025678  |        0 |
+-------+------------------------------------------------------------------+------------+----------+------------+-------------+----------+-------------+-----------+-------------+------------+--------+------------+------------+-------------+----------+------------+------------+----------+----------+------------+--------+-----------+-----------+-------------+-----------+------------+------------+------------+----------+----------+----------+--------+------------+------------+-------------+---------+-------------+-----------+-----------+------------+-----------+----------+-----------+-------------+------------+--------------+------------+----------+-----------+-------------+------------+----------+-----------+--------+--------+-------------+----------+------------+----------+-------------+--------+-------------+--------+----------+-------------+-------------+------------+-------------+------------+------------+------------+-------------+----------+------------+--------+-------------+-------------+------------+--------+-------------+-------------+-----------+-------------+-------------+-------------+-------------+-------------+-------+-------------+-------------+------------+-------------+-------------+-------------+----------+-------------+---------+------------+------------+-------------+-------------+------------+------------+-------------+--------+--------+-------------+------------+--------+-------------+------------+--------+--------+-------------+------------+-------------+-------------+------------+-------------+------------+-------------+-------------+-------------+-------------+------------+-------------+-------------+------------+-------------+------------+----------+----------+-----------+----------+-------------+------------+-------------+-------------+---------+---------+-------------+-------------+------------+--------+---------+--------+---------+------------+---------+---------+--------+---------+------------+-------------+----------+---------+-----------+---------+---------+-----------+-----------+---------+----------+----------+------------+----------+-------------+---------+------------+---------+---------+------------+--------+------------+-------------+---------+-------------+-------------+---------+---------+---------+---------+---------+------------+------------+-------------+---------+------------+------------+------------+----------+
| 21598 | fffff1d38b785cef84adeace64f8f83db3a0c31e8d92eaba8b115f71cab04681 | 2017-07-20 | 0.965709 | 0.207843   | 0.0427817   | 0.279508 | 0.00108802  | 0.0208154 | 0.00645991  | 0.0535843  |    nan | 0.0176114  | 0.00723369 | 0.0155021   | 0.731322 | 0.0348319  | 0.00662689 | 0.410001 | 0.519332 | 0.0466752  |    nan | 0.0871235 | 0.0282778 | 0.0042356   | 0.0724097 | 0.00720158 | 0.0238644  | 0.00274608 | 0.289895 | 0.635963 | 0.157152 |    nan | 0.0412885  | 0.0267713  | 0.00285385  | 1.00072 | 0.00111879  | 0.0258155 | 0.0557528 | 0.665898   | 0.0507348 | 0.132462 | 0.0776814 | 0.00602198  | 0.00426678 |   0.0109981  | 0.0365954  | 0.40098  | 0.735786  |  0.0188036  | 0.0241655  | 1.04388  | 0.331136  | CL     | O      | 0.00107264  | 0.920613 | 0.427228   | 0.379839 | 0.0815408   |    nan | 0.237612    |      5 | 0.188247 | 0.00612887  | 0.563323    | 0.00865786 | 0.00740258  | 0.00464164 | 0.00836932 | 0.00524675 | 0.00468721  | 0.205073 | 0.0163339  |    nan | 0.00857837  | 0.00883294  | 0.0749844  |    nan | 0.000908029 | 0.00345079  | 0.300504  | 0.0431583   | 0.00742064  | 0.00919014  | 0.000290711 | 0.0040542   |   nan | 0.00584295  | 0.00525227  | 0.00639009 | 0.50443     | 8.809e-05   | 0.00956144  | 0.501465 | 0.00861024  | 1.00999 | 0.0287363  | 0.00501262 | 0.00462492  | 0.00236661  | 0.0019197  | 0.00304166 | 0.0096281   |    nan |      0 | 0.000884287 | 0.00981552 |    nan | 0.00404481  | 0.00247854 |    nan |      1 | 0.000346645 | 0.00982422 | 0.00983113  | 0.00530668  | 0.00364089 | 0.00740558  | 0.00128508 | 0.00926655  | 0.00475832  | 0.00285616  | 0.00909615  | 0.00956023 | 0.00836622  | 0.00201235  | 0.00631086 | 0.00930652  | 0.00191944 | 0.930102 | 0.134767 | 0.948851  | 0.979035 | 0.00023005  | 0.00445231 | 0.00827527  | 0.00517315  |     nan |     nan | 0.00195831  | 0.00100076  | 0.0391105  |    nan | 1.00792 |      3 |     nan | 0.0093149  |     nan |     nan |    nan | 1.00995 | 0.0113333  | 0.219747    | 0.205282 |       1 | 0.0158852 |       0 |       3 | 0.0156655 | 0.0187112 |       0 | 0.709866 | 0.286248 | 1.00606    | 0.463689 | 1.00002     |       1 | 1.00563    | 1.00412 | 1.00835 | 0.00797848 |    nan | 0.00306894 | 0.00706968  |     nan | 0.00140115  | 0.00644056  |     nan |     nan |     nan |     nan |     nan | 0.00911989 | 0.00199188 | 0.00461623  |     nan | 0.0049605  | 0.00962686 | 0.00915047 |        0 |
+-------+------------------------------------------------------------------+------------+----------+------------+-------------+----------+-------------+-----------+-------------+------------+--------+------------+------------+-------------+----------+------------+------------+----------+----------+------------+--------+-----------+-----------+-------------+-----------+------------+------------+------------+----------+----------+----------+--------+------------+------------+-------------+---------+-------------+-----------+-----------+------------+-----------+----------+-----------+-------------+------------+--------------+------------+----------+-----------+-------------+------------+----------+-----------+--------+--------+-------------+----------+------------+----------+-------------+--------+-------------+--------+----------+-------------+-------------+------------+-------------+------------+------------+------------+-------------+----------+------------+--------+-------------+-------------+------------+--------+-------------+-------------+-----------+-------------+-------------+-------------+-------------+-------------+-------+-------------+-------------+------------+-------------+-------------+-------------+----------+-------------+---------+------------+------------+-------------+-------------+------------+------------+-------------+--------+--------+-------------+------------+--------+-------------+------------+--------+--------+-------------+------------+-------------+-------------+------------+-------------+------------+-------------+-------------+-------------+-------------+------------+-------------+-------------+------------+-------------+------------+----------+----------+-----------+----------+-------------+------------+-------------+-------------+---------+---------+-------------+-------------+------------+--------+---------+--------+---------+------------+---------+---------+--------+---------+------------+-------------+----------+---------+-----------+---------+---------+-----------+-----------+---------+----------+----------+------------+----------+-------------+---------+------------+---------+---------+------------+--------+------------+-------------+---------+-------------+-------------+---------+---------+---------+---------+---------+------------+------------+-------------+---------+------------+------------+------------+----------+
| 21599 | fffff1d38b785cef84adeace64f8f83db3a0c31e8d92eaba8b115f71cab04681 | 2017-08-09 | 0.968892 | 0.563736   | 0.034385    | 0.435834 | 3.66403e-05 | 0.0283948 | 0.00163119  | 0.044833   |    nan | 0.00946088 | 0.00297947 | 0.0149924   | 0.732781 | 0.0281625  | 0.00655852 | 0.40632  | 0.521531 | 0.0362353  |    nan | 0.090321  | 0.0292198 | 0.0035506   | 0.07758   | 0.00813166 | 0.0211706  | 0.00679298 | 0.28827  | 0.640528 | 0.179    |    nan | 0.0400954  | 0.017228   | 0.00682164  | 1.00315 | 0.00707833  | 0.0233392 | 0.0577092 | 0.465825   | 0.0472062 | 0.136325 | 0.076419  | 0.00685426  | 0.00817425 |   0.0145567  | 0.0359191  | 0.3832   | 0.738183  |  0.0232675  | 0.0254289  | 0.603067 | 0.330805  | CL     | O      | 0.0055709   | 0.839752 | 0.428727   | 0.376584 | 0.00496851  |    nan | 0.244655    |      5 | 0.193686 | 0.00201299  | 0.000357256 | 0.00377185 | 0.00582324  | 0.00746909 | 0.00744177 | 0.0110897  | 0.00228606  | 0.206492 | 0.0158955  |    nan | 0.00540009  | 0.00973061  | 0.0702742  |    nan | 0.00533529  | 0.00399805  | 0.303727  | 0.0262328   | 0.000633261 | 0.00160987  | 0.00364015  | 0.00710997  |   nan | 0.00952083  | 0.000148674 | 0.00528339 | 0.000420128 | 0.00403469  | 0.00635404  | 0.504486 | 0.00784264  | 1.00098 | 0.0247881  | 0.00866164 | 0.00913888  | 0.00205701  | 0.00932501 | 0.00821941 | 0.00500996  |    nan |      0 | 0.00849148  | 0.00385951 |    nan | 0.00735742  | 0.00333895 |    nan |      1 | 0.00334082  | 0.00445888 | 0.0090863   | 0.000972936 | 0.00895326 | 0.00972535  | 0.00662015 | 0.0026163   | 0.00767035  | 0.00563353  | 0.0083854   | 0.00805091 | 0.00764649  | 0.0053266   | 0.00323154 | 0.00944331  | 0.00174941 | 0.936726 | 0.137554 | 0.956288  | 0.970099 | 0.00242208  | 0.00781879 | 0.00217661  | 0.00727098  |     nan |     nan | 0.00487251  | 0.00599483  | 0.0315392  |    nan | 1.00034 |      3 |     nan | 0.00866519 |     nan |     nan |    nan | 1.00316 | 0.00944433 | 0.178687    | 0.203964 |       1 | 0.0212762 |       0 |       3 | 0.0193145 | 0.0113153 |       0 | 0.708846 | 0.286624 | 1.00126    | 0.455785 | 1.00741     |       1 | 1.00328    | 1.00896 | 1.00279 | 0.00648893 |    nan | 0.00481795 | 0.00959314  |     nan | 0.00575178  | 0.000214976 |     nan |     nan |     nan |     nan |     nan | 0.00477204 | 0.00838621 | 0.00241315  |     nan | 0.00552437 | 0.0085186  | 0.00901328 |        0 |
+-------+------------------------------------------------------------------+------------+----------+------------+-------------+----------+-------------+-----------+-------------+------------+--------+------------+------------+-------------+----------+------------+------------+----------+----------+------------+--------+-----------+-----------+-------------+-----------+------------+------------+------------+----------+----------+----------+--------+------------+------------+-------------+---------+-------------+-----------+-----------+------------+-----------+----------+-----------+-------------+------------+--------------+------------+----------+-----------+-------------+------------+----------+-----------+--------+--------+-------------+----------+------------+----------+-------------+--------+-------------+--------+----------+-------------+-------------+------------+-------------+------------+------------+------------+-------------+----------+------------+--------+-------------+-------------+------------+--------+-------------+-------------+-----------+-------------+-------------+-------------+-------------+-------------+-------+-------------+-------------+------------+-------------+-------------+-------------+----------+-------------+---------+------------+------------+-------------+-------------+------------+------------+-------------+--------+--------+-------------+------------+--------+-------------+------------+--------+--------+-------------+------------+-------------+-------------+------------+-------------+------------+-------------+-------------+-------------+-------------+------------+-------------+-------------+------------+-------------+------------+----------+----------+-----------+----------+-------------+------------+-------------+-------------+---------+---------+-------------+-------------+------------+--------+---------+--------+---------+------------+---------+---------+--------+---------+------------+-------------+----------+---------+-----------+---------+---------+-----------+-----------+---------+----------+----------+------------+----------+-------------+---------+------------+---------+---------+------------+--------+------------+-------------+---------+-------------+-------------+---------+---------+---------+---------+---------+------------+------------+-------------+---------+------------+------------+------------+----------+
| 21600 | fffff1d38b785cef84adeace64f8f83db3a0c31e8d92eaba8b115f71cab04681 | 2017-09-20 | 0.97378  | 0.239892   | 0.0462458   | 0.732382 | 0.00709277  | 0.0816267 | 0.00354323  | 0.0307788  |    nan | 0.0160511  | 0.00688192 | 0.0352354   | 0.736701 | 0.0300554  | 0.00321639 | 0.388536 | 0.523351 | 0.00902949 |    nan | 0.111282  | 0.0316511 | 0.00973667  | 0.077721  | 0.00152011 | 0.010383   | 0.00672107 | 0.282512 | 0.690183 | 0.238478 |    nan | 0.00545784 | 0.0306862  | 0.00457776  | 1.00802 | 0.00816138  | 0.0613092 | 0.0520991 | 0.706353   | 0.0420095 | 0.133101 | 0.021544  | 0.00291073  | 0.00334762 |   0.0204161  | 0.0447493  | 0.358039 | 0.805551  |  0.0190117  | 0.0481656  | 0.680559 | 0.328902  | CL     | O      | 0.00745538  | 0.836001 | 0.225732   | 0.449966 | 0.00202127  |    nan | 0.295153    |      5 | 0.185956 | 0.00470352  | 0.695611    | 0.00561002 | 0.000998323 | 0.00992574 | 0.00684797 | 0.00585232 | 0.00954911  | 0.201694 | 0.0254028  |    nan | 0.00806883  | 0.00800569  | 0.0672365  |    nan | 0.00544191  | 0.000536818 | 0.309987  | 0.021288    | 0.00629973  | 0.00790094  | 0.00736968  | 0.00514302  |   nan | 0.00694918  | 0.00499125  | 0.0063947  | 0.00107302  | 0.0066256   | 0.0059414   | 0.504392 | 0.00315377  | 1.00039 | 0.0253798  | 0.00220097 | 0.00805138  | 0.00321479  | 0.00217675 | 0.00151409 | 0.00402702  |    nan |      0 | 0.00618059  | 0.00636332 |    nan | 0.00983898  | 0.00215393 |    nan |      1 | 0.00932755  | 0.00442738 | 0.00671155  | 0.00613979  | 0.00476742 | 0.00233038  | 0.00175018 | 0.0072907   | 0.00511799  | 0.0082789   | 0.00404986  | 0.00248061 | 0.00806931  | 0.00285545  | 0.00742025 | 0.00228291  | 0.00707162 | 0.946211 | 0.133306 | 0.966319  | 0.97667  | 0.00330648  | 0.00642375 | 2.75872e-06 | 0.00540257  |     nan |     nan | 0.00393401  | 0.00984321  | 0.042893   |    nan | 1.00307 |      3 |     nan | 0.00533103 |     nan |     nan |    nan | 1.00926 | 0.00724349 | 0.197849    | 0.200949 |       1 | 0.0207894 |       0 |       3 | 0.021606  | 0.0216215 |       0 | 0.714318 | 0.295233 | 0.00308215 | 0.455907 | 0.00767572  |       1 | 1.00991    | 1.0029  | 1.00875 | 0.00877503 |    nan | 0.00843446 | 0.00720791  |     nan | 0.00722125  | 0.00937658  |     nan |     nan |     nan |     nan |     nan | 0.003733   | 0.00965794 | 0.00978926  |     nan | 0.003017   | 0.00459911 | 0.00929053 |        0 |
+-------+------------------------------------------------------------------+------------+----------+------------+-------------+----------+-------------+-----------+-------------+------------+--------+------------+------------+-------------+----------+------------+------------+----------+----------+------------+--------+-----------+-----------+-------------+-----------+------------+------------+------------+----------+----------+----------+--------+------------+------------+-------------+---------+-------------+-----------+-----------+------------+-----------+----------+-----------+-------------+------------+--------------+------------+----------+-----------+-------------+------------+----------+-----------+--------+--------+-------------+----------+------------+----------+-------------+--------+-------------+--------+----------+-------------+-------------+------------+-------------+------------+------------+------------+-------------+----------+------------+--------+-------------+-------------+------------+--------+-------------+-------------+-----------+-------------+-------------+-------------+-------------+-------------+-------+-------------+-------------+------------+-------------+-------------+-------------+----------+-------------+---------+------------+------------+-------------+-------------+------------+------------+-------------+--------+--------+-------------+------------+--------+-------------+------------+--------+--------+-------------+------------+-------------+-------------+------------+-------------+------------+-------------+-------------+-------------+-------------+------------+-------------+-------------+------------+-------------+------------+----------+----------+-----------+----------+-------------+------------+-------------+-------------+---------+---------+-------------+-------------+------------+--------+---------+--------+---------+------------+---------+---------+--------+---------+------------+-------------+----------+---------+-----------+---------+---------+-----------+-----------+---------+----------+----------+------------+----------+-------------+---------+------------+---------+---------+------------+--------+------------+-------------+---------+-------------+-------------+---------+---------+---------+---------+---------+------------+------------+-------------+---------+------------+------------+------------+----------+
| 21601 | fffff1d38b785cef84adeace64f8f83db3a0c31e8d92eaba8b115f71cab04681 | 2017-10-20 | 0.979511 | 0.00222956 | 0.0226947   | 0.557029 | 0.00889743  | 0.0915652 | 0.000880042 | 0.0454706  |    nan | 0.00856195 | 0.00174745 | 0.00650609  | 0.744973 | 0.0275915  | 0.00744817 | 0.393926 | 0.531019 | 0.00790981 |    nan | 0.108105  | 0.0238092 | 0.00576571  | 0.0815332 | 0.00289376 | 0.0207905  | 0.00929924 | 0.284644 | 0.681757 | 0.190385 |    nan | 0.0304788  | 0.00998809 | 0.00480757  | 1.00984 | 0.00533616  | 0.0603085 | 0.0517794 | 0.317725   | 0.0348031 | 0.136475 | 0.0458323 | 0.00275315  | 0.00414463 |   0.0256473  | 0.0182126  | 0.337406 | 0.94552   |  0.00504731 | 0.00734616 | 0.448719 | 0.332181  | CL     | O      | 0.00342748  | 0.834962 | 0.00986485 | 0.442007 | 0.00732266  |    nan | 0.359783    |      5 | 0.191793 | 0.0050538   | 0.428394    | 0.00313057 | 0.00350612  | 0.0011521  | 0.00664265 | 0.00830721 | 0.000993739 | 0.403021 | 0.0124558  |    nan | 0.000556339 | 0.000682805 | 0.0691537  |    nan | 0.00483985  | 0.00812385  | 0.308609  | 0.0361147   | 0.00190956  | 0.00038257  | 0.00731306  | 0.00407035  |   nan | 0.00763121  | 0.00416275  | 0.00462068 | 0.00526651  | 0.00742481  | 0.000450618 | 0.509447 | 0.000625647 | 1.00914 | 0.0122     | 0.00340149 | 0.000794894 | 0.00294765  | 0.00321122 | 0.00234325 | 0.00650346  |    nan |      0 | 0.00977061  | 0.00879644 |    nan | 0.00938335  | 0.00706935 |    nan |      1 | 0.00587958  | 0.00181024 | 0.00819697  | 0.00429057  | 0.00609978 | 0.000676344 | 0.00645021 | 0.00446261  | 0.00955648  | 0.000274057 | 8.13246e-05 | 0.00171885 | 0.00785341  | 0.00718016  | 0.00814581 | 0.000676525 | 0.00804408 | 0.97474  | 0.137417 | 0.970358  | 0.969983 | 0.0016504   | 0.00565956 | 0.00749205  | 0.00214351  |     nan |     nan | 0.00892725  | 0.003407    | 0.0248357  |    nan | 1.00606 |      3 |     nan | 0.00286752 |     nan |     nan |    nan | 1.00067 | 0.00517366 | 0.258416    | 0.209596 |       1 | 0.0214474 |       0 |       3 | 0.0226914 | 0.0217967 |       0 | 0.716531 | 0.291352 | 0.008359   | 0.458794 | 0.00672218  |       1 | 0.00204589 | 1.00868 | 1.00918 | 0.00931939 |    nan | 0.00509212 | 0.00725376  |     nan | 0.00266514  | 0.00289876  |     nan |     nan |     nan |     nan |     nan | 0.003243   | 0.00876844 | 0.00580695  |     nan | 0.00137403 | 0.00381082 | 0.00852039 |        0 |
+-------+------------------------------------------------------------------+------------+----------+------------+-------------+----------+-------------+-----------+-------------+------------+--------+------------+------------+-------------+----------+------------+------------+----------+----------+------------+--------+-----------+-----------+-------------+-----------+------------+------------+------------+----------+----------+----------+--------+------------+------------+-------------+---------+-------------+-----------+-----------+------------+-----------+----------+-----------+-------------+------------+--------------+------------+----------+-----------+-------------+------------+----------+-----------+--------+--------+-------------+----------+------------+----------+-------------+--------+-------------+--------+----------+-------------+-------------+------------+-------------+------------+------------+------------+-------------+----------+------------+--------+-------------+-------------+------------+--------+-------------+-------------+-----------+-------------+-------------+-------------+-------------+-------------+-------+-------------+-------------+------------+-------------+-------------+-------------+----------+-------------+---------+------------+------------+-------------+-------------+------------+------------+-------------+--------+--------+-------------+------------+--------+-------------+------------+--------+--------+-------------+------------+-------------+-------------+------------+-------------+------------+-------------+-------------+-------------+-------------+------------+-------------+-------------+------------+-------------+------------+----------+----------+-----------+----------+-------------+------------+-------------+-------------+---------+---------+-------------+-------------+------------+--------+---------+--------+---------+------------+---------+---------+--------+---------+------------+-------------+----------+---------+-----------+---------+---------+-----------+-----------+---------+----------+----------+------------+----------+-------------+---------+------------+---------+---------+------------+--------+------------+-------------+---------+-------------+-------------+---------+---------+---------+---------+---------+------------+------------+-------------+---------+------------+------------+------------+----------+
| 21602 | fffff1d38b785cef84adeace64f8f83db3a0c31e8d92eaba8b115f71cab04681 | 2017-11-05 | 0.979332 | 0.416013   | 0.0208183   | 0.828199 | 0.00348746  | 0.0907429 | 0.00533956  | 0.0251395  |    nan | 0.0142254  | 0.00217796 | 2.86337e-05 | 0.738777 | 0.0355754  | 0.0024724  | 0.395745 | 0.530723 | 0.0625242  |    nan | 0.122715  | 0.0181206 | 0.000667579 | 0.0871546 | 0.00806035 | 0.013776   | 0.0020558  | 0.281378 | 0.683896 | 0.25084  |    nan | 0.0367003  | 0.0107524  | 3.76098e-05 | 1.0009  | 0.00536593  | 0.0556947 | 0.0569819 | 0.705097   | 0.0398668 | 0.134237 | 0.0525057 | 0.00270023  | 0.0017844  |   0.0214708  | 0.0223022  | 0.420651 | 0.889792  |  0.00529337 | 0.0106531  | 0.483833 | 0.324893  | CL     | O      | 0.0023123   | 0.835932 | 0.00450367 | 0.442891 | 0.0035501   |    nan | 0.415415    |      5 | 0.188514 | 0.00323391  | 0.511308    | 0.00155533 | 0.00411648  | 0.00244354 | 0.00329195 | 0.0096428  | 0.0065364   | 0.204409 | 0.00934621 |    nan | 0.00375361  | 0.00969866  | 0.0752622  |    nan | 0.00481596  | 0.00277191  | 0.305819  | 0.0214095   | 0.00381216  | 0.00190612  | 0.00866865  | 0.00211966  |   nan | 0.00861153  | 0.000113302 | 0.00699039 | 0.00623445  | 0.00142899  | 0.000297851 | 0.507415 | 0.00602356  | 1.00771 | 0.0179203  | 0.00409721 | 0.00332801  | 0.00785005  | 0.00013024 | 0.00978457 | 0.000893871 |    nan |      0 | 0.000671157 | 0.00811293 |    nan | 0.000511433 | 0.00318458 |    nan |      1 | 0.0031723   | 0.00507471 | 0.000481104 | 0.00444574  | 0.00599596 | 0.00271812  | 0.00865703 | 0.00990804  | 0.00940933  | 0.000184727 | 0.00777418  | 0.0011105  | 0.00232148  | 0.00972975  | 0.00874043 | 0.00306114  | 0.00979049 | 0.971546 | 0.132063 | 0.975162  | 0.970563 | 0.00620794  | 0.00963975 | 0.00987066  | 0.00374523  |     nan |     nan | 0.00499483  | 0.00361831  | 0.0228971  |    nan | 1.00991 |      3 |     nan | 0.00242903 |     nan |     nan |    nan | 1.00854 | 0.00250083 | 0.257406    | 0.202654 |       1 | 0.0211733 |       0 |       3 | 0.0168939 | 0.0161408 |       0 | 0.713049 | 0.293002 | 0.00973983 | 0.45687  | 0.000183948 |       1 | 1.00929    | 1.00309 | 1.00554 | 0.00807812 |    nan | 0.00889384 | 0.00450816  |     nan | 0.000776278 | 0.00706944  |     nan |     nan |     nan |     nan |     nan | 0.00683779 | 0.0036795  | 0.000456601 |     nan | 0.00090536 | 0.00149756 | 0.00277432 |        0 |
+-------+------------------------------------------------------------------+------------+----------+------------+-------------+----------+-------------+-----------+-------------+------------+--------+------------+------------+-------------+----------+------------+------------+----------+----------+------------+--------+-----------+-----------+-------------+-----------+------------+------------+------------+----------+----------+----------+--------+------------+------------+-------------+---------+-------------+-----------+-----------+------------+-----------+----------+-----------+-------------+------------+--------------+------------+----------+-----------+-------------+------------+----------+-----------+--------+--------+-------------+----------+------------+----------+-------------+--------+-------------+--------+----------+-------------+-------------+------------+-------------+------------+------------+------------+-------------+----------+------------+--------+-------------+-------------+------------+--------+-------------+-------------+-----------+-------------+-------------+-------------+-------------+-------------+-------+-------------+-------------+------------+-------------+-------------+-------------+----------+-------------+---------+------------+------------+-------------+-------------+------------+------------+-------------+--------+--------+-------------+------------+--------+-------------+------------+--------+--------+-------------+------------+-------------+-------------+------------+-------------+------------+-------------+-------------+-------------+-------------+------------+-------------+-------------+------------+-------------+------------+----------+----------+-----------+----------+-------------+------------+-------------+-------------+---------+---------+-------------+-------------+------------+--------+---------+--------+---------+------------+---------+---------+--------+---------+------------+-------------+----------+---------+-----------+---------+---------+-----------+-----------+---------+----------+----------+------------+----------+-------------+---------+------------+---------+---------+------------+--------+------------+-------------+---------+-------------+-------------+---------+---------+---------+---------+---------+------------+------------+-------------+---------+------------+------------+------------+----------+
| 21603 | fffff1d38b785cef84adeace64f8f83db3a0c31e8d92eaba8b115f71cab04681 | 2017-12-23 | 0.984907 | 0.296536   | 0.0072093   | 0.81261  | 0.00590385  | 0.0798862 | 0.00224314  | 0.0236906  |    nan | 0.00946712 | 0.0052172  | 0.0143543   | 0.74418  | 0.0296123  | 0.00871671 | 0.394486 | 0.534473 | 0.0515023  |    nan | 0.171524  | 0.0218534 | 0.00686334  | 0.100331  | 0.00499728 | 0.00564465 | 0.00246009 | 0.286289 | 0.705934 | 0.284274 |    nan | 0.00877664 | 0.00511916 | 0.00461875  | 1.00835 | 0.00262849  | 0.0496325 | 0.0580019 | 0.705059   | 0.035277  | 0.141704 | 0.0498787 | 0.000881124 | 0.00299744 |   0.0254498  | 0.0121125  | 0.396883 | 0.171943  |  0.0181791  | 0.0109906  | 0.244838 | 0.328528  | CL     | O      | 0.00869966  | 0.755125 | 0.177476   | 1.00709  | 0.00155766  |    nan | 1.86436e-05 |      5 | 0.18805  | 0.00774565  | 0.423013    | 0.00106889 | 0.00592355  | 0.00523946 | 0.00438245 | 0.0150312  | 0.00651415  | 0.203718 | 0.00782307 |    nan | 0.00976282  | 0.00717343  | 0.00515333 |    nan | 0.00669154  | 1.68668e-05 | 0.303197  | 0.00760322  | 0.0025544   | 0.00805531  | 0.00701904  | 0.0035867   |   nan | 0.00806535  | 0.00417198  | 0.00514936 | 0.00721965  | 0.000454041 | 9.86978e-05 | 0.500572 | 0.000252393 | 1.00394 | 0.0242376  | 0.00898507 | 0.00515675  | 0.00434013  | 0.00316093 | 0.0019808  | 0.00741056  |    nan |      0 | 0.000641883 | 0.00380215 |    nan | 0.00787752  | 0.00990207 |    nan |      1 | 0.00940781  | 0.00633086 | 0.0097343   | 0.00797947  | 0.0072556  | 0.00291049  | 1.00777    | 0.000333857 | 0.00663736  | 0.00308357  | 0.0092913   | 0.00320032 | 6.09387e-06 | 0.000904491 | 0.00334796 | 0.00817109  | 0.00225042 | 0.8788   | 0.137596 | 0.900471  | 0.97474  | 0.00472212  | 0.00574052 | 0.0083807   | 0.00801598  |     nan |     nan | 0.00698241  | 0.00647536  | 0.0134447  |    nan | 1.00735 |      3 |     nan | 0.00650298 |     nan |     nan |    nan | 1.00177 | 0.0289882  | 0.253864    | 0.200897 |       1 | 0.0309049 |       0 |       3 | 0.0317536 | 0.0300339 |       0 | 0.715156 | 0.437259 | 0.0043291  | 0.456621 | 0.0091804   |       1 | 1.00405    | 1.00883 | 1.0085  | 0.00320819 |    nan | 0.00509388 | 0.00340632  |     nan | 0.00174142  | 0.00205599  |     nan |     nan |     nan |     nan |     nan | 0.00331017 | 0.00709705 | 0.0078575   |     nan | 0.00277689 | 0.00822523 | 0.00885638 |        0 |
+-------+------------------------------------------------------------------+------------+----------+------------+-------------+----------+-------------+-----------+-------------+------------+--------+------------+------------+-------------+----------+------------+------------+----------+----------+------------+--------+-----------+-----------+-------------+-----------+------------+------------+------------+----------+----------+----------+--------+------------+------------+-------------+---------+-------------+-----------+-----------+------------+-----------+----------+-----------+-------------+------------+--------------+------------+----------+-----------+-------------+------------+----------+-----------+--------+--------+-------------+----------+------------+----------+-------------+--------+-------------+--------+----------+-------------+-------------+------------+-------------+------------+------------+------------+-------------+----------+------------+--------+-------------+-------------+------------+--------+-------------+-------------+-----------+-------------+-------------+-------------+-------------+-------------+-------+-------------+-------------+------------+-------------+-------------+-------------+----------+-------------+---------+------------+------------+-------------+-------------+------------+------------+-------------+--------+--------+-------------+------------+--------+-------------+------------+--------+--------+-------------+------------+-------------+-------------+------------+-------------+------------+-------------+-------------+-------------+-------------+------------+-------------+-------------+------------+-------------+------------+----------+----------+-----------+----------+-------------+------------+-------------+-------------+---------+---------+-------------+-------------+------------+--------+---------+--------+---------+------------+---------+---------+--------+---------+------------+-------------+----------+---------+-----------+---------+---------+-----------+-----------+---------+----------+----------+------------+----------+-------------+---------+------------+---------+---------+------------+--------+------------+-------------+---------+-------------+-------------+---------+---------+---------+---------+---------+------------+------------+-------------+---------+------------+------------+------------+----------+
| 21604 | fffff1d38b785cef84adeace64f8f83db3a0c31e8d92eaba8b115f71cab04681 | 2018-01-06 | 0.983019 | 0.443984   | 0.0131506   | 0.815422 | 0.00345666  | 0.100503  | 0.00211136  | 0.0123429  |    nan | 0.0065908  | 0.00235049 | 0.0164248   | 0.747021 | 0.0118573  | 0.00836593 | 0.39605  | 0.530051 | 0.0320045  |    nan | 0.181703  | 0.0161388 | 0.00205031  | 0.0942802 | 0.0070141  | 0.00408982 | 0.0096977  | 0.284209 | 0.711415 | 0.891591 |    nan | 0.00430822 | 0.00812099 | 0.00973736  | 1.00662 | 0.00941841  | 0.0513312 | 0.061328  | 0.32698    | 0.0226323 | 0.138062 | 0.0451061 | 0.00820883  | 0.00243311 |   0.0255705  | 0.0107452  | 0.31268  | 0.176868  |  0.0130287  | 0.0121847  | 0.800476 | 0.328972  | CL     | O      | 0.000904041 | 0.757985 | 0.178055   | 1.002    | 0.000679138 |    nan | 0.00138746  |      5 | 0.192534 | 0.000888265 | 0.00609963  | 0.00427331 | 0.00101051  | 0.00692996 | 0.00680301 | 0.0121078  | 0.00931326  | 0.20047  | 0.0130412  |    nan | 0.00551576  | 0.00622886  | 0.0032797  |    nan | 0.00630154  | 0.00292608  | 0.300316  | 0.000706332 | 0.00816389  | 0.00718466  | 0.00236253  | 0.00187878  |   nan | 0.00589711  | 0.00512095  | 0.00642161 | 0.00571174  | 0.00353871  | 0.00902542  | 0.502683 | 0.00616393  | 1.00331 | 0.0188456  | 0.00618801 | 0.00245985  | 0.00558085  | 0.00169432 | 0.00789482 | 0.00669533  |    nan |      0 | 0.00394038  | 0.00723228 |    nan | 0.00524287  | 0.00418006 |    nan |      1 | 0.00689965  | 0.00907128 | 0.00485114  | 0.00748933  | 0.00112946 | 0.000365128 | 1.00894    | 0.0095033   | 0.000864763 | 0.00568987  | 0.00334932  | 0.0098897  | 0.0040175   | 0.0087748   | 0.00863152 | 0.00745615  | 0.00806786 | 0.862615 | 0.138715 | 0.883456  | 0.97263  | 0.00291029  | 0.00409241 | 0.00498011  | 0.00159919  |     nan |     nan | 0.00228788  | 0.00427194  | 0.00906144 |    nan | 1.00432 |      3 |     nan | 0.00512786 |     nan |     nan |    nan | 1.00944 | 0.0261515  | 0.345503    | 0.206613 |       1 | 0.0296029 |       0 |       3 | 0.0328637 | 0.0258646 |       0 | 0.720331 | 0.429396 | 0.00881769 | 0.461599 | 0.00470693  |       1 | 1.00908    | 1.00081 | 1.00355 | 0.00755355 |    nan | 0.0091471  | 0.00294629  |     nan | 0.0060599   | 0.00507639  |     nan |     nan |     nan |     nan |     nan | 0.00995528 | 0.00999359 | 0.0010882   |     nan | 0.00569324 | 0.00677317 | 0.00556634 |        0 |
+-------+------------------------------------------------------------------+------------+----------+------------+-------------+----------+-------------+-----------+-------------+------------+--------+------------+------------+-------------+----------+------------+------------+----------+----------+------------+--------+-----------+-----------+-------------+-----------+------------+------------+------------+----------+----------+----------+--------+------------+------------+-------------+---------+-------------+-----------+-----------+------------+-----------+----------+-----------+-------------+------------+--------------+------------+----------+-----------+-------------+------------+----------+-----------+--------+--------+-------------+----------+------------+----------+-------------+--------+-------------+--------+----------+-------------+-------------+------------+-------------+------------+------------+------------+-------------+----------+------------+--------+-------------+-------------+------------+--------+-------------+-------------+-----------+-------------+-------------+-------------+-------------+-------------+-------+-------------+-------------+------------+-------------+-------------+-------------+----------+-------------+---------+------------+------------+-------------+-------------+------------+------------+-------------+--------+--------+-------------+------------+--------+-------------+------------+--------+--------+-------------+------------+-------------+-------------+------------+-------------+------------+-------------+-------------+-------------+-------------+------------+-------------+-------------+------------+-------------+------------+----------+----------+-----------+----------+-------------+------------+-------------+-------------+---------+---------+-------------+-------------+------------+--------+---------+--------+---------+------------+---------+---------+--------+---------+------------+-------------+----------+---------+-----------+---------+---------+-----------+-----------+---------+----------+----------+------------+----------+-------------+---------+------------+---------+---------+------------+--------+------------+-------------+---------+-------------+-------------+---------+---------+---------+---------+---------+------------+------------+-------------+---------+------------+------------+------------+----------+
| 21605 | fffff1d38b785cef84adeace64f8f83db3a0c31e8d92eaba8b115f71cab04681 | 2018-02-06 | 0.969861 | 0.442553   | 0.00985513  | 1.00354  | 0.00511708  | 0.101802  | 0.00993036  | 0.00857845 |    nan | 0.0142348  | 0.00650907 | 0.00442393  | 0.74819  | 0.0195315  | 0.00470438 | 0.434467 | 0.531355 | 0.0215759  |    nan | 0.161841  | 0.0147985 | 0.00190997  | 0.099241  | 0.00318313 | 0.00662782 | 0.00572258 | 0.286614 | 0.643626 | 0.298447 |    nan | 0.00488334 | 0.0074309  | 0.00540302  | 1.00162 | 0.00954366  | 0.0571642 | 0.0488864 | 0.327939   | 0.0197211 | 0.144218 | 0.0505855 | 0.00458074  | 0.00647321 |   0.0170403  | 0.00376026 | 0.300423 | 0.114578  |  0.0322048  | 0.00988386 | 0.965168 | 0.330719  | CL     | O      | 0.00787754  | 0.671669 | 0.00735174 | 1.00851  | 0.00240323  |    nan | 0.00829777  |      5 | 0.187689 | 0.00994163  | 0.00391274  | 0.0024208  | 0.00822021  | 0.00514851 | 0.00419156 | 0.0116529  | 0.00955005  | 0.209341 | 0.0018004  |    nan | 0.00267784  | 0.00490734  | 0.0068387  |    nan | 1.75538e-05 | 0.00544411  | 0.305354  | 0.00233757  | 0.000951692 | 0.000388893 | 0.000617    | 0.00799858  |   nan | 0.00280428  | 0.00624843  | 4.1435e-05 | 0.00688351  | 0.00622679  | 0.000845709 | 0.502655 | 0.00112122  | 1.00091 | 0.00963493 | 0.00906724 | 0.00501833  | 0.00521382  | 0.00968889 | 0.00740218 | 0.000242821 |    nan |      0 | 0.00174143  | 0.00791741 |    nan | 0.00434306  | 0.0031086  |    nan |      1 | 0.00546168  | 0.0060389  | 0.00234227  | 0.00503443  | 0.00708575 | 0.00768648  | 1.00274    | 0.00810213  | 0.00651381  | 0.00495602  | 0.00953594  | 0.00669058 | 0.00425012  | 0.000501563 | 8.7703e-05 | 0.000125749 | 0.0006356  | 0.872319 | 0.132014 | 0.886145  | 0.975976 | 0.00187745  | 0.00816108 | 0.0056038   | 0.0082986   |     nan |     nan | 0.00920261  | 0.00656612  | 0.00806324 |    nan | 1.00178 |      3 |     nan | 0.00837661 |     nan |     nan |    nan | 1.00962 | 0.0147374  | 0.208531    | 0.203652 |       1 | 0.0284625 |       0 |       3 | 0.0334803 | 0.0270279 |       0 | 0.71733  | 0.429582 | 0.00778327 | 0.459615 | 0.00328052  |       1 | 1          | 1.00619 | 1.00542 | 0.00837285 |    nan | 0.00932034 | 0.00851143  |     nan | 0.00381109  | 0.00868222  |     nan |     nan |     nan |     nan |     nan | 0.00554102 | 0.00656426 | 0.00988268  |     nan | 0.00812339 | 0.00116799 | 0.00398257 |        0 |
+-------+------------------------------------------------------------------+------------+----------+------------+-------------+----------+-------------+-----------+-------------+------------+--------+------------+------------+-------------+----------+------------+------------+----------+----------+------------+--------+-----------+-----------+-------------+-----------+------------+------------+------------+----------+----------+----------+--------+------------+------------+-------------+---------+-------------+-----------+-----------+------------+-----------+----------+-----------+-------------+------------+--------------+------------+----------+-----------+-------------+------------+----------+-----------+--------+--------+-------------+----------+------------+----------+-------------+--------+-------------+--------+----------+-------------+-------------+------------+-------------+------------+------------+------------+-------------+----------+------------+--------+-------------+-------------+------------+--------+-------------+-------------+-----------+-------------+-------------+-------------+-------------+-------------+-------+-------------+-------------+------------+-------------+-------------+-------------+----------+-------------+---------+------------+------------+-------------+-------------+------------+------------+-------------+--------+--------+-------------+------------+--------+-------------+------------+--------+--------+-------------+------------+-------------+-------------+------------+-------------+------------+-------------+-------------+-------------+-------------+------------+-------------+-------------+------------+-------------+------------+----------+----------+-----------+----------+-------------+------------+-------------+-------------+---------+---------+-------------+-------------+------------+--------+---------+--------+---------+------------+---------+---------+--------+---------+------------+-------------+----------+---------+-----------+---------+---------+-----------+-----------+---------+----------+----------+------------+----------+-------------+---------+------------+---------+---------+------------+--------+------------+-------------+---------+-------------+-------------+---------+---------+---------+---------+---------+------------+------------+-------------+---------+------------+------------+------------+----------+
| 21606 | fffff1d38b785cef84adeace64f8f83db3a0c31e8d92eaba8b115f71cab04681 | 2018-03-14 | 0.982175 | 0.00247371 | 7.69387e-05 | 0.99288  | 0.000809297 | 0.119165  | 0.00328729  | 0.0140916  |    nan | 0.0134545  | 0.00679392 | 0.0183351   | 0.750784 | 0.00661706 | 0.00101603 | 0.459745 | 0.53161  | 0.0185772  |    nan | 0.233117  | 0.0281845 | 0.00791978  | 0.088608  | 0.00805739 | 0.00197626 | 0.00501446 | 0.281229 | 0.611945 | 0.291345 |    nan | 0.00458005 | 0.00565379 | 0.00560943  | 1.00355 | 0.000762599 | 0.0654661 | 0.0280857 | 0.00667417 | 0.025615  | 0.142516 | 0.0484984 | 0.00811181  | 0.0167101  |   0.00585367 | 0.00861382 | 0.299138 | 0.0231363 | -0.0035556  | 0.00300076 | 0.280465 | 0.0788301 | CL     | O      | 0.00316832  | 0.583801 | 0.00377119 | 0.689411 | 0.00816809  |    nan | 0.00674287  |      5 | 0.191495 | 0.00961445  | 0.00773618  | 0.00709129 | 0.0043876   | 0.00872127 | 0.258259   | 0.0137469  | 0.00654186  | 0.505329 | 0.0179351  |    nan | 0.00767364  | 0.08031     | 0.0716808  |    nan | 0.00593036  | 0.00770892  | 0.0777245 | 0.00291845  | 4.5367e-05  | 0.00637454  | 0.000248292 | 0.000835566 |   nan | 0.00723114  | 0.00390096  | 0.00412366 | 0.00954836  | 0.00236517  | 0.00860746  | 0.501835 | 0.00243186  | 1.00661 | 0.0161454  | 0.00613457 | 0.00806499  | 0.00723782  | 0.00678782 | 0.00225419 | 0.00633582  |    nan |      0 | 0.00836454  | 0.00475822 |    nan | 0.00719428  | 0.00103103 |    nan |      1 | 0.00603285  | 0.00626225 | 0.0089818   | 0.0092644   | 0.00715451 | 0.00594361  | 1.00518    | 0.00704084  | 0.00567061  | 0.00820278  | 0.00208198  | 0.00886933 | 0.00373651  | 0.000146032 | 0.00979295 | 0.00971192  | 0.00219998 | 0.295251 | 0.131636 | 0.0805137 | 0.97469  | 0.00534633  | 0.0034592  | 0.00578538  | 0.00910069  |     nan |     nan | 0.000520197 | 0.0077809   | 0.00800425 |    nan | 1.00518 |      3 |     nan | 0.00986277 |     nan |     nan |    nan | 1.00968 | 0.0517409  | 0.000567647 | 0.200206 |       1 | 0.0375318 |       0 |       3 | 0.037342  | 0.033036  |       0 | 0.728418 | 0.429784 | 0.00261789 | 0.461738 | 0.00710487  |       1 | 1.00231    | 1.00567 | 1.00066 | 0.00239206 |    nan | 0.00063346 | 0.00134913  |     nan | 0.00631154  | 0.00542911  |     nan |     nan |     nan |     nan |     nan | 0.00731646 | 0.00288779 | 0.00620741  |     nan | 0.00511039 | 0.00318361 | 0.00191411 |        0 |
+-------+------------------------------------------------------------------+------------+----------+------------+-------------+----------+-------------+-----------+-------------+------------+--------+------------+------------+-------------+----------+------------+------------+----------+----------+------------+--------+-----------+-----------+-------------+-----------+------------+------------+------------+----------+----------+----------+--------+------------+------------+-------------+---------+-------------+-----------+-----------+------------+-----------+----------+-----------+-------------+------------+--------------+------------+----------+-----------+-------------+------------+----------+-----------+--------+--------+-------------+----------+------------+----------+-------------+--------+-------------+--------+----------+-------------+-------------+------------+-------------+------------+------------+------------+-------------+----------+------------+--------+-------------+-------------+------------+--------+-------------+-------------+-----------+-------------+-------------+-------------+-------------+-------------+-------+-------------+-------------+------------+-------------+-------------+-------------+----------+-------------+---------+------------+------------+-------------+-------------+------------+------------+-------------+--------+--------+-------------+------------+--------+-------------+------------+--------+--------+-------------+------------+-------------+-------------+------------+-------------+------------+-------------+-------------+-------------+-------------+------------+-------------+-------------+------------+-------------+------------+----------+----------+-----------+----------+-------------+------------+-------------+-------------+---------+---------+-------------+-------------+------------+--------+---------+--------+---------+------------+---------+---------+--------+---------+------------+-------------+----------+---------+-----------+---------+---------+-----------+-----------+---------+----------+----------+------------+----------+-------------+---------+------------+---------+---------+------------+--------+------------+-------------+---------+-------------+-------------+---------+---------+---------+---------+---------+------------+------------+-------------+---------+------------+------------+------------+----------+
</pre></div>
</div>
</div>
</div>
<p>Verificamos que al concatenar los conjuntos de datos se obtenga el mismo número de filas y columnas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">n_columnas</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">n_filas</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;El conjunto de entrenamiento para la variable respuesta tiene </span><span class="si">{</span><span class="n">n_filas</span><span class="si">}</span><span class="s2"> filas y </span><span class="si">{</span><span class="n">n_columnas</span><span class="si">}</span><span class="s2"> columnas.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>El conjunto de entrenamiento para la variable respuesta tiene 5531451 filas y 191 columnas.
</pre></div>
</div>
</div>
</div>
<p><strong>Identificar variables categóricas</strong></p>
<p>Se desea identificar cuales y cuantas variables de tipo categórico posee el conjunto de datos para su adecuado tratamiento y limpieza. Es clave mencionar que se encontraron 4 variables categóricas entre las que se destacan:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">costumer_ID</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Date</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">D_63</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">D_64</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Seleccionar solo las columnas categóricas</span>
<span class="n">categorical_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;B_30&#39;</span><span class="p">,</span> <span class="s1">&#39;B_38&#39;</span><span class="p">,</span> <span class="s1">&#39;D_114&#39;</span><span class="p">,</span> <span class="s1">&#39;D_116&#39;</span><span class="p">,</span> <span class="s1">&#39;D_117&#39;</span><span class="p">,</span> <span class="s1">&#39;D_120&#39;</span><span class="p">,</span> <span class="s1">&#39;D_126&#39;</span><span class="p">,</span> <span class="s1">&#39;D_63&#39;</span><span class="p">,</span> <span class="s1">&#39;D_64&#39;</span><span class="p">,</span> <span class="s1">&#39;D_66&#39;</span><span class="p">,</span> <span class="s1">&#39;D_68&#39;</span><span class="p">]</span>

<span class="c1"># Mostrar el head del DataFrame solo con esas columnas</span>
<span class="n">data_categorical_head</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">categorical_columns</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Mostrar la salida</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_categorical_head</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   B_30  B_38  D_114  D_116  D_117  D_120  D_126 D_63 D_64  D_66  D_68
0   0.0   2.0    1.0    0.0    4.0    0.0    1.0   CR    O   NaN   6.0
1   0.0   2.0    1.0    0.0    4.0    0.0    1.0   CR    O   NaN   6.0
2   0.0   2.0    1.0    0.0    4.0    0.0    1.0   CR    O   NaN   6.0
3   0.0   2.0    1.0    0.0    4.0    0.0    1.0   CR    O   NaN   6.0
4   0.0   2.0    1.0    0.0    4.0    0.0    1.0   CR    O   NaN   6.0
5   0.0   2.0    1.0    0.0    4.0    0.0    1.0   CR    O   NaN   6.0
6   0.0   2.0    1.0    0.0    4.0    0.0    1.0   CR    O   NaN   6.0
7   0.0   2.0    1.0    0.0    4.0    0.0    1.0   CR    O   NaN   6.0
8   0.0   2.0    1.0    0.0    4.0    0.0    1.0   CR    O   NaN   6.0
9   0.0   2.0    1.0    0.0    4.0    0.0    1.0   CR    O   NaN   6.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">identify_categorical_vars_dask</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Identifies categorical (non-numerical) variables in a Dask DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: Dask DataFrame</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of column names that are considered categorical.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">categorical_vars</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="c1"># Check for &#39;string[pyarrow]&#39; or &#39;object&#39; dtype</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;string&#39;</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;string[pyarrow]&#39;</span><span class="p">:</span>
            <span class="n">categorical_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">categorical_vars</span>

<span class="c1"># Example usage:</span>
<span class="n">categorical_columns</span> <span class="o">=</span> <span class="n">identify_categorical_vars_dask</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Categorical columns:&quot;</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Categorical columns: [&#39;customer_ID&#39;, &#39;Date&#39;, &#39;D_63&#39;, &#39;D_64&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="analisis-de-datos-faltantes">
<h2>Anàlisis de datos faltantes<a class="headerlink" href="#analisis-de-datos-faltantes" title="Link to this heading">#</a></h2>
<p>Para poder hacer cualquier tipo de análisis o inferencias se debe contar con la menor cantidad de datos ausentes posible, es por eso que el análisis de datos faltantes y revisión de inconsistencias en los mismos es clave para nuestro objetivo de análisis.</p>
<ol class="arabic simple">
<li><p>En primera instancia se contabiliza el número de datos faltantes por columnas y la proporciòn de los mismos. Se muestran los resultados en una columna o lista.</p></li>
<li><p>En segunda instancia se dividen los datos dependiendo su tipo para poder observar grypalmente como se distribuye o comporta la cantidad de datos faltantes por grupo. Los grupos son los siguientes:</p></li>
</ol>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">D_*</span></code> = Delinquency variables</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">S_*</span></code> = Spend variables</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">P_*</span></code> = Payment variables</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">B_*</span></code> = Balance variables</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">R_*</span></code> = Risk variables</p></li>
</ul>
<p>Se realizan funciones para calcular el porcentaje de datod faltanes y el conteo de datos faltantes por variable para cada grupo y organizarlos en una tabla de información.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">missing_percentage</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">missing_count</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">missing_values_count</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calcular el porcentaje de datos faltantes por columna</span>
<span class="n">total_rows</span> <span class="o">=</span> <span class="mi">5531451</span>  <span class="c1"># Computar el número de filas</span>
<span class="n">missing_percentage</span> <span class="o">=</span> <span class="p">(</span><span class="n">missing_values_count</span> <span class="o">/</span> <span class="n">total_rows</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Crear un DataFrame con conteo y porcentaje (computar para pasar a pandas)</span>
<span class="n">missing_values_count</span> <span class="o">=</span> <span class="n">missing_values_count</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">missing_percentage</span> <span class="o">=</span> <span class="n">missing_percentage</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Crear un DataFrame para mostrar el conteo y porcentaje</span>
<span class="n">missing_data_summary</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Column&#39;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
    <span class="s1">&#39;Datos Faltantes&#39;</span><span class="p">:</span> <span class="n">missing_values_count</span><span class="p">,</span>
    <span class="s1">&#39;Porcentaje (%)&#39;</span><span class="p">:</span> <span class="n">missing_percentage</span>
<span class="p">})</span>

<span class="c1"># Ordenar el DataFrame por el conteo de datos faltantes en orden descendente</span>
<span class="n">missing_data_summary</span> <span class="o">=</span> <span class="n">missing_data_summary</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Datos Faltantes&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Los datos de cada grupo se dividen en una lista que permite identificar su categoría con base a la letra con la que inician. En este caso, la división de datos se establece con base a los siguientes grupos:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">delinquency_columns</span></code>: Para las variables que inician con <code class="docutils literal notranslate"><span class="pre">'D_'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spend_columns</span></code>: Para las variables que inician con <code class="docutils literal notranslate"><span class="pre">'S_'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">payment_columns</span></code>: Para las variables que inician con <code class="docutils literal notranslate"><span class="pre">'P_'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">balance_columns</span></code>: Para las variables que inician con <code class="docutils literal notranslate"><span class="pre">'B_'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">risk_columns</span></code>: Para las variables que inician con <code class="docutils literal notranslate"><span class="pre">'R_'</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Asignar las columnas a cada grupo según el criterio de nombre</span>
<span class="n">delinquency_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;D_&#39;</span><span class="p">)]</span>
<span class="n">spend_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;S_&#39;</span><span class="p">)]</span>
<span class="n">payment_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;P_&#39;</span><span class="p">)]</span>
<span class="n">balance_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;B_&#39;</span><span class="p">)]</span>
<span class="n">risk_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;R_&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<p>De forma descendente se muestra una lista para cada división o grupo de datos en la que se presenta su respectiva variable intragrupal con su número de datos faltantes y porcentaje de falta. Se destaca la alta presencia de datos faltantes en grupos como:</p>
<ul class="simple">
<li><p><em>Delinquency variables</em></p></li>
<li><p><em>Spend variables</em></p></li>
</ul>
<p>Lo que podría sugerir una posible dificultad en captación o e extracción de dichos datos, teniendo en cuenta que la mayoría de las variables de esos grupos que poseen datos faltantes se encuentran por encima del 50%.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Función para filtrar y mostrar datos faltantes por grupo</span>
<span class="k">def</span> <span class="nf">show_missing_by_group</span><span class="p">(</span><span class="n">group_columns</span><span class="p">,</span> <span class="n">group_name</span><span class="p">):</span>
    <span class="n">group_df</span> <span class="o">=</span> <span class="n">missing_data_summary</span><span class="p">[</span><span class="n">missing_data_summary</span><span class="p">[</span><span class="s1">&#39;Column&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">group_columns</span><span class="p">)]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2"> - Missing Data Summary:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">group_df</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="c1"># Mostrar los datos faltantes por cada grupo de variables</span>
<span class="n">show_missing_by_group</span><span class="p">(</span><span class="n">delinquency_columns</span><span class="p">,</span> <span class="s2">&quot;Delinquency Variables&quot;</span><span class="p">)</span>
<span class="n">show_missing_by_group</span><span class="p">(</span><span class="n">spend_columns</span><span class="p">,</span> <span class="s2">&quot;Spend Variables&quot;</span><span class="p">)</span>
<span class="n">show_missing_by_group</span><span class="p">(</span><span class="n">payment_columns</span><span class="p">,</span> <span class="s2">&quot;Payment Variables&quot;</span><span class="p">)</span>
<span class="n">show_missing_by_group</span><span class="p">(</span><span class="n">balance_columns</span><span class="p">,</span> <span class="s2">&quot;Balance Variables&quot;</span><span class="p">)</span>
<span class="n">show_missing_by_group</span><span class="p">(</span><span class="n">risk_columns</span><span class="p">,</span> <span class="s2">&quot;Risk Variables&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Delinquency Variables - Missing Data Summary:
Column  Datos Faltantes  Porcentaje (%)
  D_87          5527586       99.930127
  D_88          5525447       99.891457
 D_108          5502513       99.476846
 D_110          5500117       99.433530
 D_111          5500117       99.433530
  D_73          5475595       98.990211
 D_134          5336752       96.480146
 D_138          5336752       96.480146
 D_137          5336752       96.480146
 D_136          5336752       96.480146
 D_135          5336752       96.480146
 D_106          4990102       90.213255
 D_132          4988874       90.191055
  D_49          4985917       90.137597
  D_76          4908954       88.746226
  D_66          4908097       88.730733
  D_42          4740137       85.694278
 D_142          4587043       82.926577
  D_53          4084585       73.842921
  D_82          4058614       73.373406
  D_50          3142402       56.809723
 D_105          3021431       54.622756
  D_56          2990943       54.071581
  D_77          2513912       45.447605
  D_43          1658396       29.981211
  D_46          1211699       21.905627
  D_62           758161       13.706367
  D_48           718725       12.993426
  D_61           598052       10.811847
  D_78           274319        4.959259
  D_44           274319        4.959259
  D_64           217442        3.931012
  D_68           216503        3.914036
  D_83           194473        3.515768
  D_69           194473        3.515768
  D_55           184803        3.340950
 D_124           176716        3.194749
 D_119           176716        3.194749
 D_116           176716        3.194749
 D_118           176716        3.194749
 D_114           176716        3.194749
 D_115           176716        3.194749
 D_117           176716        3.194749
 D_113           176716        3.194749
 D_125           176716        3.194749
 D_120           176716        3.194749
 D_121           176716        3.194749
 D_122           176716        3.194749
 D_123           176716        3.194749
  D_91           157216        2.842220
 D_126           116816        2.111851
  D_59           106725        1.929421
 D_141           101548        1.835829
 D_131           101548        1.835829
 D_139           101548        1.835829
 D_145           101548        1.835829
 D_130           101548        1.835829
 D_129           101548        1.835829
 D_103           101548        1.835829
 D_107           101548        1.835829
 D_104           101548        1.835829
 D_143           101548        1.835829
 D_128           101548        1.835829
  D_70            94917        1.715951
  D_79            75939        1.372859
 D_133            42716        0.772239
 D_144            40727        0.736281
 D_102            40655        0.734979
 D_140            40632        0.734563
  D_84            29563        0.534453
  D_89            29563        0.534453
  D_52            29563        0.534453
  D_81            25687        0.464381
  D_72            23708        0.428604
  D_74            21773        0.393622
  D_80            21773        0.393622
 D_112             2650        0.047908
  D_45             2017        0.036464
  D_54             2016        0.036446
  D_41             2016        0.036446
 D_109             1597        0.028871
  D_47                0        0.000000
 D_127                0        0.000000
  D_92                0        0.000000
  D_93                0        0.000000
  D_94                0        0.000000
  D_63                0        0.000000
  D_65                0        0.000000
  D_86                0        0.000000
  D_96                0        0.000000
  D_58                0        0.000000
  D_60                0        0.000000
  D_51                0        0.000000
  D_75                0        0.000000
  D_71                0        0.000000
  D_39                0        0.000000

Spend Variables - Missing Data Summary:
Column  Datos Faltantes  Porcentaje (%)
   S_9          2933643       53.035686
  S_27          1400935       25.326718
   S_7          1020544       18.449843
   S_3          1020544       18.449843
  S_22            19024        0.343924
  S_24            18593        0.336132
  S_25            12847        0.232254
  S_26              634        0.011462
  S_23              445        0.008045
   S_5                0        0.000000
  S_15                0        0.000000
  S_18                0        0.000000
  S_11                0        0.000000
  S_16                0        0.000000
  S_17                0        0.000000
   S_6                0        0.000000
  S_12                0        0.000000
   S_8                0        0.000000
  S_13                0        0.000000
  S_19                0        0.000000
  S_20                0        0.000000

Payment Variables - Missing Data Summary:
Column  Datos Faltantes  Porcentaje (%)
   P_3           301492        5.450505
   P_2            45985        0.831337
   P_4                0        0.000000

Balance Variables - Missing Data Summary:
Column  Datos Faltantes  Porcentaje (%)
  B_39          5497819       99.391986
  B_42          5459973       98.707789
  B_29          5150035       93.104594
  B_17          3137598       56.722874
  B_13            49519        0.895226
   B_8            22268        0.402571
  B_25             6923        0.125157
  B_15             6923        0.125157
   B_3             2016        0.036446
  B_22             2016        0.036446
  B_16             2016        0.036446
  B_20             2016        0.036446
  B_19             2016        0.036446
  B_38             2016        0.036446
  B_26             2016        0.036446
   B_2             2016        0.036446
  B_30             2016        0.036446
  B_33             2016        0.036446
  B_27             2016        0.036446
  B_41              690        0.012474
   B_6              233        0.004212
  B_37               56        0.001012
  B_40               53        0.000958
   B_4                0        0.000000
   B_5                0        0.000000
  B_10                0        0.000000
   B_7                0        0.000000
  B_23                0        0.000000
  B_28                0        0.000000
  B_14                0        0.000000
  B_36                0        0.000000
  B_11                0        0.000000
  B_12                0        0.000000
   B_9                0        0.000000
  B_24                0        0.000000
  B_18                0        0.000000
  B_21                0        0.000000
   B_1                0        0.000000
  B_31                0        0.000000
  B_32                0        0.000000

Risk Variables - Missing Data Summary:
Column  Datos Faltantes  Porcentaje (%)
   R_9          5218918       94.349891
  R_26          4922146       88.984717
  R_27           128703        2.326749
  R_20               75        0.001356
  R_12               56        0.001012
   R_7                1        0.000018
  R_14                1        0.000018
   R_2                0        0.000000
  R_21                0        0.000000
  R_22                0        0.000000
  R_23                0        0.000000
  R_24                0        0.000000
  R_25                0        0.000000
  R_17                0        0.000000
  R_18                0        0.000000
  R_13                0        0.000000
  R_15                0        0.000000
  R_16                0        0.000000
   R_5                0        0.000000
  R_10                0        0.000000
  R_11                0        0.000000
   R_6                0        0.000000
   R_8                0        0.000000
   R_4                0        0.000000
   R_3                0        0.000000
   R_1                0        0.000000
  R_28                0        0.000000
  R_19                0        0.000000
</pre></div>
</div>
</div>
</div>
<p><strong>Conteo por grupos de variables</strong></p>
<p>Para cada grupo de variabes se realiza un proceso de insoección y cintei en cuanto a cuantas variables lo conforman, se organizan los grupos de forma descendente del que mayor posee variables al que posee menor número de variables:</p>
<ul class="simple">
<li><p>D_: 96</p></li>
<li><p>B_: 40</p></li>
<li><p>R_: 28</p></li>
<li><p>S_: 21</p></li>
<li><p>P_: 3</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">delinquency_df</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;D_&#39;</span><span class="p">)]]</span>
<span class="n">spend_df</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;S_&#39;</span><span class="p">)]]</span>
<span class="n">payment_df</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;P_&#39;</span><span class="p">)]]</span>
<span class="n">balance_df</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;B_&#39;</span><span class="p">)]]</span>
<span class="n">risk_df</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;R_&#39;</span><span class="p">)]]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Delinquency variables: </span><span class="si">{</span><span class="n">delinquency_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Spend variables: </span><span class="si">{</span><span class="n">spend_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Payment variables: </span><span class="si">{</span><span class="n">payment_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Balance variables: </span><span class="si">{</span><span class="n">balance_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Risk variables: </span><span class="si">{</span><span class="n">risk_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Delinquency variables: 96
Spend variables: 21
Payment variables: 3
Balance variables: 40
Risk variables: 28
</pre></div>
</div>
</div>
</div>
<p>Se observa el contenido de cada conjunto de datos extraído para verificar que se haya filtrado correctamente sin inconsistencias.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># spend_df.tail()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-f41e724d-3331-49ba-9fdd-00033ee977d3" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>S_3</th>
      <th>S_5</th>
      <th>S_6</th>
      <th>S_7</th>
      <th>S_8</th>
      <th>S_9</th>
      <th>S_11</th>
      <th>S_12</th>
      <th>S_13</th>
      <th>S_15</th>
      <th>...</th>
      <th>S_17</th>
      <th>S_18</th>
      <th>S_19</th>
      <th>S_20</th>
      <th>S_22</th>
      <th>S_23</th>
      <th>S_24</th>
      <th>S_25</th>
      <th>S_26</th>
      <th>S_27</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>21602</th>
      <td>0.090743</td>
      <td>0.036700</td>
      <td>0.000038</td>
      <td>0.055695</td>
      <td>0.705097</td>
      <td>0.021471</td>
      <td>0.483833</td>
      <td>0.188514</td>
      <td>0.511308</td>
      <td>0.204409</td>
      <td>...</td>
      <td>0.006024</td>
      <td>0.000671</td>
      <td>0.003172</td>
      <td>0.004446</td>
      <td>0.971546</td>
      <td>0.132063</td>
      <td>0.975162</td>
      <td>0.970563</td>
      <td>0.006208</td>
      <td>0.257406</td>
    </tr>
    <tr>
      <th>21603</th>
      <td>0.079886</td>
      <td>0.008777</td>
      <td>0.004619</td>
      <td>0.049632</td>
      <td>0.705059</td>
      <td>0.025450</td>
      <td>0.244838</td>
      <td>0.188050</td>
      <td>0.423013</td>
      <td>0.203718</td>
      <td>...</td>
      <td>0.000252</td>
      <td>0.000642</td>
      <td>0.009408</td>
      <td>0.007979</td>
      <td>0.878800</td>
      <td>0.137596</td>
      <td>0.900471</td>
      <td>0.974740</td>
      <td>0.004722</td>
      <td>0.253864</td>
    </tr>
    <tr>
      <th>21604</th>
      <td>0.100503</td>
      <td>0.004308</td>
      <td>0.009737</td>
      <td>0.051331</td>
      <td>0.326980</td>
      <td>0.025570</td>
      <td>0.800476</td>
      <td>0.192534</td>
      <td>0.006100</td>
      <td>0.200470</td>
      <td>...</td>
      <td>0.006164</td>
      <td>0.003940</td>
      <td>0.006900</td>
      <td>0.007489</td>
      <td>0.862615</td>
      <td>0.138715</td>
      <td>0.883456</td>
      <td>0.972630</td>
      <td>0.002910</td>
      <td>0.345503</td>
    </tr>
    <tr>
      <th>21605</th>
      <td>0.101802</td>
      <td>0.004883</td>
      <td>0.005403</td>
      <td>0.057164</td>
      <td>0.327939</td>
      <td>0.017040</td>
      <td>0.965168</td>
      <td>0.187689</td>
      <td>0.003913</td>
      <td>0.209341</td>
      <td>...</td>
      <td>0.001121</td>
      <td>0.001741</td>
      <td>0.005462</td>
      <td>0.005034</td>
      <td>0.872319</td>
      <td>0.132014</td>
      <td>0.886145</td>
      <td>0.975976</td>
      <td>0.001877</td>
      <td>0.208531</td>
    </tr>
    <tr>
      <th>21606</th>
      <td>0.119165</td>
      <td>0.004580</td>
      <td>0.005609</td>
      <td>0.065466</td>
      <td>0.006674</td>
      <td>0.005854</td>
      <td>0.280465</td>
      <td>0.191495</td>
      <td>0.007736</td>
      <td>0.505329</td>
      <td>...</td>
      <td>0.002432</td>
      <td>0.008365</td>
      <td>0.006033</td>
      <td>0.009264</td>
      <td>0.295251</td>
      <td>0.131636</td>
      <td>0.080514</td>
      <td>0.974690</td>
      <td>0.005346</td>
      <td>0.000568</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-f41e724d-3331-49ba-9fdd-00033ee977d3')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-f41e724d-3331-49ba-9fdd-00033ee977d3 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-f41e724d-3331-49ba-9fdd-00033ee977d3');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-6cda9c0e-fbdd-4a7e-9f63-e19f59e1f006">
  <button class="colab-df-quickchart" onclick="quickchart('df-6cda9c0e-fbdd-4a7e-9f63-e19f59e1f006')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-6cda9c0e-fbdd-4a7e-9f63-e19f59e1f006 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div></div>
</div>
</section>
<section id="identificar-variables-con-ausencia-de-datos-superior-a-50">
<h2>Identificar variables con ausencia de datos superior a 50%<a class="headerlink" href="#identificar-variables-con-ausencia-de-datos-superior-a-50" title="Link to this heading">#</a></h2>
<p>De acuerdo a <code class="docutils literal notranslate"><span class="pre">Rubin,</span> <span class="pre">1987</span></code> en <em><strong>Statistical Analysis with Missing Data</strong></em>, si la Data fue extraída de encuestas y la presencia de datos faltantes es cercana al 20%, 30% y màximo al 50% e sposible imputar, sin embargo con un margen de error e incertidumbre cada vez mayor. Por lo que se recomienda, dado que los datos son altamente incompletos, que la imputación puede resultar demasiado incierta.</p>
<p>Se realizará un análisis de datos faltantes para variables con un porcentaje de <em><code class="docutils literal notranslate"><span class="pre">missing</span> <span class="pre">data</span></code></em> superior al 50%, observar si existe correlación entre la distribución de los datos faltantes o son endependientes o patrón independiente. Esto se hace con el objetivo de garantizar la viabilidad de la eliminación de los datos faltantes.</p>
<p>Se lista cada grupo y el número de variables con datos faltantes por encima del 50%:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Delinquency</span> <span class="pre">Variables:</span> </code></p></li>
</ol>
<ul class="simple">
<li><p>Posee 23 variables por encima de 50% de datos faltantes. Es clave mencionar que 12 de ellas están por encima o igual al 90% con una distribución aparentemente correlacionada o similar. 3 alrededor de 50%-55% con una distribución aparentemente similar y 6 entre 70% - 90% con una distribución similar, es decir, se podría inspeccionar agrupaciones en dichas distribuciones.</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><code class="docutils literal notranslate"><span class="pre">Spend</span> <span class="pre">Variables:</span></code></p></li>
</ol>
<ul class="simple">
<li><p>Posee unicamente una variable con datos faltantes alrededor del 53% Por lo que podría ser eliminada del conjunto de datos.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p><code class="docutils literal notranslate"><span class="pre">Balance</span> <span class="pre">Variables:</span></code></p></li>
</ol>
<ul class="simple">
<li><p>Posee 4 variables con datos faltantes superior al 50%, de entre ellas, 3 por encima del 90% y 1 alrededor del 56%. Se podría señalar una relación en la distribución de las concentradas por encima del 90%.</p></li>
</ul>
<ol class="arabic simple" start="4">
<li><p><code class="docutils literal notranslate"><span class="pre">Risk</span> <span class="pre">Variables</span></code></p></li>
</ol>
<ul class="simple">
<li><p>Posee unicamente dos variables con datos faltantes por encima del 80%, por lo que pueden ser eliminadas.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filtrar las columnas que tienen más del 50% de datos faltantes</span>
<span class="n">missing_above_50</span> <span class="o">=</span> <span class="n">missing_data_summary</span><span class="p">[</span><span class="n">missing_data_summary</span><span class="p">[</span><span class="s1">&#39;Porcentaje (%)&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">]</span>

<span class="c1"># Función para mostrar los datos faltantes por grupo (D_, S_, P_, B_, R_) y el conteo de variables por encima del 50%</span>
<span class="k">def</span> <span class="nf">show_missing_above_50_by_group</span><span class="p">(</span><span class="n">group_columns</span><span class="p">,</span> <span class="n">group_name</span><span class="p">):</span>
    <span class="n">group_df</span> <span class="o">=</span> <span class="n">missing_above_50</span><span class="p">[</span><span class="n">missing_above_50</span><span class="p">[</span><span class="s1">&#39;Column&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">group_columns</span><span class="p">)]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">group_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>  <span class="c1"># Verificamos si el grupo tiene columnas con más del 50% de faltantes</span>
        <span class="n">count_above_50</span> <span class="o">=</span> <span class="n">group_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Contar el número de columnas en este grupo con más del 50% de faltantes</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2"> - Columnas con más del 50% de datos faltantes (Total: </span><span class="si">{</span><span class="n">count_above_50</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">group_df</span><span class="p">[[</span><span class="s1">&#39;Column&#39;</span><span class="p">,</span> <span class="s1">&#39;Porcentaje (%)&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2"> - No hay columnas con más del 50% de datos faltantes.&quot;</span><span class="p">)</span>

<span class="c1"># Mostrar los datos faltantes por cada grupo de variables con más del 50% de datos faltantes y el conteo</span>
<span class="n">show_missing_above_50_by_group</span><span class="p">(</span><span class="n">delinquency_columns</span><span class="p">,</span> <span class="s2">&quot;Delinquency Variables&quot;</span><span class="p">)</span>
<span class="n">show_missing_above_50_by_group</span><span class="p">(</span><span class="n">spend_columns</span><span class="p">,</span> <span class="s2">&quot;Spend Variables&quot;</span><span class="p">)</span>
<span class="n">show_missing_above_50_by_group</span><span class="p">(</span><span class="n">payment_columns</span><span class="p">,</span> <span class="s2">&quot;Payment Variables&quot;</span><span class="p">)</span>
<span class="n">show_missing_above_50_by_group</span><span class="p">(</span><span class="n">balance_columns</span><span class="p">,</span> <span class="s2">&quot;Balance Variables&quot;</span><span class="p">)</span>
<span class="n">show_missing_above_50_by_group</span><span class="p">(</span><span class="n">risk_columns</span><span class="p">,</span> <span class="s2">&quot;Risk Variables&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Delinquency Variables - Columnas con más del 50% de datos faltantes (Total: 23):
Column  Porcentaje (%)
  D_87       99.930127
  D_88       99.891457
 D_108       99.476846
 D_110       99.433530
 D_111       99.433530
  D_73       98.990211
 D_134       96.480146
 D_138       96.480146
 D_137       96.480146
 D_136       96.480146
 D_135       96.480146
 D_106       90.213255
 D_132       90.191055
  D_49       90.137597
  D_76       88.746226
  D_66       88.730733
  D_42       85.694278
 D_142       82.926577
  D_53       73.842921
  D_82       73.373406
  D_50       56.809723
 D_105       54.622756
  D_56       54.071581

Spend Variables - Columnas con más del 50% de datos faltantes (Total: 1):
Column  Porcentaje (%)
   S_9       53.035686

Payment Variables - No hay columnas con más del 50% de datos faltantes.

Balance Variables - Columnas con más del 50% de datos faltantes (Total: 4):
Column  Porcentaje (%)
  B_39       99.391986
  B_42       98.707789
  B_29       93.104594
  B_17       56.722874

Risk Variables - Columnas con más del 50% de datos faltantes (Total: 2):
Column  Porcentaje (%)
   R_9       94.349891
  R_26       88.984717
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Visualización</span> <span class="pre">de</span> <span class="pre">datos</span> <span class="pre">faltants</span></code></p>
<p>Para observar visualmente la concentración de datos faltantes, se realiza una matriz o gráfica de datos faltantes y observar la distribución de los mismos por grupo de división. Posterior a ello, analizaremos si hay alguna relación entre los datos faltantes de cada grupo mediante un gràfico de violín y finalmente con base a la literatura <code class="docutils literal notranslate"><span class="pre">(Rubin,</span> <span class="pre">1987)</span></code> se eliminarán los datos con una proporción de datos faltantes igual o superior al 55% y se mostrará un resumen comparativo de dicha eliminación.</p>
</section>
<section id="matriz-de-datos-faltantes-por-grupo">
<h2>Matriz de datos faltantes por grupo<a class="headerlink" href="#matriz-de-datos-faltantes-por-grupo" title="Link to this heading">#</a></h2>
<p>Para observar la tendencia de los datos faltantes por en cada variable, se gráficará una matriz por grupo que permita identificar si los datos faltantes de cada columna se presenta en la misma observación o en observaciones diferentes, especialmente en los datos que poseen similar distribución de ausencia de datos.</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Delinquency:</span></code> Los valores faltantes en amarillo y los presentes en morado. Se observa que las variables hacia el centro y el extremo derecho presentan una mayor cantidad de datos faltantes, lo que podría sugerir una posible correlación estructural entre las variables que comparten datos faltantes. Por ejemplo, grupos de variables parecen tener una tendencia similar en términos de la proporción de valores faltantes, lo que sugiere que estos valores podrían estar asociados a ciertos eventos o características comunes en los registros.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Spend:</span></code> La gráfica evidencia una concentración significativa de datos faltantes en las primeras variables (0 a 5), donde gran parte de las observaciones tiene vacíos (en amarillo). A partir de la variable 6, se nota una ausencia casi completa de datos faltantes, lo que sugiere que ciertas variables están mucho más completas que otras. Este patrón indica que las variables con mayor cantidad de datos faltantes podrían compartir características o eventos que afectan su registro, mientras que las variables posteriores muestran una mayor consistencia.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Payment:</span></code> Se observa una distribución homogénea de los datos faltantes en las tres variables del conjunto de “Payment”. Las líneas amarillas, que representan los valores faltantes, están presentes de manera esporádica a lo largo de las observaciones, pero la mayor parte de los datos está completa (en morado). No se observa una concentración significativa de datos faltantes en ningún rango de observaciones en particular, lo que indica que los faltantes podrían estar distribuidos de forma relativamente uniforme. Este patrón sugiere que no hay una clara correlación entre las observaciones respecto a los valores faltantes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Balance:</span></code> Se observa que los datos faltantes se concentran principalmente en las columnas 15, 28, y en las últimas columnas del gráfico (35 a 39) lo que sugiere que la distribución de los valores faltantes está agrupada en ciertas variables clave.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Risk:</span></code> La matriz de Risk presenta que los datos faltantes están fuertemente concentrados en las columnas 7 y 24-26 con una relació o distribución aparente. La columna 7 destaca por tener una gran cantidad de valores faltantes a lo largo de todas las observaciones. De forma similar, las últimas columnas también presentan un patrón constante de valores faltantes. El resto de las columnas (0-6 y 8-23) muestran pocos o ningún dato faltante, indicando que la mayoría de las variables en este grupo están completas.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Crear una matriz de datos faltantes (True = faltante, False = no faltante)</span>
<span class="n">missing_matrix</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>

<span class="c1"># Función para mostrar la matriz de calor de datos faltantes</span>
<span class="k">def</span> <span class="nf">plot_missing_heatmap</span><span class="p">(</span><span class="n">group_columns</span><span class="p">,</span> <span class="n">group_name</span><span class="p">):</span>
    <span class="n">group_df</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">group_columns</span><span class="p">]</span>  <span class="c1"># Filtrar las columnas del grupo</span>
    <span class="k">if</span> <span class="n">group_df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>  <span class="c1"># Solo graficar si hay datos faltantes</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">group_df</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Matriz de Datos Faltantes - </span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Variables&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2"> - No hay datos faltantes para graficar.&quot;</span><span class="p">)</span>

<span class="c1"># Mostrar la matriz de calor para cada grupo</span>
<span class="n">plot_missing_heatmap</span><span class="p">(</span><span class="n">delinquency_columns</span><span class="p">,</span> <span class="s2">&quot;Delinquency Variables&quot;</span><span class="p">)</span>
<span class="n">plot_missing_heatmap</span><span class="p">(</span><span class="n">spend_columns</span><span class="p">,</span> <span class="s2">&quot;Spend Variables&quot;</span><span class="p">)</span>
<span class="n">plot_missing_heatmap</span><span class="p">(</span><span class="n">payment_columns</span><span class="p">,</span> <span class="s2">&quot;Payment Variables&quot;</span><span class="p">)</span>
<span class="n">plot_missing_heatmap</span><span class="p">(</span><span class="n">balance_columns</span><span class="p">,</span> <span class="s2">&quot;Balance Variables&quot;</span><span class="p">)</span>
<span class="n">plot_missing_heatmap</span><span class="p">(</span><span class="n">risk_columns</span><span class="p">,</span> <span class="s2">&quot;Risk Variables&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c9dec3e245382813089b36e3aea533ef23b26d6079711cd367307235890927bd.png" src="_images/c9dec3e245382813089b36e3aea533ef23b26d6079711cd367307235890927bd.png" />
<img alt="_images/fd296e0dd9e38f3993fa9b922932f66ead967ba1351bd8cfd43bf6e268df7822.png" src="_images/fd296e0dd9e38f3993fa9b922932f66ead967ba1351bd8cfd43bf6e268df7822.png" />
<img alt="_images/50098c123001ccf0144b35fe57ce5a7ec612db2713e8a592b973503805d95930.png" src="_images/50098c123001ccf0144b35fe57ce5a7ec612db2713e8a592b973503805d95930.png" />
<img alt="_images/542fafe323004bb931c4a29bf3a97d283c2bf900b58ff4596a5a28aafd088af4.png" src="_images/542fafe323004bb931c4a29bf3a97d283c2bf900b58ff4596a5a28aafd088af4.png" />
<img alt="_images/0b21070c3c585130669ac7e68646e67e2ab7cf1f843635cd505772df7c723819.png" src="_images/0b21070c3c585130669ac7e68646e67e2ab7cf1f843635cd505772df7c723819.png" />
</div>
</div>
</section>
<section id="top-10-variables-faltantes-por-grupo">
<h2>Top 10 Variables faltantes por grupo<a class="headerlink" href="#top-10-variables-faltantes-por-grupo" title="Link to this heading">#</a></h2>
<p>Para poder observar si los grupos de cada variable poseen una distribución similar gráficamos un ranking para cada grupo de variables.</p>
<p>Se presentan los isguientes hallazgos:</p>
<ul class="simple">
<li><p>Para el grupo Delinquency existen 10 variables cuya proporción de datos faltantes está por encima del 95%</p></li>
<li><p>Para el grupo Spend, existen 4 variables por encima del 20% de datos faltantes con posibilidad de imputación, y una de las cuales está por encima del 50%.</p></li>
<li><p>El grupo de Payment posee 2 variables con menos del 6% de datos faltantes, lo que sugiere robustes al momento de capturarla o recuoerarla.</p></li>
<li><p>El grupo de Balance posee 1 variable superior al 50% de datos faltantes y 3 por encima del 98% de datos faltantes, estas ùltimas sugieren una relación entre la distribución de ausencia.</p></li>
<li><p>Para el grupo de Risk hay dos variables por encima del 85% En datos faltantes.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Función para graficar los datos faltantes por grupo con el top 10 de columnas</span>
<span class="k">def</span> <span class="nf">plot_missing_by_group_interactive</span><span class="p">(</span><span class="n">group_columns</span><span class="p">,</span> <span class="n">group_name</span><span class="p">):</span>
    <span class="n">group_df</span> <span class="o">=</span> <span class="n">missing_data_summary</span><span class="p">[</span><span class="n">missing_data_summary</span><span class="p">[</span><span class="s1">&#39;Column&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">group_columns</span><span class="p">)]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">group_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>  <span class="c1"># Solo graficar si el grupo tiene columnas</span>
        <span class="c1"># Ordenar por porcentaje de datos faltantes y tomar el top 10</span>
        <span class="n">top_10_group_df</span> <span class="o">=</span> <span class="n">group_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Porcentaje (%)&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

        <span class="c1"># Crear el gráfico de barras interactivo con Plotly</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">top_10_group_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Column&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Porcentaje (%)&#39;</span><span class="p">,</span>
                     <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Top 10 Variables con Datos Faltantes en </span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                     <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Porcentaje (%)&#39;</span><span class="p">:</span> <span class="s1">&#39;Porcentaje de Datos Faltantes (%)&#39;</span><span class="p">,</span> <span class="s1">&#39;Column&#39;</span><span class="p">:</span> <span class="s1">&#39;Variables&#39;</span><span class="p">},</span>
                     <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

        <span class="c1"># Personalizar el gráfico</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">xaxis_tickangle</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span>  <span class="c1"># Rotar etiquetas de columnas</span>
            <span class="n">template</span><span class="o">=</span><span class="s1">&#39;plotly_dark&#39;</span><span class="p">,</span>  <span class="c1"># Usar un tema oscuro para el gráfico</span>
            <span class="n">title_x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># Centrar el título</span>
            <span class="n">title_font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>  <span class="c1"># Ajustar tamaño del título</span>
            <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">tickfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)),</span>  <span class="c1"># Ajustar tamaño de las etiquetas en el eje Y</span>
            <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">tickfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)),</span>  <span class="c1"># Ajustar tamaño de las etiquetas en el eje X</span>
            <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>  <span class="c1"># Ajustar márgenes para mejorar la legibilidad</span>
        <span class="p">)</span>

        <span class="c1"># Mostrar el gráfico interactivo</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2"> - No hay columnas con datos faltantes para graficar.&quot;</span><span class="p">)</span>

</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Graficar los datos faltantes por cada grupo de variables</span>
<span class="n">plot_missing_by_group_interactive</span><span class="p">(</span><span class="n">delinquency_columns</span><span class="p">,</span> <span class="s2">&quot;Delinquency Variables&quot;</span><span class="p">)</span>
<span class="n">plot_missing_by_group_interactive</span><span class="p">(</span><span class="n">spend_columns</span><span class="p">,</span> <span class="s2">&quot;Spend Variables&quot;</span><span class="p">)</span>
<span class="n">plot_missing_by_group_interactive</span><span class="p">(</span><span class="n">payment_columns</span><span class="p">,</span> <span class="s2">&quot;Payment Variables&quot;</span><span class="p">)</span>
<span class="n">plot_missing_by_group_interactive</span><span class="p">(</span><span class="n">balance_columns</span><span class="p">,</span> <span class="s2">&quot;Balance Variables&quot;</span><span class="p">)</span>
<span class="n">plot_missing_by_group_interactive</span><span class="p">(</span><span class="n">risk_columns</span><span class="p">,</span> <span class="s2">&quot;Risk Variables&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="68af5e0a-326b-41e9-a61f-6e3dc7a6ed3f" class="plotly-graph-div" style="height:500px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("68af5e0a-326b-41e9-a61f-6e3dc7a6ed3f")) {                    Plotly.newPlot(                        "68af5e0a-326b-41e9-a61f-6e3dc7a6ed3f",                        [{"alignmentgroup":"True","hovertemplate":"Variables=%{x}\u003cbr\u003ePorcentaje de Datos Faltantes (%)=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"","offsetgroup":"","orientation":"v","showlegend":false,"textposition":"auto","x":["D_87","D_88","D_108","D_110","D_111","D_73","D_136","D_135","D_137","D_138"],"xaxis":"x","y":[99.93012683290515,99.891457051685,99.4768461295237,99.43353018945662,99.43353018945662,98.99021070601547,96.48014598701137,96.48014598701137,96.48014598701137,96.48014598701137],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Variables"},"tickfont":{"size":12},"tickangle":-90},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Porcentaje de Datos Faltantes (%)"},"tickfont":{"size":14}},"legend":{"tracegroupgap":0},"title":{"text":"Top 10 Variables con Datos Faltantes en Delinquency Variables","font":{"size":20},"x":0.5},"barmode":"relative","height":500,"margin":{"l":40,"r":40,"t":80,"b":120}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('68af5e0a-326b-41e9-a61f-6e3dc7a6ed3f');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div><div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="d2da971d-5bf2-4ea4-8d39-0940ec2326af" class="plotly-graph-div" style="height:500px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("d2da971d-5bf2-4ea4-8d39-0940ec2326af")) {                    Plotly.newPlot(                        "d2da971d-5bf2-4ea4-8d39-0940ec2326af",                        [{"alignmentgroup":"True","hovertemplate":"Variables=%{x}\u003cbr\u003ePorcentaje de Datos Faltantes (%)=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"","offsetgroup":"","orientation":"v","showlegend":false,"textposition":"auto","x":["S_9","S_27","S_7","S_3","S_22","S_24","S_25","S_26","S_23","S_5"],"xaxis":"x","y":[53.035686296416614,25.326718070900384,18.44984254583472,18.44984254583472,0.3439242253072476,0.3361324180581189,0.23225370702913214,0.011461730385029172,0.008044905396432147,0.0],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Variables"},"tickfont":{"size":12},"tickangle":-90},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Porcentaje de Datos Faltantes (%)"},"tickfont":{"size":14}},"legend":{"tracegroupgap":0},"title":{"text":"Top 10 Variables con Datos Faltantes en Spend Variables","font":{"size":20},"x":0.5},"barmode":"relative","height":500,"margin":{"l":40,"r":40,"t":80,"b":120}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('d2da971d-5bf2-4ea4-8d39-0940ec2326af');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div><div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="2f096fe9-9eb9-4a96-b941-6a32aa562b33" class="plotly-graph-div" style="height:500px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("2f096fe9-9eb9-4a96-b941-6a32aa562b33")) {                    Plotly.newPlot(                        "2f096fe9-9eb9-4a96-b941-6a32aa562b33",                        [{"alignmentgroup":"True","hovertemplate":"Variables=%{x}\u003cbr\u003ePorcentaje de Datos Faltantes (%)=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"","offsetgroup":"","orientation":"v","showlegend":false,"textposition":"auto","x":["P_3","P_2","P_4"],"xaxis":"x","y":[5.450504759058699,0.8313370216964772,0.0],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Variables"},"tickfont":{"size":12},"tickangle":-90},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Porcentaje de Datos Faltantes (%)"},"tickfont":{"size":14}},"legend":{"tracegroupgap":0},"title":{"text":"Top 10 Variables con Datos Faltantes en Payment Variables","font":{"size":20},"x":0.5},"barmode":"relative","height":500,"margin":{"l":40,"r":40,"t":80,"b":120}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('2f096fe9-9eb9-4a96-b941-6a32aa562b33');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div><div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="953786c6-2c4c-4e00-9787-3052f5470997" class="plotly-graph-div" style="height:500px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("953786c6-2c4c-4e00-9787-3052f5470997")) {                    Plotly.newPlot(                        "953786c6-2c4c-4e00-9787-3052f5470997",                        [{"alignmentgroup":"True","hovertemplate":"Variables=%{x}\u003cbr\u003ePorcentaje de Datos Faltantes (%)=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"","offsetgroup":"","orientation":"v","showlegend":false,"textposition":"auto","x":["B_39","B_42","B_29","B_17","B_13","B_8","B_25","B_15","B_3","B_22"],"xaxis":"x","y":[99.39198593642065,98.70778933050298,93.1045940748639,56.72287434165104,0.8952262254515135,0.40257068172528326,0.1251570338415725,0.1251570338415725,0.0364461332117016,0.0364461332117016],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Variables"},"tickfont":{"size":12},"tickangle":-90},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Porcentaje de Datos Faltantes (%)"},"tickfont":{"size":14}},"legend":{"tracegroupgap":0},"title":{"text":"Top 10 Variables con Datos Faltantes en Balance Variables","font":{"size":20},"x":0.5},"barmode":"relative","height":500,"margin":{"l":40,"r":40,"t":80,"b":120}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('953786c6-2c4c-4e00-9787-3052f5470997');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div><div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="8f9f0452-0b35-4080-a020-6ed215849417" class="plotly-graph-div" style="height:500px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("8f9f0452-0b35-4080-a020-6ed215849417")) {                    Plotly.newPlot(                        "8f9f0452-0b35-4080-a020-6ed215849417",                        [{"alignmentgroup":"True","hovertemplate":"Variables=%{x}\u003cbr\u003ePorcentaje de Datos Faltantes (%)=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"","offsetgroup":"","orientation":"v","showlegend":false,"textposition":"auto","x":["R_9","R_26","R_27","R_20","R_12","R_7","R_14","R_2","R_21","R_22"],"xaxis":"x","y":[94.34989119491432,88.98471666837507,2.3267493466000153,0.0013558829319829462,0.0010123925892139333,1.807843909310595e-05,1.807843909310595e-05,0.0,0.0,0.0],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Variables"},"tickfont":{"size":12},"tickangle":-90},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Porcentaje de Datos Faltantes (%)"},"tickfont":{"size":14}},"legend":{"tracegroupgap":0},"title":{"text":"Top 10 Variables con Datos Faltantes en Risk Variables","font":{"size":20},"x":0.5},"barmode":"relative","height":500,"margin":{"l":40,"r":40,"t":80,"b":120}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('8f9f0452-0b35-4080-a020-6ed215849417');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div></div>
</div>
</section>
<section id="comparacion-dentro-del-grupo">
<h2>Comparación dentro del grupo<a class="headerlink" href="#comparacion-dentro-del-grupo" title="Link to this heading">#</a></h2>
<p>Se desea confirmar si hay alguna relación entre la distribución interna de los porcentajes de datos faltantes para cada grupo, por lo que inicialmente se indaga sobre la normalidad de las variables  establecer cuales mètodos paranètricos o no paramétricos se debe implementr. Se inspecciona visualmente a tavés un gáfico de <code class="docutils literal notranslate"><span class="pre">quantil-quantil</span></code>, luego se aplica una prueba de normalidad Kolmogorov-Smirniv (n&gt;50) y finalmente se inspecciona</p>
<p><code class="docutils literal notranslate"><span class="pre">QQ.Plot</span></code></p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Delinquency:</span></code></p></li>
</ol>
<ul class="simple">
<li><p>La gráfica muestra una desviación significativa de la línea de normalidad. Los puntos en los extremos se separan claramente de la línea roja, lo que sugiere que los datos no siguen una distribución normal. En particular, hay una asimetría en los valores altos y bajos.</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><code class="docutils literal notranslate"><span class="pre">Balance:</span></code></p></li>
</ol>
<ul class="simple">
<li><p>En este caso, los datos muestran una gran desviación de la normalidad. Los puntos en los cuartiles extremos están muy alejados de la línea roja, especialmente hacia el final derecho, lo que indica una fuerte desviación positiva con algunos valores atípicos elevados.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p><code class="docutils literal notranslate"><span class="pre">Risk:</span></code></p></li>
</ol>
<ul class="simple">
<li><p>El Q-Q plot de las variables de “Risk” muestra que los puntos no siguen la línea de normalidad, especialmente en los extremos superiores. La curva se aleja significativamente, sugiriendo que los datos presentan una distribución no normal, con valores atípicos hacia el extremo positivo.</p></li>
</ul>
<ol class="arabic simple" start="4">
<li><p><code class="docutils literal notranslate"><span class="pre">Spend:</span></code></p></li>
</ol>
<ul class="simple">
<li><p>Similar a los anteriores, los puntos en el Q-Q plot para “Spend” también se alejan de la línea de normalidad, con mayor énfasis en los extremos, indicando una falta de normalidad en la distribución de los datos. La curva muestra una tendencia positiva significativa.</p></li>
</ul>
<ol class="arabic simple" start="5">
<li><p><code class="docutils literal notranslate"><span class="pre">Payment:</span></code></p></li>
</ol>
<ul class="simple">
<li><p>En contraste con los demás gráficos, los puntos en el Q-Q plot para “Payment” se ajustan perfectamente a la línea de normalidad. Esto sugiere que los datos de esta variable siguen una distribución muy cercana a la normal.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">qq_plot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">group_name</span><span class="p">):</span>
    <span class="c1"># Get the length of the data</span>
    <span class="n">data_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># Take a sample, but limit size to data length if smaller than 5000</span>
    <span class="n">sample_size</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">data_len</span><span class="p">,</span> <span class="mi">50000</span><span class="p">)</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">stats</span><span class="o">.</span><span class="n">probplot</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="n">plt</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Q-Q Plot para </span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Generar Q-Q plot para cada grupo</span>
<span class="n">qq_plot</span><span class="p">(</span><span class="n">delinquency_columns</span><span class="p">,</span> <span class="s2">&quot;Delinquency&quot;</span><span class="p">)</span>
<span class="n">qq_plot</span><span class="p">(</span><span class="n">balance_columns</span><span class="p">,</span> <span class="s2">&quot;Balance&quot;</span><span class="p">)</span>
<span class="n">qq_plot</span><span class="p">(</span><span class="n">risk_columns</span><span class="p">,</span> <span class="s2">&quot;Risk&quot;</span><span class="p">)</span>
<span class="n">qq_plot</span><span class="p">(</span><span class="n">spend_columns</span><span class="p">,</span> <span class="s2">&quot;Spend&quot;</span><span class="p">)</span>
<span class="n">qq_plot</span><span class="p">(</span><span class="n">payment_columns</span><span class="p">,</span> <span class="s2">&quot;Payment&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9ad4334d75615a55e79c21b4baabbe4d3c9c145df6eb586013a9975b5074de58.png" src="_images/9ad4334d75615a55e79c21b4baabbe4d3c9c145df6eb586013a9975b5074de58.png" />
<img alt="_images/c87751d1d0a04acf6ce47c8e4a86e2ffd99b74379667344e51fea5ecd1c437c1.png" src="_images/c87751d1d0a04acf6ce47c8e4a86e2ffd99b74379667344e51fea5ecd1c437c1.png" />
<img alt="_images/415aca739f756e72c18959de398a6865f76862fae4cb2d50a2a085f9ef74919f.png" src="_images/415aca739f756e72c18959de398a6865f76862fae4cb2d50a2a085f9ef74919f.png" />
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-28-e77d4eb3f20c&gt;</span> in <span class="ni">&lt;cell line: 18&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span> <span class="c1"># Generar Q-Q plot para cada grupo, iterating through column names</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span> <span class="k">for</span> <span class="n">column_name</span> <span class="ow">in</span> <span class="n">delinquency_columns</span><span class="p">:</span> <span class="c1"># iterate over delinquency columns</span>
<span class="ne">---&gt; </span><span class="mi">19</span>     <span class="n">qq_plot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">column_name</span><span class="p">,</span> <span class="s2">&quot;Delinquency&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">20</span> <span class="k">for</span> <span class="n">column_name</span> <span class="ow">in</span> <span class="n">balance_columns</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span>     <span class="n">qq_plot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">column_name</span><span class="p">,</span> <span class="s2">&quot;Balance&quot;</span><span class="p">)</span>

<span class="nn">&lt;ipython-input-28-e77d4eb3f20c&gt;</span> in <span class="ni">qq_plot</span><span class="nt">(data, column_name, group_name)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> 
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="c1"># Get the length of the data</span>
<span class="ne">----&gt; </span><span class="mi">6</span>     <span class="n">data_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">column_data</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> 
<span class="g g-Whitespace">      </span><span class="mi">8</span>     <span class="c1"># Take a sample, but limit size to data length if smaller than 5000</span>

<span class="nn">/usr/local/lib/python3.10/dist-packages/dask/dataframe/core.py</span> in <span class="ni">__len__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1009</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1010</span>             <span class="nb">len</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="s2">&quot;len&quot;</span><span class="p">,</span> <span class="n">meta</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">split_every</span><span class="o">=</span><span class="kc">False</span>
<span class="ne">-&gt; </span><span class="mi">1011</span>         <span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1012</span> 
<span class="g g-Whitespace">   </span><span class="mi">1013</span>     <span class="k">def</span> <span class="fm">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="nn">/usr/local/lib/python3.10/dist-packages/dask/base.py</span> in <span class="ni">compute</span><span class="nt">(self, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">370</span>         <span class="n">dask</span><span class="o">.</span><span class="n">compute</span>
<span class="g g-Whitespace">    </span><span class="mi">371</span>         <span class="s2">&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">372</span><span class="s2">         (result,) = compute(self, traverse=False, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">373</span><span class="s2">         return result</span>
<span class="g g-Whitespace">    </span><span class="mi">374</span><span class="s2"> </span>

<span class="nn">/usr/local/lib/python3.10/dist-packages/dask/base.py</span> in <span class="ni">compute</span><span class="nt">(traverse, optimize_graph, scheduler, get, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">658</span><span class="s2"> </span>
<span class="g g-Whitespace">    </span><span class="mi">659</span><span class="s2">     with shorten_traceback():</span>
<span class="ne">--&gt; </span><span class="mi">660</span><span class="s2">         results = schedule(dsk, keys, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">661</span><span class="s2"> </span>
<span class="nn">    662     return repack([f(r, *a) for r, (f, a)</span> in <span class="ni">zip</span><span class="nt">(results, postcomputes)])</span>

<span class="nn">/usr/lib/python3.10/queue.py</span> in <span class="ni">get</span><span class="nt">(self, block, timeout)</span>
<span class="g g-Whitespace">    </span><span class="mi">169</span><span class="s2">             elif timeout is None:</span>
<span class="g g-Whitespace">    </span><span class="mi">170</span><span class="s2">                 while not self._qsize():</span>
<span class="ne">--&gt; </span><span class="mi">171</span><span class="s2">                     self.not_empty.wait()</span>
<span class="g g-Whitespace">    </span><span class="mi">172</span><span class="s2">             elif timeout &lt; 0:</span>
<span class="g g-Whitespace">    </span><span class="mi">173</span><span class="s2">                 raise ValueError(&quot;&#39;timeout&#39; must be a non-negative number&quot;)</span>

<span class="nn">/usr/lib/python3.10/threading.py</span> in <span class="ni">wait</span><span class="nt">(self, timeout)</span>
<span class="g g-Whitespace">    </span><span class="mi">318</span><span class="s2">         try:    # restore state no matter what (e.g., KeyboardInterrupt)</span>
<span class="g g-Whitespace">    </span><span class="mi">319</span><span class="s2">             if timeout is None:</span>
<span class="ne">--&gt; </span><span class="mi">320</span><span class="s2">                 waiter.acquire()</span>
<span class="g g-Whitespace">    </span><span class="mi">321</span><span class="s2">                 gotit = True</span>
<span class="g g-Whitespace">    </span><span class="mi">322</span><span class="s2">             else:</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
</section>
<section id="prueba-de-normalidad">
<h2>Prueba de normalidad<a class="headerlink" href="#prueba-de-normalidad" title="Link to this heading">#</a></h2>
<p>De los cinco grupos de datos, solo Delinquency y Balance muestran una clara evidencia de que NO siguen una distribución normal, mientras que Risk, Spend y Payment parecen seguir una distribución normal, con p-valores mayores a 0.05.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Crear los DataFrames filtrados por cada grupo de columnas seleccionadas</span>
<span class="n">delinquency_df_filtered</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">delinquency_columns</span><span class="p">]</span>  <span class="c1"># Filtrar las columnas de &#39;Delinquency&#39;</span>
<span class="n">balance_df_filtered</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">balance_columns</span><span class="p">]</span>          <span class="c1"># Filtrar las columnas de &#39;Balance&#39;</span>
<span class="n">risk_df_filtered</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">risk_columns</span><span class="p">]</span>                <span class="c1"># Filtrar las columnas de &#39;Risk&#39;</span>
<span class="n">spend_df_filtered</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">spend_columns</span><span class="p">]</span>              <span class="c1"># Filtrar las columnas de &#39;Spend&#39;</span>
<span class="n">payment_df_filtered</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">payment_columns</span><span class="p">]</span>          <span class="c1"># Filtrar las columnas de &#39;Payment&#39;</span>

<span class="c1"># Función para calcular la proporción de datos faltantes para un conjunto de columnas</span>
<span class="k">def</span> <span class="nf">calculate_missing_proportion</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">missing_proportion</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>  <span class="c1"># Calcular el porcentaje de faltantes</span>
    <span class="k">return</span> <span class="n">missing_proportion</span>

<span class="c1"># Calcular la proporción de datos faltantes para cada grupo de columnas filtradas</span>
<span class="n">delinquency_pct</span> <span class="o">=</span> <span class="n">calculate_missing_proportion</span><span class="p">(</span><span class="n">delinquency_df_filtered</span><span class="p">)</span>
<span class="n">balance_pct</span> <span class="o">=</span> <span class="n">calculate_missing_proportion</span><span class="p">(</span><span class="n">balance_df_filtered</span><span class="p">)</span>
<span class="n">risk_pct</span> <span class="o">=</span> <span class="n">calculate_missing_proportion</span><span class="p">(</span><span class="n">risk_df_filtered</span><span class="p">)</span>
<span class="n">spend_pct</span> <span class="o">=</span> <span class="n">calculate_missing_proportion</span><span class="p">(</span><span class="n">spend_df_filtered</span><span class="p">)</span>
<span class="n">payment_pct</span> <span class="o">=</span> <span class="n">calculate_missing_proportion</span><span class="p">(</span><span class="n">payment_df_filtered</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">kstest</span>
<span class="c1"># Función para realizar la prueba de Kolmogorov-Smirnov</span>
<span class="k">def</span> <span class="nf">check_normality_ks</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">group_name</span><span class="p">):</span>
    <span class="c1"># Normalizar los datos a una distribución estándar (media 0, desviación estándar 1)</span>
    <span class="n">data_standardized</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">kstest</span><span class="p">(</span><span class="n">data_standardized</span><span class="p">,</span> <span class="s1">&#39;norm&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Prueba de Kolmogorov-Smirnov para </span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estadístico KS: </span><span class="si">{</span><span class="n">stat</span><span class="si">}</span><span class="s2">, p-valor: </span><span class="si">{</span><span class="n">p_value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Los datos de </span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2"> parecen seguir una distribución normal.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Los datos de </span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2"> NO parecen seguir una distribución normal.&quot;</span><span class="p">)</span>

<span class="c1"># Verificar normalidad usando la prueba de Kolmogorov-Smirnov para cada grupo</span>
<span class="n">check_normality_ks</span><span class="p">(</span><span class="n">delinquency_pct</span><span class="p">,</span> <span class="s2">&quot;Delinquency&quot;</span><span class="p">)</span>
<span class="n">check_normality_ks</span><span class="p">(</span><span class="n">balance_pct</span><span class="p">,</span> <span class="s2">&quot;Balance&quot;</span><span class="p">)</span>
<span class="n">check_normality_ks</span><span class="p">(</span><span class="n">risk_pct</span><span class="p">,</span> <span class="s2">&quot;Risk&quot;</span><span class="p">)</span>
<span class="n">check_normality_ks</span><span class="p">(</span><span class="n">spend_pct</span><span class="p">,</span> <span class="s2">&quot;Spend&quot;</span><span class="p">)</span>
<span class="n">check_normality_ks</span><span class="p">(</span><span class="n">payment_pct</span><span class="p">,</span> <span class="s2">&quot;Payment&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Prueba de Kolmogorov-Smirnov para Delinquency:
Estadístico KS: 0.38892192951992316, p-valor: 1.3806601630201662e-13
Los datos de Delinquency NO parecen seguir una distribución normal.

Prueba de Kolmogorov-Smirnov para Balance:
Estadístico KS: 0.5157874614177522, p-valor: 2.063325017393879e-10
Los datos de Balance NO parecen seguir una distribución normal.

Prueba de Kolmogorov-Smirnov para Risk:
Estadístico KS: 0.5034690564314298, p-valor: 4.2836639905861185e-07
Los datos de Risk NO parecen seguir una distribución normal.

Prueba de Kolmogorov-Smirnov para Spend:
Estadístico KS: 0.4658232947053126, p-valor: 0.00010723452921834826
Los datos de Spend NO parecen seguir una distribución normal.

Prueba de Kolmogorov-Smirnov para Payment:
Estadístico KS: 0.36743685762111983, p-valor: 0.684984915004008
Los datos de Payment parecen seguir una distribución normal.
</pre></div>
</div>
</div>
</div>
</section>
<section id="comparacion-entre-grupos">
<h2>Comparación entre grupos<a class="headerlink" href="#comparacion-entre-grupos" title="Link to this heading">#</a></h2>
<p>Para proceder con el proceso de eliminación de variables con más de 55% de datos faltantes se debe inspeccionar si hay una posible correlación entre el patrón de ausencia o datos faltates entre los diferentes grupos de los cuales se dividieron los datos. Si existe una correlación no se procederá a eliminar las variables de cada grupo y se inspeccionará otro método de imputación pertinente. Por el contrario, si no existe una correlación aparente, se procede a eliminar de manera separada las variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Añadir una columna que identifique el grupo basado en el prefijo de las columnas</span>
<span class="k">def</span> <span class="nf">assign_group</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Column&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;D_&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Delinquency&#39;</span>
    <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Column&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;S_&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Spend&#39;</span>
    <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Column&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;P_&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Payment&#39;</span>
    <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Column&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;B_&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Balance&#39;</span>
    <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Column&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;R_&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Risk&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;Other&#39;</span>

<span class="c1"># Añadir la columna &#39;Group&#39; al DataFrame para categorizar por prefijo</span>
<span class="n">missing_data_summary</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_data_summary</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">assign_group</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Filtramos solo las columnas que tienen algún porcentaje de datos faltantes</span>
<span class="n">filtered_data</span> <span class="o">=</span> <span class="n">missing_data_summary</span><span class="p">[</span><span class="n">missing_data_summary</span><span class="p">[</span><span class="s1">&#39;Porcentaje (%)&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Gráfico de violín para la distribución de proporción de datos faltantes entre grupos</strong></p>
<p>La gráfica muestra la distribución del porcentaje de datos faltantes en diferentes grupos de variables. El grupo Delinquency destaca por tener una mayor dispersión y concentración de datos faltantes en un rango alto, con varios puntos por encima del 50%, lo que sugiere que tiene más variables afectadas por la falta de datos. En contraste, grupos como Payment y Spend presentan porcentajes de faltantes mucho más bajos y una distribución más concentrada cerca del 0%, lo que indica menor presencia de datos faltantes.</p>
<p>La amplia variabilidad entre los grupos sugiere que los datos faltantes son independientes entre ellos y tienen patrones distintos según el grupo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Crear el gráfico de violín interactivo con Plotly</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">violin</span><span class="p">(</span><span class="n">filtered_data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Group&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Porcentaje (%)&#39;</span><span class="p">,</span>
                <span class="n">box</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Añadir una caja para mostrar estadísticos</span>
                <span class="n">points</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span>  <span class="c1"># Mostrar todos los puntos de datos</span>
                <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Distribución del Porcentaje de Datos Faltantes por Grupo&#39;</span><span class="p">)</span>

<span class="c1"># Personalizar la apariencia del gráfico</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">title_x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># Centrar el título</span>
    <span class="n">title_font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>  <span class="c1"># Ajustar tamaño del título</span>
    <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Porcentaje de Datos Faltantes (%)&#39;</span><span class="p">,</span>  <span class="c1"># Etiqueta del eje Y</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Grupo de Variables&#39;</span><span class="p">,</span>  <span class="c1"># Etiqueta del eje X</span>
    <span class="n">xaxis_tickangle</span><span class="o">=-</span><span class="mi">45</span><span class="p">,</span>  <span class="c1"># Rotar las etiquetas del eje X</span>
    <span class="n">template</span><span class="o">=</span><span class="s1">&#39;plotly_white&#39;</span><span class="p">,</span>  <span class="c1"># Usar un tema claro para el gráfico</span>
    <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">tickfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)),</span>  <span class="c1"># Ajustar tamaño de las etiquetas en el eje Y</span>
    <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">tickfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)),</span>  <span class="c1"># Ajustar tamaño de las etiquetas en el eje X</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">600</span>  <span class="c1"># Ajustar la altura del gráfico</span>
<span class="p">)</span>

<span class="c1"># Mostrar el gráfico interactivo</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="8632ad4a-9a06-485f-abad-f2965b431cc2" class="plotly-graph-div" style="height:600px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("8632ad4a-9a06-485f-abad-f2965b431cc2")) {                    Plotly.newPlot(                        "8632ad4a-9a06-485f-abad-f2965b431cc2",                        [{"alignmentgroup":"True","box":{"visible":true},"hovertemplate":"Group=%{x}\u003cbr\u003ePorcentaje (%)=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#636efa"},"name":"","offsetgroup":"","orientation":"v","points":"all","scalegroup":"True","showlegend":false,"x":["Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Balance","Delinquency","Balance","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Risk","Balance","Delinquency","Delinquency","Delinquency","Risk","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Balance","Delinquency","Delinquency","Spend","Delinquency","Delinquency","Spend","Delinquency","Spend","Spend","Delinquency","Delinquency","Delinquency","Payment","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Risk","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Balance","Payment","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Delinquency","Balance","Delinquency","Delinquency","Spend","Spend","Spend","Balance","Balance","Delinquency","Delinquency","Balance","Delinquency","Balance","Balance","Balance","Balance","Balance","Balance","Delinquency","Balance","Balance","Balance","Balance","Delinquency","Balance","Spend","Spend","Balance","Risk","Balance","Risk","Balance","Risk","Risk","Other","Balance","Balance","Risk","Other","Balance","Spend","Delinquency","Balance","Delinquency","Spend","Balance","Payment","Risk","Risk","Risk","Delinquency","Delinquency","Delinquency","Risk","Risk","Delinquency","Delinquency","Spend","Delinquency","Risk","Risk","Delinquency","Balance","Risk","Risk","Risk","Spend","Risk","Delinquency","Balance","Delinquency","Spend","Risk","Risk","Spend","Balance","Balance","Spend","Spend","Risk","Risk","Risk","Balance","Spend","Delinquency","Balance","Risk","Delinquency","Balance","Balance","Spend","Balance","Delinquency","Other","Delinquency","Balance","Risk","Risk","Balance","Spend","Risk","Balance","Spend"],"x0":" ","xaxis":"x","y":[99.93012683290515,99.891457051685,99.4768461295237,99.43353018945662,99.43353018945662,99.39198593642065,98.99021070601547,98.70778933050298,96.48014598701137,96.48014598701137,96.48014598701137,96.48014598701137,96.48014598701137,94.34989119491432,93.1045940748639,90.21325507538619,90.19105475217985,90.13759680778153,88.98471666837507,88.74622589985883,88.73073267755603,85.69427804747795,82.926577492958,73.84292114311417,73.37340600142711,56.80972316305433,56.72287434165104,54.6227563075222,54.07158085645158,53.035686296416614,45.44760497742816,29.981211078250535,25.326718070900384,21.905626570677388,18.44984254583472,18.44984254583472,13.706367461268302,12.993426137192573,10.811846656510198,5.450504759058699,4.9592593335817305,4.9592593335817305,3.9310119532831442,3.9140362989747177,3.5157682857535932,3.5157682857535932,3.340949779723259,3.1947494427773107,3.1947494427773107,3.1947494427773107,3.1947494427773107,3.1947494427773107,3.1947494427773107,3.1947494427773107,3.1947494427773107,3.1947494427773107,3.1947494427773107,3.1947494427773107,3.1947494427773107,3.1947494427773107,2.8422198804617453,2.3267493466000153,2.1118509411002644,1.9294214122117324,1.8358293330267232,1.8358293330267232,1.8358293330267232,1.8358293330267232,1.8358293330267232,1.8358293330267232,1.8358293330267232,1.8358293330267232,1.8358293330267232,1.8358293330267232,1.8358293330267232,1.7159512034003375,1.3728585862913727,0.8952262254515135,0.8313370216964772,0.7722386043011138,0.736280588944926,0.7349789413302223,0.734563137231081,0.5344528949094912,0.5344528949094912,0.5344528949094912,0.4643808649846125,0.4286036340193558,0.40257068172528326,0.39362185437419583,0.39362185437419583,0.3439242253072476,0.3361324180581189,0.23225370702913214,0.1251570338415725,0.1251570338415725,0.047907863596730764,0.0364642116507947,0.0364461332117016,0.0364461332117016,0.0364461332117016,0.0364461332117016,0.0364461332117016,0.0364461332117016,0.0364461332117016,0.0364461332117016,0.0364461332117016,0.0364461332117016,0.0364461332117016,0.0364461332117016,0.0364461332117016,0.0288712672316902,0.012474122974243104,0.011461730385029172,0.008044905396432147,0.004212276308693686,0.0013558829319829462,0.0010123925892139333,0.0010123925892139333,0.0009581572719346154,1.807843909310595e-05,1.807843909310595e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],"y0":" ","yaxis":"y","type":"violin"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Grupo de Variables"},"tickfont":{"size":12},"tickangle":-45},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Porcentaje de Datos Faltantes (%)"},"tickfont":{"size":14}},"legend":{"tracegroupgap":0},"title":{"text":"Distribuci\u00f3n del Porcentaje de Datos Faltantes por Grupo","font":{"size":20},"x":0.5},"violinmode":"group","height":600},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('8632ad4a-9a06-485f-abad-f2965b431cc2');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calcular el porcentaje promedio de datos faltantes en cada grupo</span>
<span class="n">delinquency_pct</span> <span class="o">=</span> <span class="n">filtered_data</span><span class="p">[</span><span class="n">filtered_data</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Delinquency&#39;</span><span class="p">][</span><span class="s1">&#39;Porcentaje (%)&#39;</span><span class="p">]</span>
<span class="n">balance_pct</span> <span class="o">=</span> <span class="n">filtered_data</span><span class="p">[</span><span class="n">filtered_data</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Balance&#39;</span><span class="p">][</span><span class="s1">&#39;Porcentaje (%)&#39;</span><span class="p">]</span>
<span class="n">risk_pct</span> <span class="o">=</span> <span class="n">filtered_data</span><span class="p">[</span><span class="n">filtered_data</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Risk&#39;</span><span class="p">][</span><span class="s1">&#39;Porcentaje (%)&#39;</span><span class="p">]</span>
<span class="n">spend_pct</span> <span class="o">=</span> <span class="n">filtered_data</span><span class="p">[</span><span class="n">filtered_data</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Spend&#39;</span><span class="p">][</span><span class="s1">&#39;Porcentaje (%)&#39;</span><span class="p">]</span>
<span class="n">payment_pct</span> <span class="o">=</span> <span class="n">filtered_data</span><span class="p">[</span><span class="n">filtered_data</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Payment&#39;</span><span class="p">][</span><span class="s1">&#39;Porcentaje (%)&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<section id="test-de-kruskal-wallis-para-diferencia-entre-grupos">
<h3><strong>Test de Kruskal-Wallis para diferencia entre grupos</strong><a class="headerlink" href="#test-de-kruskal-wallis-para-diferencia-entre-grupos" title="Link to this heading">#</a></h3>
<p>Resultado de Kruskal-Wallis:</p>
<ul class="simple">
<li><p><strong>Hipótesis nula (<span class="math notranslate nohighlight">\(H_0\)</span>):</strong> Las distribuciones de los diferentes grupos son iguales. No hay diferencia significativa entre las medianas de los grupos.</p></li>
<li><p><strong>Hipótesis alternativa (<span class="math notranslate nohighlight">\(H_A\)</span>):</strong>  Al menos un grupo tiene una distribución significativamente diferente. Hay diferencias significativas entre las medianas de los grupos.</p></li>
</ul>
<p>Hay una diferencia significativa en los porcentajes de datos faltantes entre los grupos (Delinquency, Balance, Risk, Spend, Payment), con un p-valor extremadamente bajo (9.21e-05).
Esto significa que las medianas de los porcentajes de datos faltantes de al menos uno de los grupos son significativamente diferentes de las de los otros grupos.
Independencia:</p>
<p>Si tus datos representan grupos independientes (por ejemplo, diferentes categorías de datos faltantes como Delinquency, Balance, etc.), entonces puedes asumir independencia.
Si las observaciones dentro de los grupos no están relacionadas entre sí ni con las observaciones de otros grupos, este supuesto se cumple.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">kruskal</span>

<span class="c1"># Realizar la prueba de Kruskal-Wallis para los diferentes grupos</span>
<span class="n">stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">kruskal</span><span class="p">(</span><span class="n">delinquency_pct</span><span class="p">,</span> <span class="n">balance_pct</span><span class="p">,</span> <span class="n">risk_pct</span><span class="p">,</span> <span class="n">spend_pct</span><span class="p">,</span> <span class="n">payment_pct</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estadístico de Kruskal-Wallis: </span><span class="si">{</span><span class="n">stat</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Valor p: </span><span class="si">{</span><span class="n">p_value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hay una diferencia significativa entre los grupos.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No hay una diferencia significativa entre los grupos.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Estadístico de Kruskal-Wallis: 54.7579407457638
Valor p: 3.6514123614843156e-11
Hay una diferencia significativa entre los grupos.
</pre></div>
</div>
</div>
</div>
</section>
<section id="tratamiento-de-datos-faltantes-por-grupo">
<h3>Tratamiento de datos faltantes por grupo<a class="headerlink" href="#tratamiento-de-datos-faltantes-por-grupo" title="Link to this heading">#</a></h3>
<p><strong>Eliminacion superior al 55%</strong></p>
<p>Se eliminaràn las columnas con un alto porcentaje de datos faltantes (&gt;55%) dado que si se imputan sesgarían las predicciones por la incertidumbre y aumento del error marginal. Se filtrarán los grupos y las variavles de cada grupo para extraer las variables con una proporción de datos faltantes superior al 55%. A continuación se presenta un resumen de las variables eliminadas por grupo y su proporción resultante:</p>
<p><em><strong>En el grupo <code class="docutils literal notranslate"><span class="pre">Delinquency</span></code>:</strong></em></p>
<ul class="simple">
<li><p>Columnas iniciales: 96</p></li>
<li><p>Columnas eliminadas: 21</p></li>
<li><p>Columnas que se mantuvieron: 75</p></li>
<li><p>Proporción de columnas eliminadas: 21.88%</p></li>
</ul>
<p><em><strong>En el grupo <code class="docutils literal notranslate"><span class="pre">Balance</span></code>:</strong></em></p>
<ul class="simple">
<li><p>Columnas iniciales: 40</p></li>
<li><p>Columnas eliminadas: 4</p></li>
<li><p>Columnas que se mantuvieron: 36</p></li>
<li><p>Proporción de columnas eliminadas: 10.00%</p></li>
</ul>
<p><em><strong>En el grupo <code class="docutils literal notranslate"><span class="pre">Risk</span></code>:</strong></em></p>
<ul class="simple">
<li><p>Columnas iniciales: 28</p></li>
<li><p>Columnas eliminadas: 2</p></li>
<li><p>Columnas que se mantuvieron: 26</p></li>
<li><p>Proporción de columnas eliminadas: 7.14%</p></li>
</ul>
<p><em><strong>En el grupo <code class="docutils literal notranslate"><span class="pre">Spend</span></code>:</strong></em></p>
<ul class="simple">
<li><p>Columnas iniciales: 21</p></li>
<li><p>Columnas eliminadas: 0</p></li>
<li><p>Columnas que se mantuvieron: 21</p></li>
<li><p>Proporción de columnas eliminadas: 0.00%</p></li>
</ul>
<p><em><strong>En el grupo <code class="docutils literal notranslate"><span class="pre">Payment</span></code>:</strong></em></p>
<ul class="simple">
<li><p>Columnas iniciales: 3</p></li>
<li><p>Columnas eliminadas: 0</p></li>
<li><p>Columnas que se mantuvieron: 3</p></li>
<li><p>Proporción de columnas eliminadas: 0.00%</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filtrar las columnas que tienen un porcentaje de datos faltantes por encima del 55%</span>
<span class="k">def</span> <span class="nf">filter_columns_above_threshold</span><span class="p">(</span><span class="n">group_columns</span><span class="p">,</span> <span class="n">group_name</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">55</span><span class="p">):</span>
    <span class="c1"># Filtrar el DataFrame por el grupo específico y por porcentaje de faltantes</span>
    <span class="n">group_df</span> <span class="o">=</span> <span class="n">filtered_data</span><span class="p">[</span><span class="n">filtered_data</span><span class="p">[</span><span class="s1">&#39;Column&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">group_columns</span><span class="p">)]</span>

    <span class="c1"># Filtrar las columnas que están por encima del umbral del 55% de faltantes</span>
    <span class="n">filtered_group_df</span> <span class="o">=</span> <span class="n">group_df</span><span class="p">[</span><span class="n">group_df</span><span class="p">[</span><span class="s1">&#39;Porcentaje (%)&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">threshold</span><span class="p">]</span>

    <span class="c1"># Mostrar las columnas eliminadas y las que quedan</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">En </span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">, se eliminaron las siguientes columnas con más del </span><span class="si">{</span><span class="n">threshold</span><span class="si">}</span><span class="s2">% de faltantes:&quot;</span><span class="p">)</span>
    <span class="n">eliminated_columns</span> <span class="o">=</span> <span class="n">group_df</span><span class="p">[</span><span class="n">group_df</span><span class="p">[</span><span class="s1">&#39;Porcentaje (%)&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">eliminated_columns</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">eliminated_columns</span><span class="p">[[</span><span class="s1">&#39;Column&#39;</span><span class="p">,</span> <span class="s1">&#39;Porcentaje (%)&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No se eliminaron columnas en </span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">filtered_group_df</span><span class="p">[</span><span class="s1">&#39;Column&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Se realiza el proceso de eliminación de variables, de las cuales permanecen unicamente las siguientes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Columnas</span> <span class="pre">de</span> <span class="pre">'Delinquency'</span> <span class="pre">que</span> <span class="pre">se</span> <span class="pre">mantienen:</span></code> [‘D_105’, ‘D_56’, ‘D_77’, ‘D_43’, ‘D_46’, ‘D_62’, ‘D_48’, ‘D_61’, ‘D_78’, ‘D_44’, ‘D_64’, ‘D_68’, ‘D_83’, ‘D_69’, ‘D_55’, ‘D_124’, ‘D_119’, ‘D_116’, ‘D_118’, ‘D_114’, ‘D_115’, ‘D_117’, ‘D_113’, ‘D_125’, ‘D_120’, ‘D_121’, ‘D_122’, ‘D_123’, ‘D_91’, ‘D_126’, ‘D_59’, ‘D_141’, ‘D_131’, ‘D_139’, ‘D_145’, ‘D_130’, ‘D_129’, ‘D_103’, ‘D_107’, ‘D_104’, ‘D_143’, ‘D_128’, ‘D_70’, ‘D_79’, ‘D_133’, ‘D_144’, ‘D_102’, ‘D_140’, ‘D_84’, ‘D_89’, ‘D_52’, ‘D_81’, ‘D_72’, ‘D_74’, ‘D_80’, ‘D_112’, ‘D_45’, ‘D_54’, ‘D_41’, ‘D_109’, ‘D_47’, ‘D_127’, ‘D_92’, ‘D_93’, ‘D_94’, ‘D_63’, ‘D_65’, ‘D_86’, ‘D_96’, ‘D_58’, ‘D_60’, ‘D_51’, ‘D_75’, ‘D_71’, ‘D_39’]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Columnas</span> <span class="pre">de</span> <span class="pre">'Balance'</span> <span class="pre">que</span> <span class="pre">se</span> <span class="pre">mantienen:</span></code> [‘B_13’, ‘B_8’, ‘B_25’, ‘B_15’, ‘B_3’, ‘B_22’, ‘B_16’, ‘B_20’, ‘B_19’, ‘B_38’, ‘B_26’, ‘B_2’, ‘B_30’, ‘B_33’, ‘B_27’, ‘B_41’, ‘B_6’, ‘B_37’, ‘B_40’, ‘B_4’, ‘B_5’, ‘B_10’, ‘B_7’, ‘B_23’, ‘B_28’, ‘B_14’, ‘B_36’, ‘B_11’, ‘B_12’, ‘B_9’, ‘B_24’, ‘B_18’, ‘B_21’, ‘B_1’, ‘B_31’, ‘B_32’]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Columnas</span> <span class="pre">de</span> <span class="pre">'Risk'</span> <span class="pre">que</span> <span class="pre">se</span> <span class="pre">mantienen:</span></code> [‘R_27’, ‘R_20’, ‘R_12’, ‘R_7’, ‘R_14’, ‘R_2’, ‘R_21’, ‘R_22’, ‘R_23’, ‘R_24’, ‘R_25’, ‘R_17’, ‘R_18’, ‘R_13’, ‘R_15’, ‘R_16’, ‘R_5’, ‘R_10’, ‘R_11’, ‘R_6’, ‘R_8’, ‘R_4’, ‘R_3’, ‘R_1’, ‘R_28’, ‘R_19’]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Columnas</span> <span class="pre">de</span> <span class="pre">'Spend'</span> <span class="pre">que</span> <span class="pre">se</span> <span class="pre">mantienen:</span></code> [‘S_9’, ‘S_27’, ‘S_7’, ‘S_3’, ‘S_22’, ‘S_24’, ‘S_25’, ‘S_26’, ‘S_23’, ‘S_5’, ‘S_15’, ‘S_18’, ‘S_11’, ‘S_16’, ‘S_17’, ‘S_6’, ‘S_12’, ‘S_8’, ‘S_13’, ‘S_19’, ‘S_20’]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Columnas</span> <span class="pre">de</span> <span class="pre">'Payment'</span> <span class="pre">que</span> <span class="pre">se</span> <span class="pre">mantienen:</span></code> [‘P_3’, ‘P_2’, ‘P_4’]</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Aplicar la función a cada grupo de columnas</span>
<span class="n">delinquency_columns_filtered</span> <span class="o">=</span> <span class="n">filter_columns_above_threshold</span><span class="p">(</span><span class="n">delinquency_columns</span><span class="p">,</span> <span class="s2">&quot;Delinquency&quot;</span><span class="p">)</span>
<span class="n">balance_columns_filtered</span> <span class="o">=</span> <span class="n">filter_columns_above_threshold</span><span class="p">(</span><span class="n">balance_columns</span><span class="p">,</span> <span class="s2">&quot;Balance&quot;</span><span class="p">)</span>
<span class="n">risk_columns_filtered</span> <span class="o">=</span> <span class="n">filter_columns_above_threshold</span><span class="p">(</span><span class="n">risk_columns</span><span class="p">,</span> <span class="s2">&quot;Risk&quot;</span><span class="p">)</span>
<span class="n">spend_columns_filtered</span> <span class="o">=</span> <span class="n">filter_columns_above_threshold</span><span class="p">(</span><span class="n">spend_columns</span><span class="p">,</span> <span class="s2">&quot;Spend&quot;</span><span class="p">)</span>
<span class="n">payment_columns_filtered</span> <span class="o">=</span> <span class="n">filter_columns_above_threshold</span><span class="p">(</span><span class="n">payment_columns</span><span class="p">,</span> <span class="s2">&quot;Payment&quot;</span><span class="p">)</span>

<span class="c1"># Mostrar los nombres de las columnas que se mantienen en cada grupo</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Columnas de &#39;Delinquency&#39; que se mantienen:&quot;</span><span class="p">,</span> <span class="n">delinquency_columns_filtered</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Columnas de &#39;Balance&#39; que se mantienen:&quot;</span><span class="p">,</span> <span class="n">balance_columns_filtered</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Columnas de &#39;Risk&#39; que se mantienen:&quot;</span><span class="p">,</span> <span class="n">risk_columns_filtered</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Columnas de &#39;Spend&#39; que se mantienen:&quot;</span><span class="p">,</span> <span class="n">spend_columns_filtered</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Columnas de &#39;Payment&#39; que se mantienen:&quot;</span><span class="p">,</span> <span class="n">payment_columns_filtered</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>En Delinquency, se eliminaron las siguientes columnas con más del 55% de faltantes:
Column  Porcentaje (%)
  D_87       99.930127
  D_88       99.891457
 D_108       99.476846
 D_110       99.433530
 D_111       99.433530
  D_73       98.990211
 D_134       96.480146
 D_138       96.480146
 D_137       96.480146
 D_136       96.480146
 D_135       96.480146
 D_106       90.213255
 D_132       90.191055
  D_49       90.137597
  D_76       88.746226
  D_66       88.730733
  D_42       85.694278
 D_142       82.926577
  D_53       73.842921
  D_82       73.373406
  D_50       56.809723

En Balance, se eliminaron las siguientes columnas con más del 55% de faltantes:
Column  Porcentaje (%)
  B_39       99.391986
  B_42       98.707789
  B_29       93.104594
  B_17       56.722874

En Risk, se eliminaron las siguientes columnas con más del 55% de faltantes:
Column  Porcentaje (%)
   R_9       94.349891
  R_26       88.984717

En Spend, se eliminaron las siguientes columnas con más del 55% de faltantes:
No se eliminaron columnas en Spend.

En Payment, se eliminaron las siguientes columnas con más del 55% de faltantes:
No se eliminaron columnas en Payment.

Columnas de &#39;Delinquency&#39; que se mantienen: [&#39;D_105&#39;, &#39;D_56&#39;, &#39;D_77&#39;, &#39;D_43&#39;, &#39;D_46&#39;, &#39;D_62&#39;, &#39;D_48&#39;, &#39;D_61&#39;, &#39;D_78&#39;, &#39;D_44&#39;, &#39;D_64&#39;, &#39;D_68&#39;, &#39;D_83&#39;, &#39;D_69&#39;, &#39;D_55&#39;, &#39;D_124&#39;, &#39;D_119&#39;, &#39;D_116&#39;, &#39;D_118&#39;, &#39;D_114&#39;, &#39;D_115&#39;, &#39;D_117&#39;, &#39;D_113&#39;, &#39;D_125&#39;, &#39;D_120&#39;, &#39;D_121&#39;, &#39;D_122&#39;, &#39;D_123&#39;, &#39;D_91&#39;, &#39;D_126&#39;, &#39;D_59&#39;, &#39;D_141&#39;, &#39;D_131&#39;, &#39;D_139&#39;, &#39;D_145&#39;, &#39;D_130&#39;, &#39;D_129&#39;, &#39;D_103&#39;, &#39;D_107&#39;, &#39;D_104&#39;, &#39;D_143&#39;, &#39;D_128&#39;, &#39;D_70&#39;, &#39;D_79&#39;, &#39;D_133&#39;, &#39;D_144&#39;, &#39;D_102&#39;, &#39;D_140&#39;, &#39;D_84&#39;, &#39;D_89&#39;, &#39;D_52&#39;, &#39;D_81&#39;, &#39;D_72&#39;, &#39;D_74&#39;, &#39;D_80&#39;, &#39;D_112&#39;, &#39;D_45&#39;, &#39;D_54&#39;, &#39;D_41&#39;, &#39;D_109&#39;, &#39;D_47&#39;, &#39;D_127&#39;, &#39;D_92&#39;, &#39;D_93&#39;, &#39;D_94&#39;, &#39;D_63&#39;, &#39;D_65&#39;, &#39;D_86&#39;, &#39;D_96&#39;, &#39;D_58&#39;, &#39;D_60&#39;, &#39;D_51&#39;, &#39;D_75&#39;, &#39;D_71&#39;, &#39;D_39&#39;]
Columnas de &#39;Balance&#39; que se mantienen: [&#39;B_13&#39;, &#39;B_8&#39;, &#39;B_25&#39;, &#39;B_15&#39;, &#39;B_3&#39;, &#39;B_22&#39;, &#39;B_16&#39;, &#39;B_20&#39;, &#39;B_19&#39;, &#39;B_38&#39;, &#39;B_26&#39;, &#39;B_2&#39;, &#39;B_30&#39;, &#39;B_33&#39;, &#39;B_27&#39;, &#39;B_41&#39;, &#39;B_6&#39;, &#39;B_37&#39;, &#39;B_40&#39;, &#39;B_4&#39;, &#39;B_5&#39;, &#39;B_10&#39;, &#39;B_7&#39;, &#39;B_23&#39;, &#39;B_28&#39;, &#39;B_14&#39;, &#39;B_36&#39;, &#39;B_11&#39;, &#39;B_12&#39;, &#39;B_9&#39;, &#39;B_24&#39;, &#39;B_18&#39;, &#39;B_21&#39;, &#39;B_1&#39;, &#39;B_31&#39;, &#39;B_32&#39;]
Columnas de &#39;Risk&#39; que se mantienen: [&#39;R_27&#39;, &#39;R_20&#39;, &#39;R_12&#39;, &#39;R_7&#39;, &#39;R_14&#39;, &#39;R_2&#39;, &#39;R_21&#39;, &#39;R_22&#39;, &#39;R_23&#39;, &#39;R_24&#39;, &#39;R_25&#39;, &#39;R_17&#39;, &#39;R_18&#39;, &#39;R_13&#39;, &#39;R_15&#39;, &#39;R_16&#39;, &#39;R_5&#39;, &#39;R_10&#39;, &#39;R_11&#39;, &#39;R_6&#39;, &#39;R_8&#39;, &#39;R_4&#39;, &#39;R_3&#39;, &#39;R_1&#39;, &#39;R_28&#39;, &#39;R_19&#39;]
Columnas de &#39;Spend&#39; que se mantienen: [&#39;S_9&#39;, &#39;S_27&#39;, &#39;S_7&#39;, &#39;S_3&#39;, &#39;S_22&#39;, &#39;S_24&#39;, &#39;S_25&#39;, &#39;S_26&#39;, &#39;S_23&#39;, &#39;S_5&#39;, &#39;S_15&#39;, &#39;S_18&#39;, &#39;S_11&#39;, &#39;S_16&#39;, &#39;S_17&#39;, &#39;S_6&#39;, &#39;S_12&#39;, &#39;S_8&#39;, &#39;S_13&#39;, &#39;S_19&#39;, &#39;S_20&#39;]
Columnas de &#39;Payment&#39; que se mantienen: [&#39;P_3&#39;, &#39;P_2&#39;, &#39;P_4&#39;]
</pre></div>
</div>
</div>
</div>
<p><strong>Proporció de eliminados</strong></p>
<p>Calculamos la proporción de datos eliminados con respecto al total de datos iniciales de cada grupo</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Función para calcular la proporción de variables eliminadas con respecto a las iniciales</span>
<span class="k">def</span> <span class="nf">calculate_proportion</span><span class="p">(</span><span class="n">initial_columns</span><span class="p">,</span> <span class="n">filtered_columns</span><span class="p">,</span> <span class="n">group_name</span><span class="p">):</span>
    <span class="n">total_initial</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial_columns</span><span class="p">)</span>  <span class="c1"># Número total de columnas iniciales</span>
    <span class="n">total_filtered</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtered_columns</span><span class="p">)</span>  <span class="c1"># Número de columnas que se mantuvieron</span>
    <span class="n">total_eliminated</span> <span class="o">=</span> <span class="n">total_initial</span> <span class="o">-</span> <span class="n">total_filtered</span>  <span class="c1"># Columnas eliminadas</span>

    <span class="c1"># Calcular la proporción de eliminadas</span>
    <span class="n">proportion_eliminated</span> <span class="o">=</span> <span class="n">total_eliminated</span> <span class="o">/</span> <span class="n">total_initial</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="c1"># Mostrar los resultados</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">En el grupo </span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Columnas iniciales: </span><span class="si">{</span><span class="n">total_initial</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Columnas eliminadas: </span><span class="si">{</span><span class="n">total_eliminated</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Columnas que se mantuvieron: </span><span class="si">{</span><span class="n">total_filtered</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Proporción de columnas eliminadas: </span><span class="si">{</span><span class="n">proportion_eliminated</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calcular y mostrar la proporción para cada grupo</span>
<span class="n">calculate_proportion</span><span class="p">(</span><span class="n">delinquency_columns</span><span class="p">,</span> <span class="n">delinquency_columns_filtered</span><span class="p">,</span> <span class="s2">&quot;Delinquency&quot;</span><span class="p">)</span>
<span class="n">calculate_proportion</span><span class="p">(</span><span class="n">balance_columns</span><span class="p">,</span> <span class="n">balance_columns_filtered</span><span class="p">,</span> <span class="s2">&quot;Balance&quot;</span><span class="p">)</span>
<span class="n">calculate_proportion</span><span class="p">(</span><span class="n">risk_columns</span><span class="p">,</span> <span class="n">risk_columns_filtered</span><span class="p">,</span> <span class="s2">&quot;Risk&quot;</span><span class="p">)</span>
<span class="n">calculate_proportion</span><span class="p">(</span><span class="n">spend_columns</span><span class="p">,</span> <span class="n">spend_columns_filtered</span><span class="p">,</span> <span class="s2">&quot;Spend&quot;</span><span class="p">)</span>
<span class="n">calculate_proportion</span><span class="p">(</span><span class="n">payment_columns</span><span class="p">,</span> <span class="n">payment_columns_filtered</span><span class="p">,</span> <span class="s2">&quot;Payment&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>En el grupo Delinquency:
- Columnas iniciales: 96
- Columnas eliminadas: 21
- Columnas que se mantuvieron: 75
- Proporción de columnas eliminadas: 21.88%

En el grupo Balance:
- Columnas iniciales: 40
- Columnas eliminadas: 4
- Columnas que se mantuvieron: 36
- Proporción de columnas eliminadas: 10.00%

En el grupo Risk:
- Columnas iniciales: 28
- Columnas eliminadas: 2
- Columnas que se mantuvieron: 26
- Proporción de columnas eliminadas: 7.14%

En el grupo Spend:
- Columnas iniciales: 21
- Columnas eliminadas: 0
- Columnas que se mantuvieron: 21
- Proporción de columnas eliminadas: 0.00%

En el grupo Payment:
- Columnas iniciales: 3
- Columnas eliminadas: 0
- Columnas que se mantuvieron: 3
- Proporción de columnas eliminadas: 0.00%
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="imputacion-de-datos-faltantes">
<h2>Imputaciòn de datos faltantes<a class="headerlink" href="#imputacion-de-datos-faltantes" title="Link to this heading">#</a></h2>
<p>Se realiza el proceso de imputación de datos para las columnas bajo el criterio mencionado de sobrepasar el 55% de datos faltantes. Inicialmente se crea un conjunto de datos con base a la columnas seleccionadas para imputar y que no poseen un alto riesgo de sesgo de predicción por su alta proporción de ausencia de datos.</p>
<p>Debido a la naturaleza de las variables, los procesos de imputación deben ser diferentes, para las variables categóricas, el proceso de imputación consistirá en imputar los datos faltantes de manera proporcional a la frecuencia de las clases codificadas y para las variables numéricas se imputará mediante el método<code class="docutils literal notranslate"> <span class="pre">Iterative</span> <span class="pre">Imputer</span></code>.</p>
<section id="identificar-variables-categoricas-previo-a-la-imputacion-de-datos">
<h3>Identificar variables categóricas previo a la imputación de datos<a class="headerlink" href="#identificar-variables-categoricas-previo-a-la-imputacion-de-datos" title="Link to this heading">#</a></h3>
<p>Para poder trabajar con todos los datos, a cada grupo de variables dividido se le agregan las columnas pivote ‘<code class="docutils literal notranslate"><span class="pre">Date</span></code>’, ‘<code class="docutils literal notranslate"><span class="pre">customer_ID</span></code>’ y ‘<code class="docutils literal notranslate"><span class="pre">target</span></code>’ con el objetivo de permitir concatenar o identificar las observaciones por separado.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create DataFrames for each group using the filtered column lists</span>
<span class="n">delinquency_df_filtered</span> <span class="o">=</span> <span class="n">delinquency_df</span><span class="p">[</span><span class="n">delinquency_columns_filtered</span><span class="p">]</span>
<span class="n">balance_df_filtered</span> <span class="o">=</span> <span class="n">balance_df</span><span class="p">[</span><span class="n">balance_columns_filtered</span><span class="p">]</span>
<span class="n">risk_df_filtered</span> <span class="o">=</span> <span class="n">risk_df</span><span class="p">[</span><span class="n">risk_columns_filtered</span><span class="p">]</span>
<span class="n">spend_df_filtered</span> <span class="o">=</span> <span class="n">spend_df</span><span class="p">[</span><span class="n">spend_columns_filtered</span><span class="p">]</span>
<span class="n">payment_df_filtered</span> <span class="o">=</span> <span class="n">payment_df</span><span class="p">[</span><span class="n">payment_columns_filtered</span><span class="p">]</span>

<span class="c1">#Agregar las variables categóricas de guia</span>
<span class="n">delinquency_df_filtered</span><span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">]</span>
<span class="n">delinquency_df_filtered</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span>
<span class="n">delinquency_df_filtered</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>

<span class="n">balance_df_filtered</span><span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">]</span>
<span class="n">balance_df_filtered</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span>
<span class="n">balance_df_filtered</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>

<span class="n">risk_df_filtered</span><span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">]</span>
<span class="n">risk_df_filtered</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span>
<span class="n">risk_df_filtered</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>

<span class="n">spend_df_filtered</span><span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">]</span>
<span class="n">spend_df_filtered</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span>
<span class="n">spend_df_filtered</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>

<span class="n">payment_df_filtered</span><span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">]</span>
<span class="n">payment_df_filtered</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span>
<span class="n">payment_df_filtered</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Filtramos o seleccionamos las variables catalogadas como categóricas en el manual de los datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Seleccionar solo las columnas categóricas y agregar customer_ID y Date como referencia</span>
<span class="n">categorical_columns_delinquency</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;D_64&#39;</span><span class="p">,</span> <span class="s1">&#39;D_68&#39;</span><span class="p">,</span> <span class="s1">&#39;D_116&#39;</span><span class="p">,</span> <span class="s1">&#39;D_114&#39;</span><span class="p">,</span> <span class="s1">&#39;D_117&#39;</span><span class="p">,</span> <span class="s1">&#39;D_120&#39;</span><span class="p">,</span> <span class="s1">&#39;D_126&#39;</span><span class="p">,</span> <span class="s1">&#39;D_63&#39;</span><span class="p">]</span>
<span class="n">categorical_columns_balance</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;B_38&#39;</span><span class="p">,</span> <span class="s1">&#39;B_30&#39;</span><span class="p">]</span>

<span class="c1"># Asegurarse de que los DataFrames están en pandas</span>
<span class="n">delinquency_df_pd</span> <span class="o">=</span> <span class="n">delinquency_df_filtered</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">balance_df_pd</span> <span class="o">=</span> <span class="n">balance_df_filtered</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

<span class="c1"># Agregar las columnas de referencia (customer_ID, Date)</span>
<span class="n">delinquency_categorical_df</span> <span class="o">=</span> <span class="n">delinquency_df_pd</span><span class="p">[</span><span class="n">categorical_columns_delinquency</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">]]</span>
<span class="n">balance_categorical_df</span> <span class="o">=</span> <span class="n">balance_df_pd</span><span class="p">[</span><span class="n">categorical_columns_balance</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Concatenar las columnas categóricas de delinquency y balance</span>
<span class="n">categorical_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">delinquency_categorical_df</span><span class="p">,</span> <span class="n">balance_categorical_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">categorical_df</span> <span class="o">=</span> <span class="n">categorical_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="o">~</span><span class="n">categorical_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>

<span class="c1"># Mostrar las primeras filas del DataFrame concatenado</span>
<span class="nb">print</span><span class="p">(</span><span class="n">categorical_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  D_64  D_68  D_116  D_114  D_117  D_120  D_126 D_63  \
0    O   6.0    0.0    1.0    4.0    0.0    1.0   CR   
1    O   6.0    0.0    1.0    4.0    0.0    1.0   CR   
2    O   6.0    0.0    1.0    4.0    0.0    1.0   CR   
3    O   6.0    0.0    1.0    4.0    0.0    1.0   CR   
4    O   6.0    0.0    1.0    4.0    0.0    1.0   CR   

                                         customer_ID        Date  B_38  B_30  
0  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-03-09   2.0   0.0  
1  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-04-07   2.0   0.0  
2  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-05-28   2.0   0.0  
3  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-06-13   2.0   0.0  
4  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-07-16   2.0   0.0  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">categorical_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(5531451, 12)
</pre></div>
</div>
</div>
</div>
<p><strong>Porcentaje de datos faltantes</strong></p>
<p>Observamos que el porcentaje de datos faltantes para nuestro conjunto de datos es inferior en la mayorpía de las variables al 4% como se muestra a continuación:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"> <span class="pre">D_64</span> <span class="pre">:3.931012%</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">D_68</span> <span class="pre">:3.914036%</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">D_116:3.194749%</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">D_114:3.194749%</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">D_117:3.194749%</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">D_120:3.194749%</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">D_126:2.111851%</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Verificar el porcentaje de datos faltantes antes de codificar</span>
<span class="n">missing_percentage_categorical</span> <span class="o">=</span> <span class="n">categorical_df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Porcentaje de datos faltantes antes de la codificación:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">missing_percentage_categorical</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Porcentaje de datos faltantes antes de la codificación:
D_64           3.931012
D_68           3.914036
D_116          3.194749
D_114          3.194749
D_117          3.194749
D_120          3.194749
D_126          2.111851
D_63           0.000000
customer_ID    0.000000
Date           0.000000
B_38           0.036446
B_30           0.036446
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Se procede a realizar un proceso de codififación <em><strong><code class="docutils literal notranslate"><span class="pre">Onehot-Encoder</span></code></strong></em> para las variables categóricas extríedas en los conjuntos de datos previo a la imputación por proporción de los datps categóricos. Se observa el conjunto de datos resultante posterior a la codificación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Excluir &#39;customer_ID&#39; y &#39;Date&#39; para la codificación, pero mantenerlas como columnas de referencia</span>
<span class="n">categorical_df_no_guides</span> <span class="o">=</span> <span class="n">categorical_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">])</span>

<span class="c1"># Convertir todos los valores a cadenas para evitar el problema de mezcla de tipos</span>
<span class="n">categorical_df_no_guides</span> <span class="o">=</span> <span class="n">categorical_df_no_guides</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

<span class="c1"># Aplicar la codificación con OneHotEncoder</span>
<span class="n">encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">handle_unknown</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">categorical_encoded</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">categorical_df_no_guides</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Missing&#39;</span><span class="p">))</span>  <span class="c1"># Reemplazar NaN con &#39;Missing&#39;</span>

<span class="c1"># Convertir a DataFrame las columnas codificadas</span>
<span class="n">categorical_encoded_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">categorical_encoded</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">encoder</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">(</span><span class="n">categorical_df_no_guides</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>

<span class="c1"># Agregar de nuevo las columnas de guía (&#39;customer_ID&#39;, &#39;Date&#39;)</span>
<span class="n">categorical_encoded_df</span><span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">categorical_df</span><span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">categorical_encoded_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">categorical_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Mostrar las primeras filas del DataFrame codificado</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DataFrame codificado con customer_ID y Date:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">categorical_encoded_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DataFrame codificado con customer_ID y Date:
   D_64_-1  D_64_&lt;NA&gt;  D_64_O  D_64_R  D_64_U  D_68_0.0  D_68_1.0  D_68_2.0  \
0      0.0        0.0     1.0     0.0     0.0       0.0       0.0       0.0   
1      0.0        0.0     1.0     0.0     0.0       0.0       0.0       0.0   
2      0.0        0.0     1.0     0.0     0.0       0.0       0.0       0.0   
3      0.0        0.0     1.0     0.0     0.0       0.0       0.0       0.0   
4      0.0        0.0     1.0     0.0     0.0       0.0       0.0       0.0   

   D_68_3.0  D_68_4.0  ...  B_38_5.0  B_38_6.0  B_38_7.0  B_38_nan  B_30_0.0  \
0       0.0       0.0  ...       0.0       0.0       0.0       0.0       1.0   
1       0.0       0.0  ...       0.0       0.0       0.0       0.0       1.0   
2       0.0       0.0  ...       0.0       0.0       0.0       0.0       1.0   
3       0.0       0.0  ...       0.0       0.0       0.0       0.0       1.0   
4       0.0       0.0  ...       0.0       0.0       0.0       0.0       1.0   

   B_30_1.0  B_30_2.0  B_30_nan  \
0       0.0       0.0       0.0   
1       0.0       0.0       0.0   
2       0.0       0.0       0.0   
3       0.0       0.0       0.0   
4       0.0       0.0       0.0   

                                         customer_ID        Date  
0  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-03-09  
1  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-04-07  
2  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-05-28  
3  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-06-13  
4  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-07-16  

[5 rows x 54 columns]
</pre></div>
</div>
</div>
</div>
<p>Obtenemos alrededor de 52 columnas o variables a imputar posterior a la codificación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">categorical_encoded_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;D_64_-1&#39;, &#39;D_64_&lt;NA&gt;&#39;, &#39;D_64_O&#39;, &#39;D_64_R&#39;, &#39;D_64_U&#39;, &#39;D_68_0.0&#39;,
       &#39;D_68_1.0&#39;, &#39;D_68_2.0&#39;, &#39;D_68_3.0&#39;, &#39;D_68_4.0&#39;, &#39;D_68_5.0&#39;, &#39;D_68_6.0&#39;,
       &#39;D_68_nan&#39;, &#39;D_116_0.0&#39;, &#39;D_116_1.0&#39;, &#39;D_116_nan&#39;, &#39;D_114_0.0&#39;,
       &#39;D_114_1.0&#39;, &#39;D_114_nan&#39;, &#39;D_117_-1.0&#39;, &#39;D_117_1.0&#39;, &#39;D_117_2.0&#39;,
       &#39;D_117_3.0&#39;, &#39;D_117_4.0&#39;, &#39;D_117_5.0&#39;, &#39;D_117_6.0&#39;, &#39;D_117_nan&#39;,
       &#39;D_120_0.0&#39;, &#39;D_120_1.0&#39;, &#39;D_120_nan&#39;, &#39;D_126_-1.0&#39;, &#39;D_126_0.0&#39;,
       &#39;D_126_1.0&#39;, &#39;D_126_nan&#39;, &#39;D_63_CL&#39;, &#39;D_63_CO&#39;, &#39;D_63_CR&#39;, &#39;D_63_XL&#39;,
       &#39;D_63_XM&#39;, &#39;D_63_XZ&#39;, &#39;B_38_1.0&#39;, &#39;B_38_2.0&#39;, &#39;B_38_3.0&#39;, &#39;B_38_4.0&#39;,
       &#39;B_38_5.0&#39;, &#39;B_38_6.0&#39;, &#39;B_38_7.0&#39;, &#39;B_38_nan&#39;, &#39;B_30_0.0&#39;, &#39;B_30_1.0&#39;,
       &#39;B_30_2.0&#39;, &#39;B_30_nan&#39;, &#39;customer_ID&#39;, &#39;Date&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
</section>
<section id="imputacion-de-datos-categoricos">
<h3>Imputacion de datos categoricos<a class="headerlink" href="#imputacion-de-datos-categoricos" title="Link to this heading">#</a></h3>
<p><strong><code class="docutils literal notranslate"><span class="pre">Método</span> <span class="pre">de</span> <span class="pre">proporción</span> <span class="pre">de</span> <span class="pre">frecuencias</span></code></strong></p>
<p>Dado que los datos faltantes categóricos no superan el 5% en el peor de los casos, se propone la imputación para dichas variables a través de el método de frecuencias, consiste en calcular las frecuencias de aparicion de las clases o variables categóricas, organizarlas internamente por variables e imputar los datos con base a dicha frecuencia de ocurrencia.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Función para imputar valores faltantes en variables categóricas según su distribución</span>
<span class="k">def</span> <span class="nf">impute_proportional</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
    <span class="c1"># Calcular las frecuencias relativas de los valores no nulos</span>
    <span class="n">frequencies</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Función para aplicar la imputación</span>
    <span class="k">def</span> <span class="nf">fill_na</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">frequencies</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">frequencies</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">row</span>

    <span class="c1"># Aplicar la función a la columna</span>
    <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">fill_na</span><span class="p">)</span>

<span class="c1"># Aplicar la imputación proporcional a las columnas categóricas</span>
<span class="n">categorical_columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;D_64_-1&#39;</span><span class="p">,</span> <span class="s1">&#39;D_64_&lt;NA&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;D_64_O&#39;</span><span class="p">,</span> <span class="s1">&#39;D_64_R&#39;</span><span class="p">,</span> <span class="s1">&#39;D_64_U&#39;</span><span class="p">,</span> <span class="s1">&#39;D_68_0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_68_1.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;D_68_2.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_68_3.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_68_4.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_116_0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_116_1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_117_-1.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;D_117_1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_117_2.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_117_3.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_120_0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_120_1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_63_CL&#39;</span><span class="p">,</span>
    <span class="s1">&#39;D_63_CO&#39;</span><span class="p">,</span> <span class="s1">&#39;B_38_1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;B_38_2.0&#39;</span><span class="p">,</span> <span class="s1">&#39;B_30_0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;B_30_1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span>
<span class="p">]</span>
<span class="c1"># Imputar cada columna categórica proporcionalmente</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">categorical_columns</span><span class="p">:</span>
    <span class="n">impute_proportional</span><span class="p">(</span><span class="n">categorical_encoded_df</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>

<span class="c1"># Mostrar los primeros registros del DataFrame con imputación proporcional</span>
<span class="nb">print</span><span class="p">(</span><span class="n">categorical_encoded_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   D_64_-1  D_64_&lt;NA&gt;  D_64_O  D_64_R  D_64_U  D_68_0.0  D_68_1.0  D_68_2.0  \
0      0.0        0.0     1.0     0.0     0.0       0.0       0.0       0.0   
1      0.0        0.0     1.0     0.0     0.0       0.0       0.0       0.0   
2      0.0        0.0     1.0     0.0     0.0       0.0       0.0       0.0   
3      0.0        0.0     1.0     0.0     0.0       0.0       0.0       0.0   
4      0.0        0.0     1.0     0.0     0.0       0.0       0.0       0.0   

   D_68_3.0  D_68_4.0  ...  B_38_5.0  B_38_6.0  B_38_7.0  B_38_nan  B_30_0.0  \
0       0.0       0.0  ...       0.0       0.0       0.0       0.0       1.0   
1       0.0       0.0  ...       0.0       0.0       0.0       0.0       1.0   
2       0.0       0.0  ...       0.0       0.0       0.0       0.0       1.0   
3       0.0       0.0  ...       0.0       0.0       0.0       0.0       1.0   
4       0.0       0.0  ...       0.0       0.0       0.0       0.0       1.0   

   B_30_1.0  B_30_2.0  B_30_nan  \
0       0.0       0.0       0.0   
1       0.0       0.0       0.0   
2       0.0       0.0       0.0   
3       0.0       0.0       0.0   
4       0.0       0.0       0.0   

                                         customer_ID        Date  
0  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-03-09  
1  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-04-07  
2  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-05-28  
3  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-06-13  
4  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-07-16  

[5 rows x 54 columns]
</pre></div>
</div>
</div>
</div>
<p>Se le agregan las variables ‘<code class="docutils literal notranslate"><span class="pre">target</span></code>’, ‘<code class="docutils literal notranslate"><span class="pre">customer_ID</span></code>’ y ‘<code class="docutils literal notranslate"><span class="pre">Date</span></code>’ para matener la guia de los individuos de manera independiente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convertir &#39;data&#39; de Dask a Pandas, pero solo las columnas necesarias</span>
<span class="n">data_pd</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

<span class="c1"># Hacer el merge basado en &#39;customer_ID&#39; para agregar la columna &#39;target&#39; a &#39;categorical_encoded_df&#39;</span>
<span class="n">final_categorical_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">categorical_encoded_df</span><span class="p">,</span> <span class="n">data_pd</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Verificar que la columna &#39;target&#39; se haya agregado correctamente</span>
<span class="nb">print</span><span class="p">(</span><span class="n">final_categorical_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   D_64_-1  D_64_&lt;NA&gt;  D_64_O  D_64_R  D_64_U  D_68_0.0  D_68_1.0  D_68_2.0  \
0      0.0        0.0     1.0     0.0     0.0       0.0       0.0       0.0   
1      0.0        0.0     1.0     0.0     0.0       0.0       0.0       0.0   
2      0.0        0.0     1.0     0.0     0.0       0.0       0.0       0.0   
3      0.0        0.0     1.0     0.0     0.0       0.0       0.0       0.0   
4      0.0        0.0     1.0     0.0     0.0       0.0       0.0       0.0   

   D_68_3.0  D_68_4.0  ...  B_38_6.0  B_38_7.0  B_38_nan  B_30_0.0  B_30_1.0  \
0       0.0       0.0  ...       0.0       0.0       0.0       1.0       0.0   
1       0.0       0.0  ...       0.0       0.0       0.0       1.0       0.0   
2       0.0       0.0  ...       0.0       0.0       0.0       1.0       0.0   
3       0.0       0.0  ...       0.0       0.0       0.0       1.0       0.0   
4       0.0       0.0  ...       0.0       0.0       0.0       1.0       0.0   

   B_30_2.0  B_30_nan                                        customer_ID  \
0       0.0       0.0  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...   
1       0.0       0.0  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...   
2       0.0       0.0  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...   
3       0.0       0.0  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...   
4       0.0       0.0  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...   

         Date  target  
0  2017-03-09       0  
1  2017-03-09       0  
2  2017-03-09       0  
3  2017-03-09       0  
4  2017-03-09       0  

[5 rows x 55 columns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">final_categorical_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;D_64_-1&#39;, &#39;D_64_&lt;NA&gt;&#39;, &#39;D_64_O&#39;, &#39;D_64_R&#39;, &#39;D_64_U&#39;, &#39;D_68_0.0&#39;,
       &#39;D_68_1.0&#39;, &#39;D_68_2.0&#39;, &#39;D_68_3.0&#39;, &#39;D_68_4.0&#39;, &#39;D_68_5.0&#39;, &#39;D_68_6.0&#39;,
       &#39;D_68_nan&#39;, &#39;D_116_0.0&#39;, &#39;D_116_1.0&#39;, &#39;D_116_nan&#39;, &#39;D_114_0.0&#39;,
       &#39;D_114_1.0&#39;, &#39;D_114_nan&#39;, &#39;D_117_-1.0&#39;, &#39;D_117_1.0&#39;, &#39;D_117_2.0&#39;,
       &#39;D_117_3.0&#39;, &#39;D_117_4.0&#39;, &#39;D_117_5.0&#39;, &#39;D_117_6.0&#39;, &#39;D_117_nan&#39;,
       &#39;D_120_0.0&#39;, &#39;D_120_1.0&#39;, &#39;D_120_nan&#39;, &#39;D_126_-1.0&#39;, &#39;D_126_0.0&#39;,
       &#39;D_126_1.0&#39;, &#39;D_126_nan&#39;, &#39;D_63_CL&#39;, &#39;D_63_CO&#39;, &#39;D_63_CR&#39;, &#39;D_63_XL&#39;,
       &#39;D_63_XM&#39;, &#39;D_63_XZ&#39;, &#39;B_38_1.0&#39;, &#39;B_38_2.0&#39;, &#39;B_38_3.0&#39;, &#39;B_38_4.0&#39;,
       &#39;B_38_5.0&#39;, &#39;B_38_6.0&#39;, &#39;B_38_7.0&#39;, &#39;B_38_nan&#39;, &#39;B_30_0.0&#39;, &#39;B_30_1.0&#39;,
       &#39;B_30_2.0&#39;, &#39;B_30_nan&#39;, &#39;customer_ID&#39;, &#39;Date&#39;, &#39;target&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>Finalmente reorganizamos el conjunto de datos imputado, posterior a haber imputado is valores para las variables categóricas codificadas, concatenamos o agrupamos por grupo de variables ada una y la empaquetamos en el conjunto de datos final</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">columns_to_revert</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;D_64&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D_64_-1&#39;</span><span class="p">,</span> <span class="s1">&#39;D_64_&lt;NA&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;D_64_O&#39;</span><span class="p">,</span> <span class="s1">&#39;D_64_R&#39;</span><span class="p">,</span> <span class="s1">&#39;D_64_U&#39;</span><span class="p">],</span>
    <span class="s1">&#39;D_68&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D_68_0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_68_1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_68_2.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_68_3.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_68_4.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_68_5.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_68_6.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_68_nan&#39;</span><span class="p">],</span>
    <span class="s1">&#39;D_116&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D_116_0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_116_1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_116_nan&#39;</span><span class="p">],</span>
    <span class="s1">&#39;D_114&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D_114_0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_114_1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_114_nan&#39;</span><span class="p">],</span>
    <span class="s1">&#39;D_117&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D_117_-1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_117_1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_117_2.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_117_3.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_117_4.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_117_5.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_117_6.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_117_nan&#39;</span><span class="p">],</span>
    <span class="s1">&#39;D_120&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D_120_0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_120_1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_120_nan&#39;</span><span class="p">],</span>
    <span class="s1">&#39;D_126&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D_126_-1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_126_0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_126_1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_126_nan&#39;</span><span class="p">],</span>
    <span class="s1">&#39;D_63&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D_63_CL&#39;</span><span class="p">,</span> <span class="s1">&#39;D_63_CO&#39;</span><span class="p">,</span> <span class="s1">&#39;D_63_CR&#39;</span><span class="p">,</span> <span class="s1">&#39;D_63_XL&#39;</span><span class="p">,</span> <span class="s1">&#39;D_63_XM&#39;</span><span class="p">,</span> <span class="s1">&#39;D_63_XZ&#39;</span><span class="p">],</span>
    <span class="s1">&#39;B_38&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B_38_1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;B_38_2.0&#39;</span><span class="p">,</span> <span class="s1">&#39;B_38_3.0&#39;</span><span class="p">,</span> <span class="s1">&#39;B_38_4.0&#39;</span><span class="p">,</span> <span class="s1">&#39;B_38_5.0&#39;</span><span class="p">,</span> <span class="s1">&#39;B_38_6.0&#39;</span><span class="p">,</span> <span class="s1">&#39;B_38_7.0&#39;</span><span class="p">,</span> <span class="s1">&#39;B_38_nan&#39;</span><span class="p">],</span>
    <span class="s1">&#39;B_30&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B_30_0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;B_30_1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;B_30_2.0&#39;</span><span class="p">,</span> <span class="s1">&#39;B_30_nan&#39;</span><span class="p">]</span>
<span class="p">}</span>

<span class="c1"># Función para revertir One-Hot Encoding a una columna original</span>
<span class="k">def</span> <span class="nf">revert_one_hot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">original_col_name</span><span class="p">,</span> <span class="n">one_hot_columns</span><span class="p">):</span>
    <span class="c1"># Encontrar la categoría para cada fila</span>
    <span class="n">df</span><span class="p">[</span><span class="n">original_col_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">one_hot_columns</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">original_col_name</span><span class="si">}</span><span class="s1">_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="c1"># Eliminar las columnas codificadas</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">one_hot_columns</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="c1"># Aplicar la función a cada variable categórica</span>
<span class="k">for</span> <span class="n">original_col</span><span class="p">,</span> <span class="n">one_hot_cols</span> <span class="ow">in</span> <span class="n">columns_to_revert</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">categorical_encoded_df</span> <span class="o">=</span> <span class="n">revert_one_hot</span><span class="p">(</span><span class="n">categorical_encoded_df</span><span class="p">,</span> <span class="n">original_col</span><span class="p">,</span> <span class="n">one_hot_cols</span><span class="p">)</span>

<span class="c1"># Mostrar el DataFrame final con las columnas revertidas</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DataFrame con columnas originales reconstruidas:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">categorical_encoded_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DataFrame con columnas originales reconstruidas:
                                         customer_ID        Date D_64 D_68  \
0  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-03-09    O  6.0   
1  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-04-07    O  6.0   
2  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-05-28    O  6.0   
3  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-06-13    O  6.0   
4  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-07-16    O  6.0   

  D_116 D_114 D_117 D_120 D_126 D_63 B_38 B_30  
0   0.0   1.0   4.0   0.0   1.0   CR  2.0  0.0  
1   0.0   1.0   4.0   0.0   1.0   CR  2.0  0.0  
2   0.0   1.0   4.0   0.0   1.0   CR  2.0  0.0  
3   0.0   1.0   4.0   0.0   1.0   CR  2.0  0.0  
4   0.0   1.0   4.0   0.0   1.0   CR  2.0  0.0  
</pre></div>
</div>
</div>
</div>
</section>
<section id="imputacion-de-variables-numericas">
<h3>Imputación de variables numéricas<a class="headerlink" href="#imputacion-de-variables-numericas" title="Link to this heading">#</a></h3>
<p>Para realizar el proceso de imputación para variables numéricas, debemos identificar, filtrar y eliminar del conjunto de datos por grupo las variables categóricas, dado que el método de imputación <code class="docutils literal notranslate"><span class="pre">Iterative</span> <span class="pre">Imputer</span></code>, es unicamente valido y funcional para variables <code class="docutils literal notranslate"><span class="pre">numéricas</span></code>. Cuando se ha identificado las variables no numéricas, se procede a extraerlas y eliminalas del conjunto de datos por grupo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Función para eliminar columnas categóricas de los DataFrames</span>
<span class="k">def</span> <span class="nf">remove_categorical_columns</span><span class="p">(</span><span class="n">df_filtered</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">df_filtered</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_filtered</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">categorical_columns</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">categorical_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;D_64&#39;</span><span class="p">,</span> <span class="s1">&#39;D_68&#39;</span><span class="p">,</span> <span class="s1">&#39;D_116&#39;</span><span class="p">,</span> <span class="s1">&#39;D_114&#39;</span><span class="p">,</span> <span class="s1">&#39;D_117&#39;</span><span class="p">,</span> <span class="s1">&#39;D_120&#39;</span><span class="p">,</span> <span class="s1">&#39;D_126&#39;</span><span class="p">,</span> <span class="s1">&#39;D_63&#39;</span><span class="p">,</span> <span class="s1">&#39;B_38&#39;</span><span class="p">,</span> <span class="s1">&#39;B_30&#39;</span><span class="p">,</span> <span class="s1">&#39;Customer_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">]</span>

<span class="c1"># Verificar qué columnas categóricas permanecen en cada DataFrame filtrado</span>
<span class="k">def</span> <span class="nf">check_categorical_columns</span><span class="p">(</span><span class="n">df_filtered</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_filtered</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">categorical_columns</span><span class="p">]</span>

<span class="c1"># Chequear para cada grupo de DataFrame</span>
<span class="n">delinquency_categorical</span> <span class="o">=</span> <span class="n">check_categorical_columns</span><span class="p">(</span><span class="n">delinquency_df_filtered</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">)</span>
<span class="n">balance_categorical</span> <span class="o">=</span> <span class="n">check_categorical_columns</span><span class="p">(</span><span class="n">balance_df_filtered</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">)</span>
<span class="n">risk_categorical</span> <span class="o">=</span> <span class="n">check_categorical_columns</span><span class="p">(</span><span class="n">risk_df_filtered</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">)</span>
<span class="n">spend_categorical</span> <span class="o">=</span> <span class="n">check_categorical_columns</span><span class="p">(</span><span class="n">spend_df_filtered</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">)</span>
<span class="n">payment_categorical</span> <span class="o">=</span> <span class="n">check_categorical_columns</span><span class="p">(</span><span class="n">payment_df_filtered</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imprimir resultados</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Categorical columns in Delinquency:&quot;</span><span class="p">,</span> <span class="n">delinquency_categorical</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Categorical columns in Balance:&quot;</span><span class="p">,</span> <span class="n">balance_categorical</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Categorical columns in Risk:&quot;</span><span class="p">,</span> <span class="n">risk_categorical</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Categorical columns in Spend:&quot;</span><span class="p">,</span> <span class="n">spend_categorical</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Categorical columns in Payment:&quot;</span><span class="p">,</span> <span class="n">payment_categorical</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Categorical columns in Delinquency: [&#39;D_64&#39;, &#39;D_68&#39;, &#39;D_116&#39;, &#39;D_114&#39;, &#39;D_117&#39;, &#39;D_120&#39;, &#39;D_126&#39;, &#39;D_63&#39;, &#39;Date&#39;]
Categorical columns in Balance: [&#39;B_38&#39;, &#39;B_30&#39;, &#39;Date&#39;]
Categorical columns in Risk: [&#39;Date&#39;]
Categorical columns in Spend: [&#39;Date&#39;]
Categorical columns in Payment: [&#39;Date&#39;]
</pre></div>
</div>
</div>
</div>
<p>Eliminar las variables categoricas imputadas dada la revision o chequeo previo y se muestra las variables o columnas con los que cuenta actualmente el conjunto de datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Aplicar la eliminación de columnas categóricas en cada DataFrame filtrado</span>
<span class="n">delinquency_df_filtered</span> <span class="o">=</span> <span class="n">remove_categorical_columns</span><span class="p">(</span><span class="n">delinquency_df_filtered</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">)</span>
<span class="n">balance_df_filtered</span> <span class="o">=</span> <span class="n">remove_categorical_columns</span><span class="p">(</span><span class="n">balance_df_filtered</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">)</span>
<span class="n">risk_df_filtered</span> <span class="o">=</span> <span class="n">remove_categorical_columns</span><span class="p">(</span><span class="n">risk_df_filtered</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">)</span>
<span class="n">spend_df_filtered</span> <span class="o">=</span> <span class="n">remove_categorical_columns</span><span class="p">(</span><span class="n">spend_df_filtered</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">)</span>
<span class="n">payment_df_filtered</span> <span class="o">=</span> <span class="n">remove_categorical_columns</span><span class="p">(</span><span class="n">payment_df_filtered</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">)</span>

<span class="c1"># Verificar las columnas después de la eliminación</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Columns in Delinquency after removal:&quot;</span><span class="p">,</span> <span class="n">delinquency_df_filtered</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Columns in Balance after removal:&quot;</span><span class="p">,</span> <span class="n">balance_df_filtered</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Columns in Risk after removal:&quot;</span><span class="p">,</span> <span class="n">risk_df_filtered</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Columns in Spend after removal:&quot;</span><span class="p">,</span> <span class="n">spend_df_filtered</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Columns in Payment after removal:&quot;</span><span class="p">,</span> <span class="n">payment_df_filtered</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Columns in Delinquency after removal: Index([&#39;D_105&#39;, &#39;D_56&#39;, &#39;D_77&#39;, &#39;D_43&#39;, &#39;D_46&#39;, &#39;D_62&#39;, &#39;D_48&#39;, &#39;D_61&#39;, &#39;D_78&#39;,
       &#39;D_44&#39;, &#39;D_83&#39;, &#39;D_69&#39;, &#39;D_55&#39;, &#39;D_124&#39;, &#39;D_119&#39;, &#39;D_118&#39;, &#39;D_115&#39;,
       &#39;D_113&#39;, &#39;D_125&#39;, &#39;D_121&#39;, &#39;D_122&#39;, &#39;D_123&#39;, &#39;D_91&#39;, &#39;D_59&#39;, &#39;D_141&#39;,
       &#39;D_131&#39;, &#39;D_139&#39;, &#39;D_145&#39;, &#39;D_130&#39;, &#39;D_129&#39;, &#39;D_103&#39;, &#39;D_107&#39;, &#39;D_104&#39;,
       &#39;D_143&#39;, &#39;D_128&#39;, &#39;D_70&#39;, &#39;D_79&#39;, &#39;D_133&#39;, &#39;D_144&#39;, &#39;D_102&#39;, &#39;D_140&#39;,
       &#39;D_84&#39;, &#39;D_89&#39;, &#39;D_52&#39;, &#39;D_81&#39;, &#39;D_72&#39;, &#39;D_74&#39;, &#39;D_80&#39;, &#39;D_112&#39;, &#39;D_45&#39;,
       &#39;D_54&#39;, &#39;D_41&#39;, &#39;D_109&#39;, &#39;D_47&#39;, &#39;D_127&#39;, &#39;D_92&#39;, &#39;D_93&#39;, &#39;D_94&#39;,
       &#39;D_65&#39;, &#39;D_86&#39;, &#39;D_96&#39;, &#39;D_58&#39;, &#39;D_60&#39;, &#39;D_51&#39;, &#39;D_75&#39;, &#39;D_71&#39;, &#39;D_39&#39;,
       &#39;customer_ID&#39;, &#39;target&#39;],
      dtype=&#39;object&#39;)
Columns in Balance after removal: Index([&#39;B_13&#39;, &#39;B_8&#39;, &#39;B_25&#39;, &#39;B_15&#39;, &#39;B_3&#39;, &#39;B_22&#39;, &#39;B_16&#39;, &#39;B_20&#39;, &#39;B_19&#39;,
       &#39;B_26&#39;, &#39;B_2&#39;, &#39;B_33&#39;, &#39;B_27&#39;, &#39;B_41&#39;, &#39;B_6&#39;, &#39;B_37&#39;, &#39;B_40&#39;, &#39;B_4&#39;,
       &#39;B_5&#39;, &#39;B_10&#39;, &#39;B_7&#39;, &#39;B_23&#39;, &#39;B_28&#39;, &#39;B_14&#39;, &#39;B_36&#39;, &#39;B_11&#39;, &#39;B_12&#39;,
       &#39;B_9&#39;, &#39;B_24&#39;, &#39;B_18&#39;, &#39;B_21&#39;, &#39;B_1&#39;, &#39;B_31&#39;, &#39;B_32&#39;, &#39;customer_ID&#39;,
       &#39;target&#39;],
      dtype=&#39;object&#39;)
Columns in Risk after removal: Index([&#39;R_27&#39;, &#39;R_20&#39;, &#39;R_12&#39;, &#39;R_7&#39;, &#39;R_14&#39;, &#39;R_2&#39;, &#39;R_21&#39;, &#39;R_22&#39;, &#39;R_23&#39;,
       &#39;R_24&#39;, &#39;R_25&#39;, &#39;R_17&#39;, &#39;R_18&#39;, &#39;R_13&#39;, &#39;R_15&#39;, &#39;R_16&#39;, &#39;R_5&#39;, &#39;R_10&#39;,
       &#39;R_11&#39;, &#39;R_6&#39;, &#39;R_8&#39;, &#39;R_4&#39;, &#39;R_3&#39;, &#39;R_1&#39;, &#39;R_28&#39;, &#39;R_19&#39;,
       &#39;customer_ID&#39;, &#39;target&#39;],
      dtype=&#39;object&#39;)
Columns in Spend after removal: Index([&#39;S_9&#39;, &#39;S_27&#39;, &#39;S_7&#39;, &#39;S_3&#39;, &#39;S_22&#39;, &#39;S_24&#39;, &#39;S_25&#39;, &#39;S_26&#39;, &#39;S_23&#39;,
       &#39;S_5&#39;, &#39;S_15&#39;, &#39;S_18&#39;, &#39;S_11&#39;, &#39;S_16&#39;, &#39;S_17&#39;, &#39;S_6&#39;, &#39;S_12&#39;, &#39;S_8&#39;,
       &#39;S_13&#39;, &#39;S_19&#39;, &#39;S_20&#39;, &#39;customer_ID&#39;, &#39;target&#39;],
      dtype=&#39;object&#39;)
Columns in Payment after removal: Index([&#39;P_3&#39;, &#39;P_2&#39;, &#39;P_4&#39;, &#39;customer_ID&#39;, &#39;target&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
</section>
<section id="inputacion-de-datos-numericos">
<h3>Inputacion de datos numericos<a class="headerlink" href="#inputacion-de-datos-numericos" title="Link to this heading">#</a></h3>
<p><strong><code class="docutils literal notranslate"><span class="pre">Iterative</span> <span class="pre">Imputer</span></code></strong></p>
<p>El <code class="docutils literal notranslate"><span class="pre">Iterative</span> <span class="pre">Imputer</span></code> estima los valores faltantes mediante múltiples regresiones iterativas. Inicializa con una imputación básica y, luego, predice cada valor faltante utilizando las demás características como predictores. Este proceso se repite hasta que las imputaciones convergen o alcanzan el número máximo de iteraciones, capturando las relaciones entre variables para mejorar la precisión en la imputación de datos numéricos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Función para realizar la imputación de solo las variables numéricas de un grupo</span>
<span class="k">def</span> <span class="nf">impute_group_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">group_name</span><span class="p">):</span>
    <span class="c1"># Excluir columnas no numéricas (por ejemplo, &#39;customer_ID&#39;, &#39;Date&#39;, &#39;target&#39;)</span>
    <span class="n">numeric_columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>  <span class="c1"># Tomamos solo las columnas numéricas del grupo</span>

    <span class="c1"># Convertir Dask DataFrame a Pandas para aplicar IterativeImputer</span>
    <span class="n">X_dask</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">numeric_columns</span><span class="p">]</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">X_dask</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>  <span class="c1"># Convertimos a Pandas</span>

    <span class="c1"># Contar valores faltantes antes de la imputación</span>
    <span class="n">missing_before</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">: Valores faltantes antes de la imputación: </span><span class="si">{</span><span class="n">missing_before</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Aplicar IterativeImputer a las variables numéricas</span>
    <span class="n">imputer</span> <span class="o">=</span> <span class="n">IterativeImputer</span><span class="p">(</span><span class="n">n_nearest_features</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">imputation_order</span><span class="o">=</span><span class="s1">&#39;ascending&#39;</span><span class="p">)</span>
    <span class="n">X_imputed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">numeric_columns</span><span class="p">)</span>

    <span class="c1"># Contar valores faltantes después de la imputación</span>
    <span class="n">missing_after</span> <span class="o">=</span> <span class="n">X_imputed</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">: Valores faltantes después de la imputación: </span><span class="si">{</span><span class="n">missing_after</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Volver a convertir a un Dask DataFrame</span>
    <span class="n">X_imputed_dask</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">X_imputed</span><span class="p">,</span> <span class="n">npartitions</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">X_imputed_dask</span>
</pre></div>
</div>
</div>
</div>
<p>Para cada grupo divido, se presenta el número incial de datos faltantes y el número final de datos faltantes, de los cuales se expresa lo siguiente:</p>
<p>Para <em><strong>Balance</strong></em></p>
<ul class="simple">
<li><p>Balance: Valores faltantes antes de la imputación: 108841</p></li>
<li><p>Balance: Valores faltantes después de la imputación: 0</p></li>
</ul>
<p>Para <em><strong>Risk</strong></em></p>
<ul class="simple">
<li><p>Risk: Valores faltantes antes de la imputación: 128836</p></li>
<li><p>Risk: Valores faltantes después de la imputación: 0</p></li>
</ul>
<p>Para <em><strong>Spend</strong></em></p>
<ul class="simple">
<li><p>Spend: Valores faltantes antes de la imputación: 6427209</p></li>
<li><p>Spend: Valores faltantes después de la imputación: 0</p></li>
</ul>
<p>Para <em><strong>Payment</strong></em></p>
<ul class="simple">
<li><p>Payment: Valores faltantes antes de la imputación: 347477</p></li>
<li><p>Payment: Valores faltantes después de la imputación: 0</p></li>
</ul>
<p>Para <em><strong>Delinquency</strong></em></p>
<ul class="simple">
<li><p>Valores faltantes antes de la imputación: 18092631</p></li>
<li><p>Valores faltantes después de la imputación: 0</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Función para agregar columnas categóricas y concatenar todos los grupos</span>
<span class="k">def</span> <span class="nf">concatenate_groups_with_categoricals</span><span class="p">(</span><span class="n">groups_imputed</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="c1"># &#39;groups_imputed&#39; es una lista de DataFrames imputados por grupo</span>
    <span class="c1"># &#39;data&#39; es el DataFrame original que contiene &#39;customer_ID&#39;, &#39;Date&#39; y &#39;target&#39;</span>

    <span class="c1"># Extraemos las columnas categóricas</span>
    <span class="n">categoricals</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

    <span class="c1"># Concatenar todas las columnas imputadas con las columnas categóricas</span>
    <span class="n">concatenated_df</span> <span class="o">=</span> <span class="n">categoricals</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">group_df</span> <span class="ow">in</span> <span class="n">groups_imputed</span><span class="p">:</span>
        <span class="n">concatenated_df</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">concatenated_df</span><span class="p">,</span> <span class="n">group_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">concatenated_df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">balance_imputed</span> <span class="o">=</span> <span class="n">impute_group_numeric</span><span class="p">(</span><span class="n">balance_df_filtered</span><span class="p">,</span> <span class="s2">&quot;Balance&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Balance: Valores faltantes antes de la imputación: 104809
Balance: Valores faltantes después de la imputación: 0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">risk_imputed</span> <span class="o">=</span> <span class="n">impute_group_numeric</span><span class="p">(</span><span class="n">risk_df_filtered</span><span class="p">,</span> <span class="s2">&quot;Risk&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Risk: Valores faltantes antes de la imputación: 128836
Risk: Valores faltantes después de la imputación: 0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">spend_imputed</span> <span class="o">=</span> <span class="n">impute_group_numeric</span><span class="p">(</span><span class="n">spend_df_filtered</span><span class="p">,</span> <span class="s2">&quot;Spend&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Spend: Valores faltantes antes de la imputación: 6427209
Spend: Valores faltantes después de la imputación: 0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">payment_imputed</span> <span class="o">=</span> <span class="n">impute_group_numeric</span><span class="p">(</span><span class="n">payment_df_filtered</span><span class="p">,</span> <span class="s2">&quot;Payment&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Payment: Valores faltantes antes de la imputación: 347477
Payment: Valores faltantes después de la imputación: 0
</pre></div>
</div>
</div>
</div>
<p>Para la imputanción de delinquency, dado que el tiempo de ejecución es altamente complejo (cerca de 81 horas de ejecución) para los 19 millones de datos faltantes en este grupo de variables, se procede a imputar con la mediana ya que los datos no siguen una distribución normal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">impute_with_median_pandas</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="c1"># Convertir el Dask DataFrame a Pandas</span>
    <span class="n">df_pandas</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

    <span class="c1"># Seleccionar solo las columnas numéricas para calcular la mediana</span>
    <span class="n">numeric_cols</span> <span class="o">=</span> <span class="n">df_pandas</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

    <span class="c1"># Calcular la mediana exacta de las columnas numéricas en Pandas</span>
    <span class="c1"># y usarla para llenar los valores faltantes en esas columnas</span>
    <span class="n">df_imputed</span> <span class="o">=</span> <span class="n">df_pandas</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df_pandas</span><span class="p">[</span><span class="n">numeric_cols</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>

    <span class="c1"># Contar valores faltantes antes y después de la imputación</span>
    <span class="n">missing_before</span> <span class="o">=</span> <span class="n">df_pandas</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">missing_after</span> <span class="o">=</span> <span class="n">df_imputed</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="c1"># Imprimir el resultado</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Valores faltantes antes de la imputación: </span><span class="si">{</span><span class="n">missing_before</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Valores faltantes después de la imputación: </span><span class="si">{</span><span class="n">missing_after</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Reindex before converting back to Dask DataFrame to preserve divisions</span>
    <span class="n">df_imputed</span> <span class="o">=</span> <span class="n">df_imputed</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">compute</span><span class="p">())</span> <span class="c1"># Reindex using original index values</span>

    <span class="c1"># Convert back to Dask DataFrame with original divisions</span>
    <span class="k">return</span> <span class="n">dd</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df_imputed</span><span class="p">,</span> <span class="n">npartitions</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">npartitions</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Preserve original divisions</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Aplicar la imputación solo en delinquency_df_filtered</span>
<span class="n">delinquency_imputed</span> <span class="o">=</span> <span class="n">impute_with_median_pandas</span><span class="p">(</span><span class="n">delinquency_df_filtered</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Valores faltantes antes de la imputación: 18092631
Valores faltantes después de la imputación: 0
</pre></div>
</div>
</div>
</div>
<p>Finalizada la imputación de datos faltantes para ambos tipos de variables, se procede a concatenar los conjuntos de datos uniendo los valores numéricos con los categóricos y finalmente anexando las columnas de guía ‘<code class="docutils literal notranslate"><span class="pre">customer_ID</span></code>’, ‘<code class="docutils literal notranslate"><span class="pre">Date</span></code>’ y ‘<code class="docutils literal notranslate"><span class="pre">target</span></code>’</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># DataFrame principal que contiene las columnas &#39;customer_ID&#39;, &#39;Date&#39;, &#39;target&#39;</span>
<span class="c1"># Este debe ser el DataFrame original (no imputado) con todas las filas</span>
<span class="c1"># Usamos &#39;data&#39;, que es tu DataFrame original</span>
<span class="n">data_main</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">]]</span>  <span class="c1"># El DataFrame original con todas las columnas categóricas</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Transformar los DataFrames imputados de Dask a Pandas</span>
<span class="n">balance_imputed_pd</span> <span class="o">=</span> <span class="n">balance_imputed</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">risk_imputed_pd</span> <span class="o">=</span> <span class="n">risk_imputed</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">spend_imputed_pd</span> <span class="o">=</span> <span class="n">spend_imputed</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">payment_imputed_pd</span> <span class="o">=</span> <span class="n">payment_imputed</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">delinquency_imputed_pd</span> <span class="o">=</span> <span class="n">delinquency_imputed</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

<span class="c1"># Si tienes el DataFrame data_main y está en Dask, también lo puedes convertir a Pandas</span>
<span class="n">data_main_pd</span> <span class="o">=</span> <span class="n">data_main</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="k">if</span> <span class="s1">&#39;dask&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">data_main</span><span class="p">))</span> <span class="k">else</span> <span class="n">data_main</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lista de DataFrames imputados ya convertidos a pandas</span>
<span class="n">groups_imputed_pd</span> <span class="o">=</span> <span class="p">[</span><span class="n">delinquency_imputed_pd</span><span class="p">,</span> <span class="n">balance_imputed_pd</span><span class="p">,</span> <span class="n">risk_imputed_pd</span><span class="p">,</span> <span class="n">spend_imputed_pd</span><span class="p">,</span> <span class="n">payment_imputed_pd</span><span class="p">]</span>

<span class="c1"># Restablecer el índice para cada DataFrame en la lista para evitar problemas de reindexado</span>
<span class="n">groups_imputed_pd</span> <span class="o">=</span> <span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">groups_imputed_pd</span><span class="p">]</span>

<span class="c1"># Concatenar los DataFrames imputados horizontalmente (por columnas)</span>
<span class="n">final_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">groups_imputed_pd</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Asegúrate de que &#39;data_main_pd&#39; también tenga su índice restablecido</span>
<span class="n">data_main_pd</span> <span class="o">=</span> <span class="n">data_main_pd</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Concatenar también las columnas categóricas (&#39;customer_ID&#39;, &#39;Date&#39;, &#39;target&#39;) con el DataFrame final</span>
<span class="n">final_data_with_categoricals</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data_main_pd</span><span class="p">[[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">]],</span> <span class="n">final_data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">final_data_with_categoricals</span> <span class="o">=</span> <span class="n">final_data_with_categoricals</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="o">~</span><span class="n">final_data_with_categoricals</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">final_data_with_categoricals</span><span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...
1    0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...
2    0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...
3    0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...
4    0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...
Name: customer_ID, dtype: string
</pre></div>
</div>
</div>
</div>
<p>Se confirma que el conjunto de datos posea el mismo número de observaciones y se conclye que posterior a la imputación de datos tenemos:</p>
<ul class="simple">
<li><p>5.531.351 observaciones</p></li>
<li><p>151 Variables</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">n_columnas</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">final_data_with_categoricals</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">n_filas</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">final_data_with_categoricals</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;El conjunto de entrenamiento para las predictoras tiene </span><span class="si">{</span><span class="n">n_filas</span><span class="si">}</span><span class="s2"> filas y </span><span class="si">{</span><span class="n">n_columnas</span><span class="si">}</span><span class="s2"> columnas.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>El conjunto de entrenamiento para las predictoras tiene 5531451 filas y 154 columnas.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mostrar cuántas columnas hay en final_data</span>
<span class="k">def</span> <span class="nf">count_and_sort_columns</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">columns_sorted</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Ordenar en orden descendente</span>
    <span class="n">num_columns</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns_sorted</span><span class="p">)</span>  <span class="c1"># Contar cuántas columnas hay</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;El DataFrame final tiene </span><span class="si">{</span><span class="n">num_columns</span><span class="si">}</span><span class="s2"> columnas.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lista de columnas ordenadas: </span><span class="si">{</span><span class="n">columns_sorted</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">columns_sorted</span>

<span class="c1"># Aplicar la función a final_data</span>
<span class="n">columns_sorted</span> <span class="o">=</span> <span class="n">count_and_sort_columns</span><span class="p">(</span><span class="n">final_data_with_categoricals</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>El DataFrame final tiene 154 columnas.
Lista de columnas ordenadas: [&#39;target&#39;, &#39;customer_ID&#39;, &#39;S_9&#39;, &#39;S_8&#39;, &#39;S_7&#39;, &#39;S_6&#39;, &#39;S_5&#39;, &#39;S_3&#39;, &#39;S_27&#39;, &#39;S_26&#39;, &#39;S_25&#39;, &#39;S_24&#39;, &#39;S_23&#39;, &#39;S_22&#39;, &#39;S_20&#39;, &#39;S_19&#39;, &#39;S_18&#39;, &#39;S_17&#39;, &#39;S_16&#39;, &#39;S_15&#39;, &#39;S_13&#39;, &#39;S_12&#39;, &#39;S_11&#39;, &#39;R_8&#39;, &#39;R_7&#39;, &#39;R_6&#39;, &#39;R_5&#39;, &#39;R_4&#39;, &#39;R_3&#39;, &#39;R_28&#39;, &#39;R_27&#39;, &#39;R_25&#39;, &#39;R_24&#39;, &#39;R_23&#39;, &#39;R_22&#39;, &#39;R_21&#39;, &#39;R_20&#39;, &#39;R_2&#39;, &#39;R_19&#39;, &#39;R_18&#39;, &#39;R_17&#39;, &#39;R_16&#39;, &#39;R_15&#39;, &#39;R_14&#39;, &#39;R_13&#39;, &#39;R_12&#39;, &#39;R_11&#39;, &#39;R_10&#39;, &#39;R_1&#39;, &#39;P_4&#39;, &#39;P_3&#39;, &#39;P_2&#39;, &#39;Date&#39;, &#39;D_96&#39;, &#39;D_94&#39;, &#39;D_93&#39;, &#39;D_92&#39;, &#39;D_91&#39;, &#39;D_89&#39;, &#39;D_86&#39;, &#39;D_84&#39;, &#39;D_83&#39;, &#39;D_81&#39;, &#39;D_80&#39;, &#39;D_79&#39;, &#39;D_78&#39;, &#39;D_77&#39;, &#39;D_75&#39;, &#39;D_74&#39;, &#39;D_72&#39;, &#39;D_71&#39;, &#39;D_70&#39;, &#39;D_69&#39;, &#39;D_65&#39;, &#39;D_62&#39;, &#39;D_61&#39;, &#39;D_60&#39;, &#39;D_59&#39;, &#39;D_58&#39;, &#39;D_56&#39;, &#39;D_55&#39;, &#39;D_54&#39;, &#39;D_52&#39;, &#39;D_51&#39;, &#39;D_48&#39;, &#39;D_47&#39;, &#39;D_46&#39;, &#39;D_45&#39;, &#39;D_44&#39;, &#39;D_43&#39;, &#39;D_41&#39;, &#39;D_39&#39;, &#39;D_145&#39;, &#39;D_144&#39;, &#39;D_143&#39;, &#39;D_141&#39;, &#39;D_140&#39;, &#39;D_139&#39;, &#39;D_133&#39;, &#39;D_131&#39;, &#39;D_130&#39;, &#39;D_129&#39;, &#39;D_128&#39;, &#39;D_127&#39;, &#39;D_125&#39;, &#39;D_124&#39;, &#39;D_123&#39;, &#39;D_122&#39;, &#39;D_121&#39;, &#39;D_119&#39;, &#39;D_118&#39;, &#39;D_115&#39;, &#39;D_113&#39;, &#39;D_112&#39;, &#39;D_109&#39;, &#39;D_107&#39;, &#39;D_105&#39;, &#39;D_104&#39;, &#39;D_103&#39;, &#39;D_102&#39;, &#39;B_9&#39;, &#39;B_8&#39;, &#39;B_7&#39;, &#39;B_6&#39;, &#39;B_5&#39;, &#39;B_41&#39;, &#39;B_40&#39;, &#39;B_4&#39;, &#39;B_37&#39;, &#39;B_36&#39;, &#39;B_33&#39;, &#39;B_32&#39;, &#39;B_31&#39;, &#39;B_3&#39;, &#39;B_28&#39;, &#39;B_27&#39;, &#39;B_26&#39;, &#39;B_25&#39;, &#39;B_24&#39;, &#39;B_23&#39;, &#39;B_22&#39;, &#39;B_21&#39;, &#39;B_20&#39;, &#39;B_2&#39;, &#39;B_19&#39;, &#39;B_18&#39;, &#39;B_16&#39;, &#39;B_15&#39;, &#39;B_14&#39;, &#39;B_13&#39;, &#39;B_12&#39;, &#39;B_11&#39;, &#39;B_10&#39;, &#39;B_1&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">final_data_with_categoricals</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                         customer_ID        Date  target  \
0  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-03-09       0   
1  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-04-07       0   
2  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-05-28       0   
3  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-06-13       0   
4  0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...  2017-07-16       0   

      D_105      D_56      D_77      D_43      D_46      D_62      D_48  ...  \
0  0.893734  0.152025  0.205833  0.088512  0.358587  0.091071  0.255736  ...   
1  0.906841  0.156201  0.205833  0.088512  0.353630  0.086805  0.223329  ...   
2  0.928719  0.153795  0.205833  0.088512  0.334650  0.094001  0.189424  ...   
3  0.935383  0.155772  0.205833  0.088512  0.323271  0.094854  0.135586  ...   
4  0.953363  0.154914  0.205833  0.088512  0.231009  0.093915  0.286172  ...   

       S_17       S_6      S_12       S_8      S_13      S_19      S_20  \
0  0.008033  0.008322  0.272008  0.922998  0.515222  0.002537  0.009705   
1  0.000760  0.002482  0.188970  0.919414  0.509048  0.008427  0.009924   
2  0.004056  0.000530  0.495308  1.001977  0.679257  0.007327  0.008446   
3  0.006969  0.000783  0.508670  0.704016  0.515282  0.007053  0.006614   
4  0.001770  0.006698  0.216507  0.917133  0.507712  0.007728  0.005511   

        P_3       P_2       P_4  
0  0.736463  0.938469  0.007554  
1  0.720886  0.936665  0.004832  
2  0.738044  0.954180  0.006561  
3  0.741813  0.960384  0.009559  
4  0.691986  0.947248  0.008156  

[5 rows x 154 columns]
</pre></div>
</div>
</div>
</div>
<p>Se muestra una lista descendente y organizada por nombre de grupo para cada variable:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">column_names</span> <span class="o">=</span> <span class="n">final_data_with_categoricals</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Función para extraer el número de una columna, dejando su prefijo intacto</span>
<span class="k">def</span> <span class="nf">get_number_from_column</span><span class="p">(</span><span class="n">col_name</span><span class="p">):</span>
    <span class="c1"># Check if the column name contains an underscore and a number after it</span>
    <span class="k">if</span> <span class="s1">&#39;_&#39;</span> <span class="ow">in</span> <span class="n">col_name</span> <span class="ow">and</span> <span class="n">col_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
        <span class="n">prefix</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="n">col_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">prefix</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
    <span class="c1"># If not, return the column name as the prefix and 0 as the number</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">col_name</span><span class="p">,</span> <span class="mi">0</span>

<span class="c1"># Separar las columnas por categorías y ordenar</span>
<span class="n">sorted_columns</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">column_names</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">get_number_from_column</span><span class="p">)</span>

<span class="c1"># Imprimir los nombres de las columnas en el orden deseado</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">sorted_columns</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>B_1
B_2
B_3
B_4
B_5
B_6
B_7
B_8
B_9
B_10
B_11
B_12
B_13
B_14
B_15
B_16
B_18
B_19
B_20
B_21
B_22
B_23
B_24
B_25
B_26
B_27
B_28
B_31
B_32
B_33
B_36
B_37
B_40
B_41
D_39
D_41
D_43
D_44
D_45
D_46
D_47
D_48
D_51
D_52
D_54
D_55
D_56
D_58
D_59
D_60
D_61
D_62
D_65
D_69
D_70
D_71
D_72
D_74
D_75
D_77
D_78
D_79
D_80
D_81
D_83
D_84
D_86
D_89
D_91
D_92
D_93
D_94
D_96
D_102
D_103
D_104
D_105
D_107
D_109
D_112
D_113
D_115
D_118
D_119
D_121
D_122
D_123
D_124
D_125
D_127
D_128
D_129
D_130
D_131
D_133
D_139
D_140
D_141
D_143
D_144
D_145
Date
P_2
P_3
P_4
R_1
R_2
R_3
R_4
R_5
R_6
R_7
R_8
R_10
R_11
R_12
R_13
R_14
R_15
R_16
R_17
R_18
R_19
R_20
R_21
R_22
R_23
R_24
R_25
R_27
R_28
S_3
S_5
S_6
S_7
S_8
S_9
S_11
S_12
S_13
S_15
S_16
S_17
S_18
S_19
S_20
S_22
S_23
S_24
S_25
S_26
S_27
customer_ID
target
</pre></div>
</div>
</div>
</div>
</section>
<section id="verificacion-de-multicolinealidad">
<h3><strong>Verificación de multicolinealidad</strong><a class="headerlink" href="#verificacion-de-multicolinealidad" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">El</span> <span class="pre">VIF</span> <span class="pre">(Factores</span> <span class="pre">de</span> <span class="pre">Inflación</span> <span class="pre">de</span> <span class="pre">la</span> <span class="pre">Varianza)</span></code> determina la fuerza de la correlación entre las variables independientes. Se pronostica tomando una variable y comparándola con todas las demás. La puntuación VIF de una variable independiente representa hasta qué punto la variable se explica por otras variables independientes.</p>
<ul class="simple">
<li><p>El valor <span class="math notranslate nohighlight">\(R^2\)</span> se determina para averiguar hasta qué punto una variable independiente es descrita por las demás variables independientes. Un valor alto de
significa que la variable está muy correlacionada con las demás variables. Esto se refleja en el VIF, que se indica a continuación:</p></li>
</ul>
<section id="correlaciones-entre-variables">
<h4><em><strong>Correlaciones entre variables</strong></em><a class="headerlink" href="#correlaciones-entre-variables" title="Link to this heading">#</a></h4>
<p>Correlación entre categoricas</p>
<p>Para verificar las correlaciones entre variables no numéricas se implementará el método de <code class="docutils literal notranslate"><span class="pre">V'</span> <span class="pre">Cramer</span></code>, el cula es una extensión del coeficiente de contingencia <em>chi-cuadrado</em> que mide la fuerza de asociación entre dos variables categóricas.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Escala</span> <span class="pre">uniforme:</span></code> El V de Cramer se ajusta a un rango de 0 a 1, donde 0 indica independencia total y 1 indica asociación perfecta, lo que facilita la comparación entre varias variables categóricas de diferentes tamaños.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Función para calcular el Cramer&#39;s V</span>
<span class="k">def</span> <span class="nf">cramers_v</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">contingency_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">chi2</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">chi2_contingency</span><span class="p">(</span><span class="n">contingency_table</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">contingency_table</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Número total de observaciones</span>
    <span class="n">r</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">contingency_table</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Filas y columnas de la tabla de contingencia</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">chi2</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>

<span class="c1"># Función para calcular la matriz de Cramer&#39;s V para todas las variables categóricas</span>
<span class="k">def</span> <span class="nf">cramers_v_matrix</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">categorical_columns</span><span class="p">)</span>
    <span class="n">cramer_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">cramer_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">cramers_v</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">categorical_columns</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">df</span><span class="p">[</span><span class="n">categorical_columns</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span>
            <span class="n">cramer_matrix</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cramer_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>  <span class="c1"># La matriz es simétrica</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cramer_matrix</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">categorical_columns</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">categorical_columns</span><span class="p">)</span>

<span class="c1"># Convertir &#39;data&#39; de Dask a Pandas</span>
<span class="n">data_pd</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

<span class="c1"># No es necesario convertir categorical_encoded_df a pandas porque ya está en pandas</span>
<span class="c1"># Asegurarse de que la columna &#39;target&#39; esté presente en categorical_encoded_df</span>
<span class="k">if</span> <span class="s1">&#39;target&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">categorical_encoded_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">categorical_encoded_df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_pd</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Asegurar que &#39;target&#39; esté alineado con los registros</span>

<span class="c1"># Ahora calculamos la matriz de Cramer&#39;s V</span>
<span class="n">categorical_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;D_64&#39;</span><span class="p">,</span> <span class="s1">&#39;D_68&#39;</span><span class="p">,</span> <span class="s1">&#39;D_116&#39;</span><span class="p">,</span> <span class="s1">&#39;D_114&#39;</span><span class="p">,</span> <span class="s1">&#39;D_117&#39;</span><span class="p">,</span> <span class="s1">&#39;D_120&#39;</span><span class="p">,</span> <span class="s1">&#39;D_126&#39;</span><span class="p">,</span> <span class="s1">&#39;D_63&#39;</span><span class="p">,</span> <span class="s1">&#39;B_38&#39;</span><span class="p">,</span> <span class="s1">&#39;B_30&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">cramers_v_df</span> <span class="o">=</span> <span class="n">cramers_v_matrix</span><span class="p">(</span><span class="n">categorical_encoded_df</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>La matriz de asociación permite identificar la presencia de relaciones entre variables categóricas con base al coeficiente de V de cramer, se presentan las correlaciones a continuación:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Variables</span> <span class="pre">con</span> <span class="pre">alta</span> <span class="pre">correlación</span> <span class="pre">(&gt;70%)</span></code></p></li>
</ol>
<ul class="simple">
<li><p>D_116 vs D_114, D_117, D_120 <code class="docutils literal notranslate"><span class="pre">(71%)</span></code></p></li>
<li><p>D_117 vs D_114, D_120 <code class="docutils literal notranslate"><span class="pre">(71%)</span></code></p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><code class="docutils literal notranslate"><span class="pre">Variables</span> <span class="pre">con</span> <span class="pre">una</span> <span class="pre">correlación</span> <span class="pre">moderada</span> <span class="pre">-</span> <span class="pre">alta</span> <span class="pre">(50%</span> <span class="pre">-</span> <span class="pre">69%)</span></code></p></li>
</ol>
<ul class="simple">
<li><p>D_64 vs D_114 <code class="docutils literal notranslate"><span class="pre">(67%)</span></code></p></li>
<li><p>D_68 vs D_120 <code class="docutils literal notranslate"><span class="pre">(62%)</span></code></p></li>
<li><p>D_120 vs D_125 <code class="docutils literal notranslate"><span class="pre">(58%)</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cramers_v_df</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.2f&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriz de Cramer</span><span class="se">\&#39;</span><span class="s1">s V para Variables Categóricas&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e3d0ce80f9fbaf0e595b99a59b8731da6213540df7dd5314f2c1676466b843bd.png" src="_images/e3d0ce80f9fbaf0e595b99a59b8731da6213540df7dd5314f2c1676466b843bd.png" />
</div>
</div>
<p>Con base a la matriz de asociación de variables categóricas, se puede indicar que las variables candidatas a ser eliminadas son:</p>
<ul class="simple">
<li><p>D_120</p></li>
<li><p>D_114</p></li>
<li><p>D_116</p></li>
<li><p>B_30</p></li>
</ul>
</section>
<section id="correlaciones-numericas">
<h4>Correlaciones numéricas<a class="headerlink" href="#correlaciones-numericas" title="Link to this heading">#</a></h4>
<p>La siguiente matriz de correlación permite establecer o visualizar la correlación numérica entre las variavles del conjunto de datos imputado, se observa que la mayoría de estas no presenta alta multicolinealidad sino, por el contrario, un comportamiento de idependencia entre las mismas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Seleccionar solo las columnas numéricas del DataFrame en pandas</span>
<span class="n">final_data_numeric</span> <span class="o">=</span> <span class="n">final_data_with_categoricals</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span>

<span class="c1"># Resetear el índice del DataFrame de pandas para asegurar unicidad</span>
<span class="n">final_data_numeric</span> <span class="o">=</span> <span class="n">final_data_numeric</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Calcular la matriz de correlación con pandas</span>
<span class="n">correlation_matrix</span> <span class="o">=</span> <span class="n">final_data_numeric</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>  <span class="c1"># Aumentar el tamaño del gráfico</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">correlation_matrix</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.2f&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriz de Correlación de las Variables Numéricas&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c0f1027565a0b2c459b068666bb81127c72a082e5ab58fc901ec2562834252f0.png" src="_images/c0f1027565a0b2c459b068666bb81127c72a082e5ab58fc901ec2562834252f0.png" />
</div>
</div>
</section>
<section id="vif-factor-de-inflacion-de-la-varianza">
<h4>VIF - Factor de inflación de la varianza<a class="headerlink" href="#vif-factor-de-inflacion-de-la-varianza" title="Link to this heading">#</a></h4>
<div class="math notranslate nohighlight">
\[VIF = \frac{1}{1-R^2}\]</div>
<p>Así, cuanto más se acerque el valor de
a 1, mayor será el valor de VIF y mayor la multicolinealidad con la variable independiente concreta.</p>
<ul class="simple">
<li><p>Un valor VIF de 1: Sin multicolinealidad (variable perfectamente independiente).</p></li>
<li><p>Un valor VIF entre 1 y 5: Multicolinealidad baja a moderada (no se considera problemática).</p></li>
<li><p>Un valor VIF entre 5 y 10: Multicolinealidad moderada a alta (considerada problemática).</p></li>
<li><p>Un valor VIF superior a 10: Multicolinealidad alta (preocupación grave, requiere medidas).</p></li>
</ul>
</section>
</section>
<section id="id1">
<h3>Verificación de multicolinealidad<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>Calcularemos de manera separada por grupos de variables cada factor de imflación de la varianza, la función que permite realizar eso muestra en cada iteración la tabla con el VIF calculado y el top 10 de los valores más elevados, elimina iterativamente la variable que posee más multicolinealidad y recalcula para las variables restantes el VIF nuevamente. Repite el proceso hasta que ya no quede VIF &gt; 10.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.stats.outliers_influence</span> <span class="kn">import</span> <span class="n">variance_inflation_factor</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Función para calcular el VIF, filtrando solo las columnas numéricas</span>
<span class="k">def</span> <span class="nf">calculate_vif</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="c1"># Reemplazar NaN con la mediana de cada columna</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>

    <span class="c1"># Filtrar solo columnas numéricas</span>
    <span class="n">numeric_cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">vif_data</span><span class="p">[</span><span class="s1">&#39;Variable&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numeric_cols</span>
    <span class="n">vif_data</span><span class="p">[</span><span class="s1">&#39;VIF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">numeric_cols</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">numeric_cols</span><span class="p">))]</span>
    <span class="k">return</span> <span class="n">vif_data</span>

<span class="c1"># Función para eliminar columnas categóricas</span>
<span class="k">def</span> <span class="nf">remove_categorical_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">categorical_columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>

<span class="c1"># Función para eliminar variables con alto VIF</span>
<span class="k">def</span> <span class="nf">eliminate_high_vif</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">iteration</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="c1"># Calcular el VIF solo para las columnas numéricas</span>
        <span class="n">vif_df</span> <span class="o">=</span> <span class="n">calculate_vif</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="c1"># Mostrar el top 10 de las variables con mayor VIF</span>
        <span class="n">top_vif</span> <span class="o">=</span> <span class="n">vif_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;VIF&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Top 10 de VIF - Iteración </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">top_vif</span><span class="p">)</span>

        <span class="c1"># Identificar la variable con el mayor VIF</span>
        <span class="n">max_vif_variable</span> <span class="o">=</span> <span class="n">top_vif</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;Variable&#39;</span><span class="p">]</span>
        <span class="n">max_vif_value</span> <span class="o">=</span> <span class="n">top_vif</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;VIF&#39;</span><span class="p">]</span>

        <span class="c1"># Si la variable con el VIF más alto es menor que el umbral, terminamos</span>
        <span class="k">if</span> <span class="n">max_vif_value</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Todas las variables tienen VIF &lt; </span><span class="si">{</span><span class="n">threshold</span><span class="si">}</span><span class="s2">. Se detiene el proceso.&quot;</span><span class="p">)</span>
            <span class="k">break</span>

        <span class="c1"># Eliminar la variable con mayor VIF</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Eliminando la variable &#39;</span><span class="si">{</span><span class="n">max_vif_variable</span><span class="si">}</span><span class="s2">&#39; con VIF=</span><span class="si">{</span><span class="n">max_vif_value</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">max_vif_variable</span><span class="p">])</span>

        <span class="c1"># Mostrar la tabla de VIF después de cada eliminación</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tabla de VIF después de eliminar &#39;</span><span class="si">{</span><span class="n">max_vif_variable</span><span class="si">}</span><span class="s2">&#39;:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">vif_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;VIF&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

        <span class="c1"># Incrementar el contador de iteración</span>
        <span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">df</span>

<span class="c1"># Procesar el cálculo de VIF para cada grupo y eliminar las columnas categóricas</span>
<span class="k">def</span> <span class="nf">process_vif_for_group</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">group_name</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Procesando VIF para el grupo: </span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Eliminar columnas categóricas</span>
    <span class="n">df_filtered</span> <span class="o">=</span> <span class="n">remove_categorical_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">)</span>

    <span class="c1"># Calcular y eliminar variables con alto VIF</span>
    <span class="n">final_group_df</span> <span class="o">=</span> <span class="n">eliminate_high_vif</span><span class="p">(</span><span class="n">df_filtered</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">final_group_df</span>
</pre></div>
</div>
</div>
</div>
<p>Para el grupo de variables de Balance quedaron 27 variables con las que se trabajará.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definir los grupos de datos que tienes</span>
<span class="n">balance_df_filtered</span> <span class="o">=</span> <span class="n">process_vif_for_group</span><span class="p">(</span><span class="n">balance_imputed_pd</span><span class="p">,</span> <span class="s2">&quot;Balance&quot;</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">)</span>

<span class="c1"># Mostrar el resultado final de uno de los grupos</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Variables restantes en el grupo Delinquency después del cálculo de VIF:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">balance_df_filtered</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Procesando VIF para el grupo: Balance

Top 10 de VIF - Iteración 1:
   Variable          VIF
23     B_14  5358.534702
3      B_15  3934.123768
2      B_25  1025.296713
31      B_1   430.334854
21     B_23   390.789126
20      B_7   380.687271
25     B_11   271.540053
15     B_37   147.046785
32     B_31    36.485644
10      B_2    29.881377

Eliminando la variable &#39;B_14&#39; con VIF=5358.53

Tabla de VIF después de eliminar &#39;B_14&#39;:
   Variable          VIF
23     B_14  5358.534702
3      B_15  3934.123768
2      B_25  1025.296713
31      B_1   430.334854
21     B_23   390.789126
20      B_7   380.687271
25     B_11   271.540053
15     B_37   147.046785
32     B_31    36.485644
10      B_2    29.881377
29     B_18    26.072098
11     B_33    21.243212
22     B_28    10.665605
6      B_16    10.548509
7      B_20     8.873577
17      B_4     6.864813
4       B_3     6.239872
8      B_19     4.657029
12     B_27     3.759195
0      B_13     3.707134
26     B_12     3.317593
5      B_22     3.252131
27      B_9     3.144946
1       B_8     2.199956
24     B_36     1.762510
18      B_5     1.743734
28     B_24     1.363560
13     B_41     1.322306
33     B_32     1.210903
9      B_26     1.092412
30     B_21     1.027497
14      B_6     1.019242
19     B_10     1.005276
16     B_40     1.002164

Top 10 de VIF - Iteración 2:
   Variable         VIF
30      B_1  430.322602
21     B_23  390.781920
20      B_7  380.681488
24     B_11  271.527899
15     B_37  147.046766
31     B_31   36.253933
10      B_2   29.881268
28     B_18   26.072077
11     B_33   21.243110
22     B_28   10.664686

Eliminando la variable &#39;B_1&#39; con VIF=430.32

Tabla de VIF después de eliminar &#39;B_1&#39;:
   Variable         VIF
30      B_1  430.322602
21     B_23  390.781920
20      B_7  380.681488
24     B_11  271.527899
15     B_37  147.046766
31     B_31   36.253933
10      B_2   29.881268
28     B_18   26.072077
11     B_33   21.243110
22     B_28   10.664686
6      B_16   10.548491
7      B_20    8.873577
17      B_4    6.864764
4       B_3    6.239872
8      B_19    4.657028
3      B_15    3.900625
12     B_27    3.759191
0      B_13    3.707099
25     B_12    3.317587
5      B_22    3.252131
26      B_9    3.144928
2      B_25    3.116503
1       B_8    2.199949
23     B_36    1.762505
18      B_5    1.743731
27     B_24    1.363258
13     B_41    1.322280
32     B_32    1.210903
9      B_26    1.092410
29     B_21    1.027497
14      B_6    1.019242
19     B_10    1.005275
16     B_40    1.002163

Top 10 de VIF - Iteración 3:
   Variable         VIF
21     B_23  363.226857
20      B_7  351.528990
15     B_37  100.554661
24     B_11   93.131444
30     B_31   36.202426
10      B_2   29.878615
28     B_18   25.985916
11     B_33   20.936006
22     B_28   10.577929
6      B_16   10.542450

Eliminando la variable &#39;B_23&#39; con VIF=363.23

Tabla de VIF después de eliminar &#39;B_23&#39;:
   Variable         VIF
21     B_23  363.226857
20      B_7  351.528990
15     B_37  100.554661
24     B_11   93.131444
30     B_31   36.202426
10      B_2   29.878615
28     B_18   25.985916
11     B_33   20.936006
22     B_28   10.577929
6      B_16   10.542450
7      B_20    8.868216
17      B_4    6.861489
4       B_3    6.219542
8      B_19    4.572671
3      B_15    3.786912
12     B_27    3.759150
0      B_13    3.702710
25     B_12    3.315265
5      B_22    3.249744
26      B_9    3.019351
2      B_25    2.806908
1       B_8    2.195397
18      B_5    1.743173
23     B_36    1.586185
27     B_24    1.363227
13     B_41    1.322239
31     B_32    1.207056
9      B_26    1.092149
29     B_21    1.026794
14      B_6    1.019238
19     B_10    1.005274
16     B_40    1.002158

Top 10 de VIF - Iteración 4:
   Variable        VIF
15     B_37  96.701373
23     B_11  89.045636
29     B_31  32.501018
10      B_2  29.874780
27     B_18  24.664358
11     B_33  20.776240
6      B_16  10.539731
7      B_20   8.864664
21     B_28   7.934669
17      B_4   6.438801

Eliminando la variable &#39;B_37&#39; con VIF=96.70

Tabla de VIF después de eliminar &#39;B_37&#39;:
   Variable        VIF
15     B_37  96.701373
23     B_11  89.045636
29     B_31  32.501018
10      B_2  29.874780
27     B_18  24.664358
11     B_33  20.776240
6      B_16  10.539731
7      B_20   8.864664
21     B_28   7.934669
17      B_4   6.438801
4       B_3   6.175116
20      B_7   5.000505
8      B_19   4.572486
12     B_27   3.758939
0      B_13   3.702400
24     B_12   3.315252
3      B_15   3.253023
5      B_22   3.249675
25      B_9   3.007035
2      B_25   2.755298
1       B_8   2.167312
18      B_5   1.743062
22     B_36   1.567589
26     B_24   1.358121
13     B_41   1.322037
30     B_32   1.206611
9      B_26   1.092140
28     B_21   1.025883
14      B_6   1.018801
19     B_10   1.005132
16     B_40   1.002079

Top 10 de VIF - Iteración 5:
   Variable        VIF
28     B_31  31.704965
10      B_2  29.859309
26     B_18  24.663871
11     B_33  20.677086
6      B_16  10.539155
7      B_20   8.857876
20     B_28   7.929247
16      B_4   6.426630
4       B_3   6.171467
19      B_7   4.961537

Eliminando la variable &#39;B_31&#39; con VIF=31.70

Tabla de VIF después de eliminar &#39;B_31&#39;:
   Variable        VIF
28     B_31  31.704965
10      B_2  29.859309
26     B_18  24.663871
11     B_33  20.677086
6      B_16  10.539155
7      B_20   8.857876
20     B_28   7.929247
16      B_4   6.426630
4       B_3   6.171467
19      B_7   4.961537
8      B_19   4.487654
22     B_11   4.058679
12     B_27   3.758863
0      B_13   3.698684
23     B_12   3.314888
5      B_22   3.248767
3      B_15   3.245190
24      B_9   2.937770
2      B_25   2.683265
1       B_8   2.161280
17      B_5   1.742994
25     B_24   1.357472
13     B_41   1.321942
29     B_32   1.205667
21     B_36   1.168479
9      B_26   1.092108
27     B_21   1.024605
14      B_6   1.018797
18     B_10   1.005131
15     B_40   1.002079

Top 10 de VIF - Iteración 6:
   Variable        VIF
10      B_2  27.409282
11     B_33  20.480446
26     B_18  18.355610
6      B_16   9.165991
7      B_20   8.799465
20     B_28   7.728362
16      B_4   6.419122
4       B_3   6.171283
19      B_7   4.710375
8      B_19   4.454757

Eliminando la variable &#39;B_2&#39; con VIF=27.41

Tabla de VIF después de eliminar &#39;B_2&#39;:
   Variable        VIF
10      B_2  27.409282
11     B_33  20.480446
26     B_18  18.355610
6      B_16   9.165991
7      B_20   8.799465
20     B_28   7.728362
16      B_4   6.419122
4       B_3   6.171283
19      B_7   4.710375
8      B_19   4.454757
22     B_11   4.057341
0      B_13   3.698630
12     B_27   3.470208
23     B_12   3.314547
3      B_15   3.214107
5      B_22   3.203692
24      B_9   2.862089
2      B_25   2.668422
1       B_8   1.994196
17      B_5   1.742994
25     B_24   1.316470
13     B_41   1.316116
28     B_32   1.205652
21     B_36   1.168094
9      B_26   1.089965
27     B_21   1.022887
14      B_6   1.018797
18     B_10   1.005088
15     B_40   1.002074

Top 10 de VIF - Iteración 7:
   Variable        VIF
25     B_18  13.965337
10     B_33  13.095055
7      B_20   8.649142
6      B_16   8.635579
19     B_28   7.548524
15      B_4   6.409060
4       B_3   6.105117
18      B_7   4.708621
8      B_19   4.432283
21     B_11   4.042613

Eliminando la variable &#39;B_18&#39; con VIF=13.97

Tabla de VIF después de eliminar &#39;B_18&#39;:
   Variable        VIF
25     B_18  13.965337
10     B_33  13.095055
7      B_20   8.649142
6      B_16   8.635579
19     B_28   7.548524
15      B_4   6.409060
4       B_3   6.105117
18      B_7   4.708621
8      B_19   4.432283
21     B_11   4.042613
0      B_13   3.695501
11     B_27   3.442798
22     B_12   3.308219
3      B_15   3.204913
5      B_22   3.176240
23      B_9   2.857616
2      B_25   2.668148
1       B_8   1.992058
16      B_5   1.735122
12     B_41   1.315992
24     B_24   1.314615
27     B_32   1.205435
20     B_36   1.165065
9      B_26   1.089397
26     B_21   1.022812
13      B_6   1.018686
17     B_10   1.004992
14     B_40   1.002071

Top 10 de VIF - Iteración 8:
   Variable       VIF
6      B_16  8.579289
7      B_20  8.573727
19     B_28  7.309047
15      B_4  6.385461
4       B_3  6.105054
18      B_7  4.626300
8      B_19  4.422680
21     B_11  4.027386
0      B_13  3.690885
22     B_12  3.305679
Todas las variables tienen VIF &lt; 10. Se detiene el proceso.

Variables restantes en el grupo Delinquency después del cálculo de VIF:
       B_13       B_8      B_25      B_15       B_3      B_22      B_16  \
0  0.118075  0.006466  0.007729  0.016361  0.004709  0.004808  0.007665   
1  0.118737  0.001614  0.001864  0.017688  0.002714  0.001283  0.007148   
2  0.114534  0.005126  0.005419  0.063955  0.009423  0.009393  0.003636   
3  0.120740  0.001418  0.000646  0.022732  0.005531  0.004554  0.005896   
4  0.095178  0.001199  0.001833  0.031171  0.009312  0.000104  0.001714   

       B_20      B_19      B_26  ...      B_10       B_7      B_28      B_36  \
0  0.004730  0.008520  0.000272  ...  0.096219  0.059416  0.084683  0.009968   
1  0.003879  0.002238  0.000979  ...  0.099804  0.057744  0.081843  0.003921   
2  0.004578  0.000408  0.006149  ...  0.134073  0.056647  0.081954  0.001264   
3  0.005207  0.005897  0.009193  ...  0.134437  0.049253  0.060634  0.002729   
4  0.005851  0.007773  0.005738  ...  0.121518  0.048918  0.062492  0.009998   

       B_11      B_12       B_9      B_24      B_21      B_32  
0  0.002768  0.148266  0.008207  0.004327  0.002644  0.006626  
1  0.002749  0.143530  0.008373  0.004203  0.004193  0.001854  
2  0.010077  0.137014  0.009355  0.001782  0.001337  0.008686  
3  0.009667  0.129017  0.006782  0.005595  0.008716  0.002478  
4  0.009484  0.129539  0.000519  0.004933  0.006821  0.002199  

[5 rows x 27 columns]
</pre></div>
</div>
</div>
</div>
<p>Para el grupo de variables de Risk quedaron 23 variables con las que se trabajará.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">risk_df_filtered</span> <span class="o">=</span> <span class="n">process_vif_for_group</span><span class="p">(</span><span class="n">risk_imputed_pd</span><span class="p">,</span> <span class="s2">&quot;Risk&quot;</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">)</span>

<span class="c1"># Mostrar el resultado final de uno de los grupos</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Variables restantes en el grupo Delinquency después del cálculo de VIF:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">risk_df_filtered</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Procesando VIF para el grupo: Risk

Top 10 de VIF - Iteración 1:
   Variable        VIF
16      R_5  16.859688
2      R_12  14.537378
23      R_1  10.097198
0      R_27   8.905230
20      R_8   7.688986
13     R_13   5.401497
21      R_4   5.314055
11     R_17   5.176736
5       R_2   4.588230
9      R_24   3.308440

Eliminando la variable &#39;R_5&#39; con VIF=16.86

Tabla de VIF después de eliminar &#39;R_5&#39;:
   Variable        VIF
16      R_5  16.859688
2      R_12  14.537378
23      R_1  10.097198
0      R_27   8.905230
20      R_8   7.688986
13     R_13   5.401497
21      R_4   5.314055
11     R_17   5.176736
5       R_2   4.588230
9      R_24   3.308440
12     R_18   3.275168
17     R_10   2.732785
19      R_6   2.069323
14     R_15   1.948152
1      R_20   1.911374
22      R_3   1.910855
6      R_21   1.824909
3       R_7   1.666242
15     R_16   1.454766
25     R_19   1.267615
4      R_14   1.211125
18     R_11   1.188776
10     R_25   1.098611
8      R_23   1.094775
7      R_22   1.063653
24     R_28   1.055153

Top 10 de VIF - Iteración 2:
   Variable        VIF
2      R_12  11.954245
22      R_1  10.097130
0      R_27   8.801999
20      R_4   5.251129
5       R_2   4.573670
9      R_24   3.306062
12     R_18   3.267014
16     R_10   2.732700
18      R_6   2.067102
11     R_17   1.985107

Eliminando la variable &#39;R_12&#39; con VIF=11.95

Tabla de VIF después de eliminar &#39;R_12&#39;:
   Variable        VIF
2      R_12  11.954245
22      R_1  10.097130
0      R_27   8.801999
20      R_4   5.251129
5       R_2   4.573670
9      R_24   3.306062
12     R_18   3.267014
16     R_10   2.732700
18      R_6   2.067102
11     R_17   1.985107
13     R_13   1.960246
14     R_15   1.945838
1      R_20   1.907855
21      R_3   1.907317
6      R_21   1.824761
19      R_8   1.782045
3       R_7   1.666153
15     R_16   1.454746
24     R_19   1.267589
4      R_14   1.210881
17     R_11   1.188681
8      R_23   1.094637
10     R_25   1.089499
7      R_22   1.063370
23     R_28   1.055111

Top 10 de VIF - Iteración 3:
   Variable        VIF
21      R_1  10.086108
19      R_4   5.247799
4       R_2   4.571088
0      R_27   3.332104
8      R_24   3.304154
11     R_18   2.868037
15     R_10   2.723378
17      R_6   2.067046
13     R_15   1.945455
10     R_17   1.934970

Eliminando la variable &#39;R_1&#39; con VIF=10.09

Tabla de VIF después de eliminar &#39;R_1&#39;:
   Variable        VIF
21      R_1  10.086108
19      R_4   5.247799
4       R_2   4.571088
0      R_27   3.332104
8      R_24   3.304154
11     R_18   2.868037
15     R_10   2.723378
17      R_6   2.067046
13     R_15   1.945455
10     R_17   1.934970
12     R_13   1.922891
1      R_20   1.907110
5      R_21   1.818763
20      R_3   1.802456
18      R_8   1.781960
2       R_7   1.665925
14     R_16   1.453709
23     R_19   1.267005
3      R_14   1.210808
16     R_11   1.184515
7      R_23   1.090018
9      R_25   1.065007
6      R_22   1.061331
22     R_28   1.052069

Top 10 de VIF - Iteración 4:
   Variable       VIF
4       R_2  4.559060
19      R_4  4.013040
0      R_27  3.320058
11     R_18  2.867750
8      R_24  2.749860
17      R_6  2.067037
10     R_17  1.934891
12     R_13  1.922880
1      R_20  1.907109
20      R_3  1.801149
Todas las variables tienen VIF &lt; 10. Se detiene el proceso.

Variables restantes en el grupo Delinquency después del cálculo de VIF:
       R_27      R_20       R_7      R_14       R_2      R_21      R_22  \
0  1.008949  0.007782  0.007562  0.000438  0.006204  0.002450  0.007479   
1  1.003205  0.005987  0.005304  0.004311  0.006206  0.002247  0.006827   
2  1.000754  0.007291  0.001422  0.007139  0.003259  0.007794  0.009820   
3  1.005338  0.009977  0.006363  0.008690  0.009918  0.007686  0.000458   
4  1.003175  0.004105  0.004831  0.007816  0.006667  0.009656  0.003341   

       R_23      R_24      R_25  ...      R_15      R_16      R_10      R_11  \
0  0.006893  0.003950  0.003647  ...  0.006452  0.005055  0.007121  0.002456   
1  0.002837  0.008351  0.008850  ...  0.002332  0.003753  0.005966  0.000395   
2  0.005080  0.002471  0.009769  ...  0.008358  0.007381  0.005447  0.007345   
3  0.007320  0.008507  0.004858  ...  0.007364  0.008802  0.001888  0.004961   
4  0.000264  0.007190  0.002983  ...  0.002470  0.007166  0.006111  0.002246   

        R_6       R_8       R_4       R_3      R_28      R_19  
0  0.008363  0.001434  0.008298  0.001423  0.001535  0.005177  
1  0.004030  0.000509  0.005136  0.001984  0.004931  0.008979  
2  0.006838  0.008295  0.006961  0.007426  0.009123  0.002016  
3  0.008183  0.005153  0.008706  0.003515  0.002409  0.003909  
4  0.008605  0.007338  0.003846  0.001362  0.004462  0.003432  

[5 rows x 23 columns]
</pre></div>
</div>
</div>
</div>
<p>Para el grupo de variables de Spend quedaron 18 variables con las que se trabajará.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">spend_df_filtered</span> <span class="o">=</span> <span class="n">process_vif_for_group</span><span class="p">(</span><span class="n">spend_imputed_pd</span><span class="p">,</span> <span class="s2">&quot;Spend&quot;</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">)</span>

<span class="c1"># Mostrar el resultado final de uno de los grupos</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Variables restantes en el grupo Delinquency después del cálculo de VIF:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spend_df_filtered</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Procesando VIF para el grupo: Spend

Top 10 de VIF - Iteración 1:
   Variable        VIF
4      S_22  27.412734
5      S_24  23.273877
3       S_3  16.613958
6      S_25  15.129516
2       S_7  13.538254
10     S_15   9.697886
17      S_8   7.974427
12     S_11   5.925748
18     S_13   4.683235
19     S_19   3.560024

Eliminando la variable &#39;S_22&#39; con VIF=27.41

Tabla de VIF después de eliminar &#39;S_22&#39;:
   Variable        VIF
4      S_22  27.412734
5      S_24  23.273877
3       S_3  16.613958
6      S_25  15.129516
2       S_7  13.538254
10     S_15   9.697886
17      S_8   7.974427
12     S_11   5.925748
18     S_13   4.683235
19     S_19   3.560024
1      S_27   2.195583
16     S_12   1.995826
15      S_6   1.851806
0       S_9   1.382126
8      S_23   1.244610
20     S_20   1.229782
13     S_16   1.171490
11     S_18   1.140237
9       S_5   1.115654
7      S_26   1.095688
14     S_17   1.044328

Top 10 de VIF - Iteración 2:
   Variable        VIF
3       S_3  16.613759
5      S_25  15.035606
2       S_7  13.538183
9      S_15   9.621549
16      S_8   7.954209
11     S_11   5.919332
17     S_13   4.676572
18     S_19   3.558206
1      S_27   2.195583
4      S_24   2.030758

Eliminando la variable &#39;S_3&#39; con VIF=16.61

Tabla de VIF después de eliminar &#39;S_3&#39;:
   Variable        VIF
3       S_3  16.613759
5      S_25  15.035606
2       S_7  13.538183
9      S_15   9.621549
16      S_8   7.954209
11     S_11   5.919332
17     S_13   4.676572
18     S_19   3.558206
1      S_27   2.195583
4      S_24   2.030758
15     S_12   1.995708
14      S_6   1.838042
0       S_9   1.381687
7      S_23   1.236787
19     S_20   1.229774
12     S_16   1.171485
10     S_18   1.140235
8       S_5   1.115654
6      S_26   1.095687
13     S_17   1.044328

Top 10 de VIF - Iteración 3:
   Variable        VIF
4      S_25  15.035230
8      S_15   9.096793
15      S_8   7.921197
10     S_11   5.913305
16     S_13   4.581742
17     S_19   3.558039
2       S_7   3.142886
1      S_27   2.194446
3      S_24   2.030728
14     S_12   1.995587

Eliminando la variable &#39;S_25&#39; con VIF=15.04

Tabla de VIF después de eliminar &#39;S_25&#39;:
   Variable        VIF
4      S_25  15.035230
8      S_15   9.096793
15      S_8   7.921197
10     S_11   5.913305
16     S_13   4.581742
17     S_19   3.558039
2       S_7   3.142886
1      S_27   2.194446
3      S_24   2.030728
14     S_12   1.995587
13      S_6   1.825882
0       S_9   1.380445
6      S_23   1.236782
18     S_20   1.224779
11     S_16   1.168418
9      S_18   1.138292
7       S_5   1.115638
5      S_26   1.095617
12     S_17   1.042538

Top 10 de VIF - Iteración 4:
   Variable       VIF
7      S_15  5.841482
14      S_8  5.421832
9      S_11  5.359235
15     S_13  4.324126
16     S_19  3.477477
2       S_7  3.141375
1      S_27  2.171667
3      S_24  2.030049
13     S_12  1.986931
12      S_6  1.688932
Todas las variables tienen VIF &lt; 10. Se detiene el proceso.

Variables restantes en el grupo Delinquency después del cálculo de VIF:
        S_9      S_27       S_7      S_24      S_26      S_23       S_5  \
0  0.065728  0.676922  0.161345  0.911191  0.001243  0.135561  0.023381   
1  0.093935  0.822281  0.140951  0.919876  0.004561  0.136333  0.030599   
2  0.084757  0.853498  0.112229  0.958699  0.011736  0.134938  0.048367   
3  0.048382  0.844667  0.102838  0.926341  0.007571  0.140058  0.030063   
4  0.039259  0.811199  0.094311  0.933479  0.018200  0.131620  0.054221   

       S_15      S_18      S_11      S_16      S_17       S_6      S_12  \
0  0.108271  0.005720  0.401619  0.002271  0.008033  0.008322  0.272008   
1  0.101018  0.007584  0.406326  0.009810  0.000760  0.002482  0.188970   
2  0.103239  0.005901  0.406768  0.009362  0.004056  0.000530  0.495308   
3  0.206394  0.002520  0.405175  0.004876  0.006969  0.000783  0.508670   
4  0.106020  0.000155  0.487460  0.007447  0.001770  0.006698  0.216507   

        S_8      S_13      S_19      S_20  
0  0.922998  0.515222  0.002537  0.009705  
1  0.919414  0.509048  0.008427  0.009924  
2  1.001977  0.679257  0.007327  0.008446  
3  0.704016  0.515282  0.007053  0.006614  
4  0.917133  0.507712  0.007728  0.005511  
</pre></div>
</div>
</div>
</div>
<p>Para el grupo de variables de Payment quedaron 3 variables con las que se trabajará.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">payment_df_filtered</span> <span class="o">=</span> <span class="n">process_vif_for_group</span><span class="p">(</span><span class="n">payment_imputed_pd</span><span class="p">,</span> <span class="s2">&quot;Payment&quot;</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">)</span>

<span class="c1"># Mostrar el resultado final de uno de los grupos</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Variables restantes en el grupo Delinquency después del cálculo de VIF:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">payment_df_filtered</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Procesando VIF para el grupo: Payment

Top 10 de VIF - Iteración 1:
  Variable       VIF
0      P_3  9.422532
1      P_2  8.967503
2      P_4  1.167881
Todas las variables tienen VIF &lt; 10. Se detiene el proceso.

Variables restantes en el grupo Delinquency después del cálculo de VIF:
        P_3       P_2       P_4
0  0.736463  0.938469  0.007554
1  0.720886  0.936665  0.004832
2  0.738044  0.954180  0.006561
3  0.741813  0.960384  0.009559
4  0.691986  0.947248  0.008156
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Función para agregar &#39;customer_ID&#39; y &#39;Date&#39; si no están presentes en un DataFrame</span>
<span class="c1"># def add_customer_id_and_date(df, original_data, date_source):</span>
<span class="c1">#     if &#39;customer_ID&#39; not in df.columns:</span>
<span class="c1">#         if &#39;customer_ID&#39; in original_data.columns:</span>
<span class="c1">#             df[&#39;customer_ID&#39;] = original_data[&#39;customer_ID&#39;]</span>
<span class="c1">#         else:</span>
<span class="c1">#             raise KeyError(&quot;La columna &#39;customer_ID&#39; no se encuentra en el DataFrame original.&quot;)</span>

<span class="c1">#     if &#39;Date&#39; not in df.columns:</span>
<span class="c1">#         if &#39;Date&#39; in date_source.columns:</span>
<span class="c1">#             df[&#39;Date&#39;] = date_source[&#39;Date&#39;]</span>
<span class="c1">#         else:</span>
<span class="c1">#             raise KeyError(&quot;La columna &#39;Date&#39; no se encuentra en el DataFrame de origen.&quot;)</span>

<span class="c1">#     return df</span>

<span class="c1"># # Función para reindexar y asegurar índices únicos</span>
<span class="c1"># def reset_index_unique(df):</span>
<span class="c1">#     df = df.reset_index(drop=True)  # Reindexar para asegurar índices únicos</span>
<span class="c1">#     return df</span>

<span class="c1"># # Asegurarse de que cada DataFrame tenga &#39;customer_ID&#39; y &#39;Date&#39; y que los índices sean únicos</span>
<span class="c1"># # Aquí paso &#39;data_train&#39; para &#39;customer_ID&#39; y &#39;data&#39; para &#39;Date&#39;</span>
<span class="c1"># delinquency_imputed_pd = add_customer_id_and_date(delinquency_imputed_pd, data_train, data)</span>
<span class="c1"># balance_df_filtered = add_customer_id_and_date(balance_df_filtered, data_train, data)</span>
<span class="c1"># risk_df_filtered = add_customer_id_and_date(risk_df_filtered, data_train, data)</span>
<span class="c1"># spend_df_filtered = add_customer_id_and_date(spend_df_filtered, data_train, data)</span>
<span class="c1"># payment_df_filtered = add_customer_id_and_date(payment_df_filtered, data_train, data)</span>

<span class="c1"># # Reindexar para asegurarnos de que no haya conflictos de índice</span>
<span class="c1"># delinquency_imputed_pd = reset_index_unique(delinquency_imputed_pd)</span>
<span class="c1"># balance_df_filtered = reset_index_unique(balance_df_filtered)</span>
<span class="c1"># risk_df_filtered = reset_index_unique(risk_df_filtered)</span>
<span class="c1"># spend_df_filtered = reset_index_unique(spend_df_filtered)</span>
<span class="c1"># payment_df_filtered = reset_index_unique(payment_df_filtered)</span>

<span class="c1"># # Concatenar todos los DataFrames horizontalmente</span>
<span class="c1"># final_data = pd.concat([delinquency_imputed_pd, balance_df_filtered, risk_df_filtered, spend_df_filtered, payment_df_filtered], axis=1)</span>

<span class="c1"># # Eliminar posibles duplicados de &#39;customer_ID&#39; y &#39;Date&#39; después de la concatenación</span>
<span class="c1"># final_data = final_data.loc[:, ~final_data.columns.duplicated()]</span>

<span class="c1"># # Reorganizar las columnas para colocar &#39;customer_ID&#39;, &#39;target&#39;, y &#39;Date&#39; al principio</span>
<span class="c1"># columns_order = [&#39;customer_ID&#39;, &#39;target&#39;, &#39;Date&#39;] + [col for col in final_data.columns if col not in [&#39;customer_ID&#39;, &#39;target&#39;, &#39;Date&#39;]]</span>
<span class="c1"># final_data = final_data[columns_order]</span>

<span class="c1"># # Mostrar las primeras filas del DataFrame concatenado</span>
<span class="c1"># print(final_data.head())</span>

<span class="c1"># # Confirmar si &#39;customer_ID&#39; y &#39;Date&#39; están presentes en el DataFrame final</span>
<span class="c1"># if &#39;customer_ID&#39; not in final_data.columns or &#39;Date&#39; not in final_data.columns:</span>
<span class="c1">#     raise KeyError(&quot;Las columnas &#39;customer_ID&#39; o &#39;Date&#39; no están presentes en el DataFrame concatenado.&quot;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="c1">#Primero nos aseguramos de que &#39;customer_ID&#39; esté presente en cada DataFrame</span>
<span class="k">def</span> <span class="nf">add_customer_id</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">original_data</span><span class="p">):</span>
    <span class="k">if</span> <span class="s1">&#39;customer_ID&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;customer_ID&#39;</span> <span class="ow">in</span> <span class="n">original_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">original_data</span><span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;La columna &#39;customer_ID&#39; no se encuentra en el DataFrame original.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="c1"># Reindexar los DataFrames para asegurarse de que tengan índices únicos</span>
<span class="k">def</span> <span class="nf">reset_index_unique</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Reindexar para asegurar índices únicos</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="c1"># Aplicar la función para agregar &#39;customer_ID&#39; y asegurar índices únicos</span>
<span class="n">delinquency_imputed_pd</span> <span class="o">=</span> <span class="n">reset_index_unique</span><span class="p">(</span><span class="n">delinquency_imputed_pd</span><span class="p">)</span>
<span class="n">balance_df_filtered</span> <span class="o">=</span> <span class="n">reset_index_unique</span><span class="p">(</span><span class="n">balance_df_filtered</span><span class="p">)</span>
<span class="n">risk_df_filtered</span> <span class="o">=</span> <span class="n">reset_index_unique</span><span class="p">(</span><span class="n">risk_df_filtered</span><span class="p">)</span>
<span class="n">spend_df_filtered</span> <span class="o">=</span> <span class="n">reset_index_unique</span><span class="p">(</span><span class="n">spend_df_filtered</span><span class="p">)</span>
<span class="n">payment_df_filtered</span> <span class="o">=</span> <span class="n">reset_index_unique</span><span class="p">(</span><span class="n">payment_df_filtered</span><span class="p">)</span>

<span class="c1"># Concatenar todos los DataFrames horizontalmente (por columnas)</span>
<span class="n">final_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">delinquency_imputed_pd</span><span class="p">,</span> <span class="n">balance_df_filtered</span><span class="p">,</span> <span class="n">risk_df_filtered</span><span class="p">,</span> <span class="n">spend_df_filtered</span><span class="p">,</span> <span class="n">payment_df_filtered</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Eliminar posibles duplicados de &#39;customer_ID&#39; si hay varias columnas tras la concatenación</span>
<span class="n">final_data</span> <span class="o">=</span> <span class="n">final_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="o">~</span><span class="n">final_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>

<span class="c1"># Mostrar las primeras filas del DataFrame concatenado</span>
<span class="nb">print</span><span class="p">(</span><span class="n">final_data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      D_105      D_56      D_77      D_43      D_46      D_62      D_48  \
0  0.893734  0.152025  0.205833  0.088512  0.358587  0.091071  0.255736   
1  0.906841  0.156201  0.205833  0.088512  0.353630  0.086805  0.223329   
2  0.928719  0.153795  0.205833  0.088512  0.334650  0.094001  0.189424   
3  0.935383  0.155772  0.205833  0.088512  0.323271  0.094854  0.135586   
4  0.953363  0.154914  0.205833  0.088512  0.231009  0.093915  0.286172   

       D_61      D_78      D_44  ...      S_17       S_6      S_12       S_8  \
0  0.308233  0.001576  0.000630  ...  0.008033  0.008322  0.272008  0.922998   
1  0.265026  0.009896  0.002526  ...  0.000760  0.002482  0.188970  0.919414   
2  0.212165  0.009629  0.007605  ...  0.004056  0.000530  0.495308  1.001977   
3  0.204300  0.008568  0.006406  ...  0.006969  0.000783  0.508670  0.704016   
4  0.175655  0.003289  0.007731  ...  0.001770  0.006698  0.216507  0.917133   

       S_13      S_19      S_20       P_3       P_2       P_4  
0  0.515222  0.002537  0.009705  0.736463  0.938469  0.007554  
1  0.509048  0.008427  0.009924  0.720886  0.936665  0.004832  
2  0.679257  0.007327  0.008446  0.738044  0.954180  0.006561  
3  0.515282  0.007053  0.006614  0.741813  0.960384  0.009559  
4  0.507712  0.007728  0.005511  0.691986  0.947248  0.008156  

[5 rows x 140 columns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mounted at /content/drive
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lista de las variables que quedaron después del cálculo de VIF para cada grupo</span>
<span class="c1"># delinquency_variables = delinquency_df_filtered.columns.tolist()</span>
<span class="n">balance_variables</span> <span class="o">=</span> <span class="n">balance_df_filtered</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">risk_variables</span> <span class="o">=</span> <span class="n">risk_df_filtered</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">spend_variables</span> <span class="o">=</span> <span class="n">spend_df_filtered</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">payment_variables</span> <span class="o">=</span> <span class="n">payment_df_filtered</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Filtrar las variables de cada grupo en los DataFrames originales (imputados)</span>
<span class="c1"># delinquency_imputed_filtered = spend_imputed_pd[delinquency_variables]</span>
<span class="n">balance_imputed_filtered</span> <span class="o">=</span> <span class="n">balance_imputed_pd</span><span class="p">[</span><span class="n">balance_variables</span><span class="p">]</span>
<span class="n">risk_imputed_filtered</span> <span class="o">=</span> <span class="n">risk_imputed_pd</span><span class="p">[</span><span class="n">risk_variables</span><span class="p">]</span>
<span class="n">spend_imputed_filtered</span> <span class="o">=</span> <span class="n">spend_imputed_pd</span><span class="p">[</span><span class="n">spend_variables</span><span class="p">]</span>
<span class="n">payment_imputed_filtered</span> <span class="o">=</span> <span class="n">payment_imputed_pd</span><span class="p">[</span><span class="n">payment_variables</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">balance_variables</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">risk_variables</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spend_variables</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">payment_variables</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;B_13&#39;, &#39;B_8&#39;, &#39;B_25&#39;, &#39;B_15&#39;, &#39;B_3&#39;, &#39;B_22&#39;, &#39;B_16&#39;, &#39;B_20&#39;, &#39;B_19&#39;, &#39;B_26&#39;, &#39;B_33&#39;, &#39;B_27&#39;, &#39;B_41&#39;, &#39;B_6&#39;, &#39;B_40&#39;, &#39;B_4&#39;, &#39;B_5&#39;, &#39;B_10&#39;, &#39;B_7&#39;, &#39;B_28&#39;, &#39;B_36&#39;, &#39;B_11&#39;, &#39;B_12&#39;, &#39;B_9&#39;, &#39;B_24&#39;, &#39;B_21&#39;, &#39;B_32&#39;]
[&#39;R_27&#39;, &#39;R_20&#39;, &#39;R_7&#39;, &#39;R_14&#39;, &#39;R_2&#39;, &#39;R_21&#39;, &#39;R_22&#39;, &#39;R_23&#39;, &#39;R_24&#39;, &#39;R_25&#39;, &#39;R_17&#39;, &#39;R_18&#39;, &#39;R_13&#39;, &#39;R_15&#39;, &#39;R_16&#39;, &#39;R_10&#39;, &#39;R_11&#39;, &#39;R_6&#39;, &#39;R_8&#39;, &#39;R_4&#39;, &#39;R_3&#39;, &#39;R_28&#39;, &#39;R_19&#39;]
[&#39;S_9&#39;, &#39;S_27&#39;, &#39;S_7&#39;, &#39;S_24&#39;, &#39;S_26&#39;, &#39;S_23&#39;, &#39;S_5&#39;, &#39;S_15&#39;, &#39;S_18&#39;, &#39;S_11&#39;, &#39;S_16&#39;, &#39;S_17&#39;, &#39;S_6&#39;, &#39;S_12&#39;, &#39;S_8&#39;, &#39;S_13&#39;, &#39;S_19&#39;, &#39;S_20&#39;]
[&#39;P_3&#39;, &#39;P_2&#39;, &#39;P_4&#39;]
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="analisis-exploratorio-de-los-datos">
<h1>Análisis Exploratorio de los datos<a class="headerlink" href="#analisis-exploratorio-de-los-datos" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ruta donde guardaste los archivos en Google Drive</span>
<span class="n">input_dir</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/My Drive/&#39;</span>

<span class="c1"># Cargar los archivos CSV en DataFrames de pandas</span>
<span class="n">delinquency_imputed_pd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">input_dir</span> <span class="o">+</span> <span class="s1">&#39;delinquency_imputed_pd.csv&#39;</span><span class="p">)</span>
<span class="n">balance_imputed_filtered</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">input_dir</span> <span class="o">+</span> <span class="s1">&#39;balance_imputed_filtered.csv&#39;</span><span class="p">)</span>
<span class="n">risk_imputed_filtered</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">input_dir</span> <span class="o">+</span> <span class="s1">&#39;risk_imputed_filtered.csv&#39;</span><span class="p">)</span>
<span class="n">spend_imputed_filtered</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">input_dir</span> <span class="o">+</span> <span class="s1">&#39;spend_imputed_filtered.csv&#39;</span><span class="p">)</span>
<span class="n">payment_imputed_filtered</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">input_dir</span> <span class="o">+</span> <span class="s1">&#39;payment_imputed_filtered.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">convert_to_pandas</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convierte un DataFrame de Dask a Pandas si es necesario.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">dd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="k">def</span> <span class="nf">concatenate_and_add_date</span><span class="p">(</span><span class="n">delinquency_df</span><span class="p">,</span> <span class="n">balance_df</span><span class="p">,</span> <span class="n">risk_df</span><span class="p">,</span> <span class="n">spend_df</span><span class="p">,</span> <span class="n">payment_df</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="c1"># Convertir todos los DataFrames de Dask a Pandas si es necesario</span>
    <span class="n">delinquency_df</span> <span class="o">=</span> <span class="n">convert_to_pandas</span><span class="p">(</span><span class="n">delinquency_df</span><span class="p">)</span>
    <span class="n">balance_df</span> <span class="o">=</span> <span class="n">convert_to_pandas</span><span class="p">(</span><span class="n">balance_df</span><span class="p">)</span>
    <span class="n">risk_df</span> <span class="o">=</span> <span class="n">convert_to_pandas</span><span class="p">(</span><span class="n">risk_df</span><span class="p">)</span>
    <span class="n">spend_df</span> <span class="o">=</span> <span class="n">convert_to_pandas</span><span class="p">(</span><span class="n">spend_df</span><span class="p">)</span>
    <span class="n">payment_df</span> <span class="o">=</span> <span class="n">convert_to_pandas</span><span class="p">(</span><span class="n">payment_df</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">convert_to_pandas</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># Concatenar todos los DataFrames horizontalmente</span>
    <span class="n">final_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">delinquency_df</span><span class="p">,</span> <span class="n">balance_df</span><span class="p">,</span> <span class="n">risk_df</span><span class="p">,</span> <span class="n">spend_df</span><span class="p">,</span> <span class="n">payment_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Eliminar posibles duplicados de &#39;customer_ID&#39; después de la concatenación</span>
    <span class="n">final_data</span> <span class="o">=</span> <span class="n">final_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="o">~</span><span class="n">final_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>

    <span class="c1"># Asegurarse de que &#39;customer_ID&#39; esté presente en el DataFrame concatenado</span>
    <span class="k">if</span> <span class="s1">&#39;customer_ID&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">final_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;La columna &#39;customer_ID&#39; no está presente en el DataFrame concatenado.&quot;</span><span class="p">)</span>

    <span class="c1"># Agregar la columna &#39;Date&#39; desde el DataFrame &#39;data&#39;, basado en &#39;customer_ID&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;Date&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="s1">&#39;customer_ID&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">final_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">final_data</span><span class="p">,</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">]],</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;La columna &#39;Date&#39; o &#39;customer_ID&#39; no está presente en el DataFrame &#39;data&#39;.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">final_data</span>

<span class="c1"># Uso de la función</span>
<span class="n">final_data</span> <span class="o">=</span> <span class="n">concatenate_and_add_date</span><span class="p">(</span>
    <span class="n">delinquency_imputed_pd</span><span class="p">,</span>
    <span class="n">balance_imputed_filtered</span><span class="p">,</span>
    <span class="n">risk_imputed_filtered</span><span class="p">,</span>
    <span class="n">spend_imputed_filtered</span><span class="p">,</span>
    <span class="n">payment_imputed_filtered</span><span class="p">,</span>
    <span class="n">data</span>  <span class="c1"># Este es el DataFrame que contiene la columna &#39;Date&#39;</span>
<span class="p">)</span>

<span class="c1"># Mostrar las primeras filas del DataFrame final</span>
<span class="nb">print</span><span class="p">(</span><span class="n">final_data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">final_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;D_105&#39;, &#39;D_56&#39;, &#39;D_77&#39;, &#39;D_43&#39;, &#39;D_46&#39;, &#39;D_62&#39;, &#39;D_48&#39;, &#39;D_61&#39;, &#39;D_78&#39;, &#39;D_44&#39;, &#39;D_83&#39;, &#39;D_69&#39;, &#39;D_55&#39;, &#39;D_124&#39;, &#39;D_119&#39;, &#39;D_118&#39;, &#39;D_115&#39;, &#39;D_113&#39;, &#39;D_125&#39;, &#39;D_121&#39;, &#39;D_122&#39;, &#39;D_123&#39;, &#39;D_91&#39;, &#39;D_59&#39;, &#39;D_141&#39;, &#39;D_131&#39;, &#39;D_139&#39;, &#39;D_145&#39;, &#39;D_130&#39;, &#39;D_129&#39;, &#39;D_103&#39;, &#39;D_107&#39;, &#39;D_104&#39;, &#39;D_143&#39;, &#39;D_128&#39;, &#39;D_70&#39;, &#39;D_79&#39;, &#39;D_133&#39;, &#39;D_144&#39;, &#39;D_102&#39;, &#39;D_140&#39;, &#39;D_84&#39;, &#39;D_89&#39;, &#39;D_52&#39;, &#39;D_81&#39;, &#39;D_72&#39;, &#39;D_74&#39;, &#39;D_80&#39;, &#39;D_112&#39;, &#39;D_45&#39;, &#39;D_54&#39;, &#39;D_41&#39;, &#39;D_109&#39;, &#39;D_47&#39;, &#39;D_127&#39;, &#39;D_92&#39;, &#39;D_93&#39;, &#39;D_94&#39;, &#39;D_65&#39;, &#39;D_86&#39;, &#39;D_96&#39;, &#39;D_58&#39;, &#39;D_60&#39;, &#39;D_51&#39;, &#39;D_75&#39;, &#39;D_71&#39;, &#39;D_39&#39;, &#39;customer_ID&#39;, &#39;target&#39;, &#39;B_13&#39;, &#39;B_8&#39;, &#39;B_25&#39;, &#39;B_15&#39;, &#39;B_3&#39;, &#39;B_22&#39;, &#39;B_16&#39;, &#39;B_20&#39;, &#39;B_19&#39;, &#39;B_26&#39;, &#39;B_33&#39;, &#39;B_27&#39;, &#39;B_41&#39;, &#39;B_6&#39;, &#39;B_40&#39;, &#39;B_4&#39;, &#39;B_5&#39;, &#39;B_10&#39;, &#39;B_7&#39;, &#39;B_28&#39;, &#39;B_36&#39;, &#39;B_11&#39;, &#39;B_12&#39;, &#39;B_9&#39;, &#39;B_24&#39;, &#39;B_21&#39;, &#39;B_32&#39;, &#39;R_27&#39;, &#39;R_20&#39;, &#39;R_7&#39;, &#39;R_14&#39;, &#39;R_2&#39;, &#39;R_21&#39;, &#39;R_22&#39;, &#39;R_23&#39;, &#39;R_24&#39;, &#39;R_25&#39;, &#39;R_17&#39;, &#39;R_18&#39;, &#39;R_13&#39;, &#39;R_15&#39;, &#39;R_16&#39;, &#39;R_10&#39;, &#39;R_11&#39;, &#39;R_6&#39;, &#39;R_8&#39;, &#39;R_4&#39;, &#39;R_3&#39;, &#39;R_28&#39;, &#39;R_19&#39;, &#39;S_9&#39;, &#39;S_27&#39;, &#39;S_7&#39;, &#39;S_24&#39;, &#39;S_26&#39;, &#39;S_23&#39;, &#39;S_5&#39;, &#39;S_15&#39;, &#39;S_18&#39;, &#39;S_11&#39;, &#39;S_16&#39;, &#39;S_17&#39;, &#39;S_6&#39;, &#39;S_12&#39;, &#39;S_8&#39;, &#39;S_13&#39;, &#39;S_19&#39;, &#39;S_20&#39;, &#39;P_3&#39;, &#39;P_2&#39;, &#39;P_4&#39;, &#39;Date&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">filas</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">final_data</span><span class="p">)</span>
<span class="n">columnas</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">final_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Número de filas:&quot;</span><span class="p">,</span> <span class="n">filas</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Número de columnas:&quot;</span><span class="p">,</span> <span class="n">columnas</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="visualizacion-descriptiva">
<h2>Visualización descriptiva<a class="headerlink" href="#visualizacion-descriptiva" title="Link to this heading">#</a></h2>
<section id="variable-objetivo">
<h3>Variable Objetivo<a class="headerlink" href="#variable-objetivo" title="Link to this heading">#</a></h3>
</section>
<section id="variables-predictoras-numericas">
<h3>Variables predictoras numéricas<a class="headerlink" href="#variables-predictoras-numericas" title="Link to this heading">#</a></h3>
<p>A continuación se presentan las estadísticas descriptivas del conjunto de datos para conocer su distribución y densidad. En primera instancia se indaga sobre su curtosis, simetría, media, mediana, apuntamiento, etc. Se toma el análisis de manera individual por grupo, para agilizar el procesamiento y facilitar las visualizaciones.</p>
<section id="para-el-grupo-payment">
<h4>Para el grupo <code class="docutils literal notranslate"><span class="pre">Payment</span></code><a class="headerlink" href="#para-el-grupo-payment" title="Link to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">1.</span> <span class="pre">P_3:</span></code></p>
<ul class="simple">
<li><p>Media (mean): 0.5993, lo que indica que el valor promedio de la variable es cercano a 0.60.</p></li>
<li><p>Mínimo (min): -1.5197, lo cual sugiere la presencia de valores negativos, posiblemente una desviación considerable en los datos.</p></li>
<li><p>Primer cuartil (25%): 0.5377, indicando que el 25% de los datos tiene valores inferiores a este.</p></li>
<li><p>Mediana (50%): 0.6150, lo que significa que el 50% de los valores está por debajo de 0.6150, muy cercano a la media.</p></li>
<li><p>Tercer cuartil (75%): 0.6792, lo que indica que el 75% de los valores está por debajo de este umbral.</p></li>
<li><p>Máximo (max): 2.4281, un valor bastante más elevado que la media.</p></li>
<li><p>Simetría (Skewness): -1.1498, lo que indica que la distribución está sesgada a la izquierda, con valores más concentrados en el extremo alto de la distribución.</p></li>
<li><p>Curtosis (Kurtosis): 9.9793, una curtosis elevada que sugiere la presencia de valores atípicos extremos.</p></li>
<li><p>Varianza: 0.0278, consistente con una dispersión baja en los datos.</p></li>
<li><p>Desviación estándar: 0.1668, indica una ligera dispersión en los datos, algo que refuerza lo indicado por la varianza.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">2.</span> <span class="pre">P_2:</span></code></p>
<ul class="simple">
<li><p>Media (mean): 0.6561, ligeramente más alta que en la variable anterior.</p></li>
<li><p>Desviación estándar (std): 0.2441, una dispersión más elevada que en P_3, lo que indica mayor variabilidad en los datos.</p></li>
<li><p>Mínimo (min): -0.4590, con valores negativos, pero menos extremos que en P_3.
Primer cuartil (25%): 0.4803, lo que sugiere que el 25% de los valores está por debajo de este número.</p></li>
<li><p>Mediana (50%): 0.6943, mostrando una concentración mayor de valores por encima de la media.</p></li>
<li><p>Tercer cuartil (75%): 0.8637, lo que indica que el 75% de los valores está por debajo de este umbral.</p></li>
<li><p>Máximo (max): 1.0353, mucho más cercano a la media que el máximo de P_3.</p></li>
<li><p>Simetría (Skewness): -0.6261, indicando una leve asimetría hacia la izquierda.</p></li>
<li><p>Curtosis (Kurtosis): 2.7609, lo que indica una distribución ligeramente más afilada que una distribución normal, pero no tanto como en P_3.</p></li>
<li><p>Varianza: 0.0596, que es mayor que en P_3 y refuerza la mayor dispersión observada.</p></li>
<li><p>Desviación estándar: 0.2441, consistente con una mayor variabilidad en los datos.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">3.</span> <span class="pre">P_4:</span></code></p>
<ul class="simple">
<li><p>Media (mean): 0.1439, lo que sugiere que la mayoría de los datos se concentran en valores bajos.</p></li>
<li><p>Mínimo (min): 0.0000, sugiriendo que hay valores nulos.</p></li>
<li><p>Primer cuartil (25%): 0.0029, lo que indica que el 25% de los valores es muy bajo.</p></li>
<li><p>Mediana (50%): 0.0058, que confirma que la mayor parte de los valores es muy baja.</p></li>
<li><p>Tercer cuartil (75%): 0.0088, lo que también muestra una alta concentración de valores cercanos a cero.</p></li>
<li><p>Máximo (max): 1.2694, un valor mucho más alto que la media, sugiriendo la presencia de valores atípicos.</p></li>
<li><p>Simetría (Skewness): 2.0264, mostrando una distribución con fuerte asimetría hacia la derecha.</p></li>
<li><p>Curtosis (Kurtosis): 5.1148, lo que sugiere que la distribución está fuertemente sesgada y tiene una concentración alta de valores extremos.</p></li>
<li><p>Varianza: 0.1144, que es mucho mayor que en las otras dos variables, indicando una mayor dispersión en los datos.</p></li>
<li><p>Desviación estándar: 0.3383, refuerza la mayor dispersión y variabilidad en comparación con las otras dos variables.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">skew</span><span class="p">,</span> <span class="n">kurtosis</span>

<span class="c1"># Seleccionar solo las columnas numéricas del DataFrame</span>
<span class="n">numerical_data</span> <span class="o">=</span> <span class="n">payment_imputed_filtered</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span>

<span class="c1"># Calcular estadísticas básicas</span>
<span class="n">basic_stats</span> <span class="o">=</span> <span class="n">numerical_data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># Transponer para mejor visualización</span>

<span class="c1"># Calcular la simetría (skewness) y curtosis</span>
<span class="n">basic_stats</span><span class="p">[</span><span class="s1">&#39;Skewness&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numerical_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">skew</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dropna</span><span class="p">()))</span>
<span class="n">basic_stats</span><span class="p">[</span><span class="s1">&#39;Kurtosis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numerical_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">kurtosis</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">fisher</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="c1"># Añadir la varianza</span>
<span class="n">basic_stats</span><span class="p">[</span><span class="s1">&#39;Variance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numerical_data</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
<span class="n">styled_basic_stats</span> <span class="o">=</span> <span class="n">basic_stats</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># Format to 2 decimal places</span>
<span class="n">display</span><span class="p">(</span><span class="n">styled_basic_stats</span><span class="p">)</span> <span class="c1"># Display using IPython&#39;s display function</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_3b18c" class="dataframe">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_3b18c_level0_col0" class="col_heading level0 col0" >count</th>
      <th id="T_3b18c_level0_col1" class="col_heading level0 col1" >mean</th>
      <th id="T_3b18c_level0_col2" class="col_heading level0 col2" >std</th>
      <th id="T_3b18c_level0_col3" class="col_heading level0 col3" >min</th>
      <th id="T_3b18c_level0_col4" class="col_heading level0 col4" >25%</th>
      <th id="T_3b18c_level0_col5" class="col_heading level0 col5" >50%</th>
      <th id="T_3b18c_level0_col6" class="col_heading level0 col6" >75%</th>
      <th id="T_3b18c_level0_col7" class="col_heading level0 col7" >max</th>
      <th id="T_3b18c_level0_col8" class="col_heading level0 col8" >Skewness</th>
      <th id="T_3b18c_level0_col9" class="col_heading level0 col9" >Kurtosis</th>
      <th id="T_3b18c_level0_col10" class="col_heading level0 col10" >Variance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_3b18c_level0_row0" class="row_heading level0 row0" >P_3</th>
      <td id="T_3b18c_row0_col0" class="data row0 col0" >5531451.0000</td>
      <td id="T_3b18c_row0_col1" class="data row0 col1" >0.5993</td>
      <td id="T_3b18c_row0_col2" class="data row0 col2" >0.1668</td>
      <td id="T_3b18c_row0_col3" class="data row0 col3" >-1.5197</td>
      <td id="T_3b18c_row0_col4" class="data row0 col4" >0.5377</td>
      <td id="T_3b18c_row0_col5" class="data row0 col5" >0.6150</td>
      <td id="T_3b18c_row0_col6" class="data row0 col6" >0.6792</td>
      <td id="T_3b18c_row0_col7" class="data row0 col7" >2.4281</td>
      <td id="T_3b18c_row0_col8" class="data row0 col8" >-1.1498</td>
      <td id="T_3b18c_row0_col9" class="data row0 col9" >9.9793</td>
      <td id="T_3b18c_row0_col10" class="data row0 col10" >0.0278</td>
    </tr>
    <tr>
      <th id="T_3b18c_level0_row1" class="row_heading level0 row1" >P_2</th>
      <td id="T_3b18c_row1_col0" class="data row1 col0" >5531451.0000</td>
      <td id="T_3b18c_row1_col1" class="data row1 col1" >0.6561</td>
      <td id="T_3b18c_row1_col2" class="data row1 col2" >0.2441</td>
      <td id="T_3b18c_row1_col3" class="data row1 col3" >-0.4590</td>
      <td id="T_3b18c_row1_col4" class="data row1 col4" >0.4803</td>
      <td id="T_3b18c_row1_col5" class="data row1 col5" >0.6943</td>
      <td id="T_3b18c_row1_col6" class="data row1 col6" >0.8637</td>
      <td id="T_3b18c_row1_col7" class="data row1 col7" >1.0353</td>
      <td id="T_3b18c_row1_col8" class="data row1 col8" >-0.6261</td>
      <td id="T_3b18c_row1_col9" class="data row1 col9" >2.7609</td>
      <td id="T_3b18c_row1_col10" class="data row1 col10" >0.0596</td>
    </tr>
    <tr>
      <th id="T_3b18c_level0_row2" class="row_heading level0 row2" >P_4</th>
      <td id="T_3b18c_row2_col0" class="data row2 col0" >5531451.0000</td>
      <td id="T_3b18c_row2_col1" class="data row2 col1" >0.1439</td>
      <td id="T_3b18c_row2_col2" class="data row2 col2" >0.3383</td>
      <td id="T_3b18c_row2_col3" class="data row2 col3" >0.0000</td>
      <td id="T_3b18c_row2_col4" class="data row2 col4" >0.0029</td>
      <td id="T_3b18c_row2_col5" class="data row2 col5" >0.0058</td>
      <td id="T_3b18c_row2_col6" class="data row2 col6" >0.0088</td>
      <td id="T_3b18c_row2_col7" class="data row2 col7" >1.2694</td>
      <td id="T_3b18c_row2_col8" class="data row2 col8" >2.0264</td>
      <td id="T_3b18c_row2_col9" class="data row2 col9" >5.1148</td>
      <td id="T_3b18c_row2_col10" class="data row2 col10" >0.1144</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><strong>Distribución de las variables numéricas</strong></p>
<p>En las posiciones fuera de la diagonal, se representan las relaciones bivariadas entre dos variables diferentes. Cada punto en estos gráficos representa una observación del conjunto de datos. En la diagonal del gráfico, tenemos representaciones de la distribución de cada variable de forma individual, Esto ayuda a identificar la asimetría (skewness) y curtosis de cada variable, es decir, si tienen colas alargadas o se desvían de la normalidad.</p>
<p><strong>Distribuciones</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">P_3</span></code>: Presenta una distribución bastante asimétrica con una alta concentración de valores alrededor de 0 y una larga cola hacia los valores negativos.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">P_2</span></code>: Tiene una distribución más uniforme que parece tener dos picos (bimodal).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">P_4</span></code>: Muestra una distribución muy sesgada a la derecha, con muchos valores cercanos a 0 y algunos valores más alejados hacia la derecha.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Seleccionar todas las columnas numéricas de payment_imputed_filtered</span>
<span class="n">numeric_data</span> <span class="o">=</span> <span class="n">payment_imputed_filtered</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span>

<span class="c1"># Crear la galería de distribuciones usando seaborn PairGrid</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">PairGrid</span><span class="p">(</span><span class="n">numeric_data</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">map_diag</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>  <span class="c1"># Histograma en la diagonal</span>
<span class="n">grid</span><span class="o">.</span><span class="n">map_offdiag</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>    <span class="c1"># Gráficas de dispersión fuera de la diagonal</span>

<span class="c1"># Agregar título</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Distribución de variables Numéricas&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="c1"># Mostrar el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ee52a4d87d9a3721545a813314552ce99af2da4f71cce85035cfa22790ca2d4c.png" src="_images/ee52a4d87d9a3721545a813314552ce99af2da4f71cce85035cfa22790ca2d4c.png" />
</div>
</div>
<p><strong>violin plot</strong></p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Gráfico</span> <span class="pre">de</span> <span class="pre">violín:</span> <span class="pre">P_3</span></code></p></li>
</ol>
<ul class="simple">
<li><p>Este gráfico tiene una forma simétrica, lo que sugiere que la distribución es relativamente equilibrada en ambos lados.</p></li>
<li><p>La mayor concentración de datos está en el centro, con pocas observaciones en los extremos (los “bigotes” son cortos).</p></li>
<li><p>El área más ancha alrededor de la mediana muestra que la mayoría de los valores se encuentran cerca del centro, indicando poca dispersión en los datos.</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><code class="docutils literal notranslate"><span class="pre">Gráfico</span> <span class="pre">de</span> <span class="pre">violín:</span> <span class="pre">P_2</span></code></p></li>
</ol>
<ul class="simple">
<li><p>La distribución de P_2 es más dispersa, con una gran concentración de datos cerca de los extremos, sobre todo en la parte superior.</p></li>
<li><p>La forma asimétrica y el ensanchamiento en la parte superior indican una alta concentración de valores en esa región, sugiriendo una distribución sesgada.</p></li>
<li><p>Hay un rango bastante amplio de valores, con algunos extremos más alejados del centro, lo que refleja una mayor dispersión de los datos en comparación con P_3.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p><code class="docutils literal notranslate"><span class="pre">Gráfico</span> <span class="pre">de</span> <span class="pre">violín:</span> <span class="pre">P_4</span></code></p></li>
</ol>
<ul class="simple">
<li><p>La variable P_4 presenta una distribución claramente bimodal, con dos áreas de concentración bien definidas: una en la parte inferior cercana a 0, y otra cerca de 1.</p></li>
<li><p>Esto sugiere que los datos de esta variable se agrupan en dos valores principales, con pocos valores intermedios.</p></li>
<li><p>El área central más estrecha indica que los valores intermedios entre esos dos puntos no son tan frecuentes.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Seleccionar las tres variables del conjunto payment_imputed_filtered</span>
<span class="n">variables_payment</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;P_3&#39;</span><span class="p">,</span> <span class="s1">&#39;P_2&#39;</span><span class="p">,</span> <span class="s1">&#39;P_4&#39;</span><span class="p">]</span>

<span class="c1"># Crear el gráfico de violín para cada una de las tres variables en una fila con tres columnas</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">variable</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">variables_payment</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>  <span class="c1"># 1 fila, 3 columnas, posición i</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">payment_imputed_filtered</span><span class="p">[</span><span class="n">variable</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Gráfico de violín: </span><span class="si">{</span><span class="n">variable</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2b6526b40ffb2a27c9f5bbdbd4bd41d73f8c704bc7d53b6d7a0d4487195dca5d.png" src="_images/2b6526b40ffb2a27c9f5bbdbd4bd41d73f8c704bc7d53b6d7a0d4487195dca5d.png" />
</div>
</div>
<p>La variable P_3 presenta una distribución aproximadamente simétrica, con la mayoría de los valores concentrados alrededor de su media, aunque se observan algunos valores extremos que podrían indicar una leve asimetría negativa. Por otro lado, P_4 exhibe una distribución bimodal, con un grupo de valores acumulados cerca de 0 y otro grupo cerca de 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="n">data</span> <span class="o">=</span> <span class="n">payment_imputed_filtered</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;P_3&#39;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;P_4&#39;</span><span class="p">]</span>

<span class="c1"># Crear el scatterplot con marginal boxplots</span>
<span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;scatter&quot;</span><span class="p">,</span> <span class="n">marginal_kws</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="c1"># Mostrar el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fa1655a72e8857fee5f702224c22dfa5caac9c3c123b9a8b03d96482a0b002b0.png" src="_images/fa1655a72e8857fee5f702224c22dfa5caac9c3c123b9a8b03d96482a0b002b0.png" />
</div>
</div>
<p>El histograma de P_2 revela una distribución sesgada hacia la derecha, con la mayor concentración de datos en valores más bajos, mientras que algunos valores altos se distribuyen de manera menos frecuente. Por otro lado, P_4 también tiene una distribución bimodal similar a la gráfica anterior, con la mayoría de los puntos acumulados cerca de 0 y una mayor concentración cercana a 1</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">payment_imputed_filtered</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;P_2&#39;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;P_4&#39;</span><span class="p">]</span>

<span class="c1"># Crear el scatterplot con marginal boxplots</span>
<span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;scatter&quot;</span><span class="p">,</span> <span class="n">marginal_kws</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="c1"># Mostrar el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/aaa3928dc6611e73e43998879ee900dd8b78b41f00b0c64eb1e7ef8f5e41a978.png" src="_images/aaa3928dc6611e73e43998879ee900dd8b78b41f00b0c64eb1e7ef8f5e41a978.png" />
</div>
</div>
</section>
<section id="para-el-grupo-spend">
<h4>Para el grupo <code class="docutils literal notranslate"><span class="pre">spend</span></code><a class="headerlink" href="#para-el-grupo-spend" title="Link to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">**1.</span> <span class="pre">Simetría</span> <span class="pre">(Skewness):**</span></code></p>
<ul class="simple">
<li><p>La mayoría de las variables tienen una simetría positiva significativa, lo que sugiere que sus distribuciones están sesgadas hacia la derecha, con colas largas hacia valores más altos. Por ejemplo, las variables S_9 y S_6 tienen valores de skewness muy altos (9.68 y 78.94, respectivamente).</p></li>
<li><p>Algunas variables, como S_7, presentan un skewness negativo, lo que indica colas hacia la izquierda.</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><code class="docutils literal notranslate"><span class="pre">Curtosis</span></code>:</p></li>
</ol>
<ul class="simple">
<li><p>Muchas variables tienen valores de curtosis elevados, lo que indica que las distribuciones tienen colas más pesadas en comparación con una distribución normal. La curtosis extremadamente alta de S_6 (11856) y S_9 (133.19) sugiere la presencia de valores atípicos extremos en esas variables.</p></li>
<li><p>Otras variables, como S_16, muestran curtosis más moderada, lo que indica una distribución más cercana a lo normal.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p><code class="docutils literal notranslate"><span class="pre">Distribución</span></code>:</p></li>
</ol>
<ul class="simple">
<li><p>Varias variables, como S_9, S_5 y S_27, muestran rangos amplios, con diferencias marcadas entre el valor mínimo y máximo, lo que indica una alta variabilidad entre los valores observados.</p></li>
<li><p>Algunas variables, como S_19, tienen distribuciones más estrechas, lo que sugiere que la mayoría de los datos se agrupan alrededor de ciertos valores con poca dispersión.</p></li>
</ul>
<p>En general, el análisis sugiere la presencia de distribuciones altamente asimétricas y con colas largas, lo que indica que podría haber valores extremos significativos o patrones de distribución poco comunes en varias de las variables presentadas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Seleccionar solo las columnas numéricas del DataFrame</span>
<span class="n">numerical_data</span> <span class="o">=</span> <span class="n">spend_imputed_filtered</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span>

<span class="c1"># Calcular estadísticas básicas</span>
<span class="n">basic_stats</span> <span class="o">=</span> <span class="n">numerical_data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># Transponer para mejor visualización</span>

<span class="c1"># Calcular la simetría (skewness) y curtosis</span>
<span class="n">basic_stats</span><span class="p">[</span><span class="s1">&#39;Skewness&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numerical_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">skew</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dropna</span><span class="p">()))</span>
<span class="n">basic_stats</span><span class="p">[</span><span class="s1">&#39;Kurtosis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numerical_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">kurtosis</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">fisher</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="c1"># Añadir la varianza</span>
<span class="n">basic_stats</span><span class="p">[</span><span class="s1">&#39;Variance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numerical_data</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
<span class="n">styled_basic_stats</span> <span class="o">=</span> <span class="n">basic_stats</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># Format to 2 decimal places</span>
<span class="n">display</span><span class="p">(</span><span class="n">styled_basic_stats</span><span class="p">)</span> <span class="c1"># Display using IPython&#39;s display function</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_d65a6" class="dataframe">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_d65a6_level0_col0" class="col_heading level0 col0" >count</th>
      <th id="T_d65a6_level0_col1" class="col_heading level0 col1" >mean</th>
      <th id="T_d65a6_level0_col2" class="col_heading level0 col2" >std</th>
      <th id="T_d65a6_level0_col3" class="col_heading level0 col3" >min</th>
      <th id="T_d65a6_level0_col4" class="col_heading level0 col4" >25%</th>
      <th id="T_d65a6_level0_col5" class="col_heading level0 col5" >50%</th>
      <th id="T_d65a6_level0_col6" class="col_heading level0 col6" >75%</th>
      <th id="T_d65a6_level0_col7" class="col_heading level0 col7" >max</th>
      <th id="T_d65a6_level0_col8" class="col_heading level0 col8" >Skewness</th>
      <th id="T_d65a6_level0_col9" class="col_heading level0 col9" >Kurtosis</th>
      <th id="T_d65a6_level0_col10" class="col_heading level0 col10" >Variance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_d65a6_level0_row0" class="row_heading level0 row0" >S_9</th>
      <td id="T_d65a6_row0_col0" class="data row0 col0" >5531451.0000</td>
      <td id="T_d65a6_row0_col1" class="data row0 col1" >0.0796</td>
      <td id="T_d65a6_row0_col2" class="data row0 col2" >0.1355</td>
      <td id="T_d65a6_row0_col3" class="data row0 col3" >-1.4143</td>
      <td id="T_d65a6_row0_col4" class="data row0 col4" >0.0215</td>
      <td id="T_d65a6_row0_col5" class="data row0 col5" >0.0679</td>
      <td id="T_d65a6_row0_col6" class="data row0 col6" >0.0940</td>
      <td id="T_d65a6_row0_col7" class="data row0 col7" >2.9142</td>
      <td id="T_d65a6_row0_col8" class="data row0 col8" >9.6876</td>
      <td id="T_d65a6_row0_col9" class="data row0 col9" >133.1905</td>
      <td id="T_d65a6_row0_col10" class="data row0 col10" >0.0184</td>
    </tr>
    <tr>
      <th id="T_d65a6_level0_row1" class="row_heading level0 row1" >S_27</th>
      <td id="T_d65a6_row1_col0" class="data row1 col0" >5531451.0000</td>
      <td id="T_d65a6_row1_col1" class="data row1 col1" >0.2535</td>
      <td id="T_d65a6_row1_col2" class="data row1 col2" >0.2855</td>
      <td id="T_d65a6_row1_col3" class="data row1 col3" >-4.5426</td>
      <td id="T_d65a6_row1_col4" class="data row1 col4" >0.0085</td>
      <td id="T_d65a6_row1_col5" class="data row1 col5" >0.1854</td>
      <td id="T_d65a6_row1_col6" class="data row1 col6" >0.3988</td>
      <td id="T_d65a6_row1_col7" class="data row1 col7" >5.4563</td>
      <td id="T_d65a6_row1_col8" class="data row1 col8" >5.5137</td>
      <td id="T_d65a6_row1_col9" class="data row1 col9" >69.9211</td>
      <td id="T_d65a6_row1_col10" class="data row1 col10" >0.0815</td>
    </tr>
    <tr>
      <th id="T_d65a6_level0_row2" class="row_heading level0 row2" >S_7</th>
      <td id="T_d65a6_row2_col0" class="data row2 col0" >5531451.0000</td>
      <td id="T_d65a6_row2_col1" class="data row2 col1" >0.2190</td>
      <td id="T_d65a6_row2_col2" class="data row2 col2" >0.1866</td>
      <td id="T_d65a6_row2_col3" class="data row2 col3" >-0.4701</td>
      <td id="T_d65a6_row2_col4" class="data row2 col4" >0.1004</td>
      <td id="T_d65a6_row2_col5" class="data row2 col5" >0.1955</td>
      <td id="T_d65a6_row2_col6" class="data row2 col6" >0.2517</td>
      <td id="T_d65a6_row2_col7" class="data row2 col7" >3.9483</td>
      <td id="T_d65a6_row2_col8" class="data row2 col8" >2.6043</td>
      <td id="T_d65a6_row2_col9" class="data row2 col9" >13.8093</td>
      <td id="T_d65a6_row2_col10" class="data row2 col10" >0.0348</td>
    </tr>
    <tr>
      <th id="T_d65a6_level0_row3" class="row_heading level0 row3" >S_24</th>
      <td id="T_d65a6_row3_col0" class="data row3 col0" >5531451.0000</td>
      <td id="T_d65a6_row3_col1" class="data row3 col1" >0.7348</td>
      <td id="T_d65a6_row3_col2" class="data row3 col2" >0.8343</td>
      <td id="T_d65a6_row3_col3" class="data row3 col3" >-90.4838</td>
      <td id="T_d65a6_row3_col4" class="data row3 col4" >0.7955</td>
      <td id="T_d65a6_row3_col5" class="data row3 col5" >0.9491</td>
      <td id="T_d65a6_row3_col6" class="data row3 col6" >0.9715</td>
      <td id="T_d65a6_row3_col7" class="data row3 col7" >1.0556</td>
      <td id="T_d65a6_row3_col8" class="data row3 col8" >-63.2285</td>
      <td id="T_d65a6_row3_col9" class="data row3 col9" >5237.7464</td>
      <td id="T_d65a6_row3_col10" class="data row3 col10" >0.6960</td>
    </tr>
    <tr>
      <th id="T_d65a6_level0_row4" class="row_heading level0 row4" >S_26</th>
      <td id="T_d65a6_row4_col0" class="data row4 col0" >5531451.0000</td>
      <td id="T_d65a6_row4_col1" class="data row4 col1" >0.0668</td>
      <td id="T_d65a6_row4_col2" class="data row4 col2" >0.4638</td>
      <td id="T_d65a6_row4_col3" class="data row4 col3" >-0.1254</td>
      <td id="T_d65a6_row4_col4" class="data row4 col4" >0.0034</td>
      <td id="T_d65a6_row4_col5" class="data row4 col5" >0.0068</td>
      <td id="T_d65a6_row4_col6" class="data row4 col6" >0.0110</td>
      <td id="T_d65a6_row4_col7" class="data row4 col7" >136.6660</td>
      <td id="T_d65a6_row4_col8" class="data row4 col8" >78.9451</td>
      <td id="T_d65a6_row4_col9" class="data row4 col9" >11856.5547</td>
      <td id="T_d65a6_row4_col10" class="data row4 col10" >0.2151</td>
    </tr>
    <tr>
      <th id="T_d65a6_level0_row5" class="row_heading level0 row5" >S_23</th>
      <td id="T_d65a6_row5_col0" class="data row5 col0" >5531451.0000</td>
      <td id="T_d65a6_row5_col1" class="data row5 col1" >0.1797</td>
      <td id="T_d65a6_row5_col2" class="data row5 col2" >0.8519</td>
      <td id="T_d65a6_row5_col3" class="data row5 col3" >-206.0855</td>
      <td id="T_d65a6_row5_col4" class="data row5 col4" >0.1334</td>
      <td id="T_d65a6_row5_col5" class="data row5 col5" >0.1362</td>
      <td id="T_d65a6_row5_col6" class="data row5 col6" >0.1390</td>
      <td id="T_d65a6_row5_col7" class="data row5 col7" >885.3349</td>
      <td id="T_d65a6_row5_col8" class="data row5 col8" >571.8299</td>
      <td id="T_d65a6_row5_col9" class="data row5 col9" >467933.3368</td>
      <td id="T_d65a6_row5_col10" class="data row5 col10" >0.7258</td>
    </tr>
    <tr>
      <th id="T_d65a6_level0_row6" class="row_heading level0 row6" >S_5</th>
      <td id="T_d65a6_row6_col0" class="data row6 col0" >5531451.0000</td>
      <td id="T_d65a6_row6_col1" class="data row6 col1" >0.0881</td>
      <td id="T_d65a6_row6_col2" class="data row6 col2" >0.4074</td>
      <td id="T_d65a6_row6_col3" class="data row6 col3" >0.0000</td>
      <td id="T_d65a6_row6_col4" class="data row6 col4" >0.0056</td>
      <td id="T_d65a6_row6_col5" class="data row6 col5" >0.0135</td>
      <td id="T_d65a6_row6_col6" class="data row6 col6" >0.0713</td>
      <td id="T_d65a6_row6_col7" class="data row6 col7" >206.8753</td>
      <td id="T_d65a6_row6_col8" class="data row6 col8" >102.2198</td>
      <td id="T_d65a6_row6_col9" class="data row6 col9" >26719.2886</td>
      <td id="T_d65a6_row6_col10" class="data row6 col10" >0.1660</td>
    </tr>
    <tr>
      <th id="T_d65a6_level0_row7" class="row_heading level0 row7" >S_15</th>
      <td id="T_d65a6_row7_col0" class="data row7 col0" >5531451.0000</td>
      <td id="T_d65a6_row7_col1" class="data row7 col1" >0.3748</td>
      <td id="T_d65a6_row7_col2" class="data row7 col2" >0.1951</td>
      <td id="T_d65a6_row7_col3" class="data row7 col3" >-0.3000</td>
      <td id="T_d65a6_row7_col4" class="data row7 col4" >0.2076</td>
      <td id="T_d65a6_row7_col5" class="data row7 col5" >0.4018</td>
      <td id="T_d65a6_row7_col6" class="data row7 col6" >0.5048</td>
      <td id="T_d65a6_row7_col7" class="data row7 col7" >5.3090</td>
      <td id="T_d65a6_row7_col8" class="data row7 col8" >1.5844</td>
      <td id="T_d65a6_row7_col9" class="data row7 col9" >18.5063</td>
      <td id="T_d65a6_row7_col10" class="data row7 col10" >0.0381</td>
    </tr>
    <tr>
      <th id="T_d65a6_level0_row8" class="row_heading level0 row8" >S_18</th>
      <td id="T_d65a6_row8_col0" class="data row8 col0" >5531451.0000</td>
      <td id="T_d65a6_row8_col1" class="data row8 col1" >0.0315</td>
      <td id="T_d65a6_row8_col2" class="data row8 col2" >0.1605</td>
      <td id="T_d65a6_row8_col3" class="data row8 col3" >0.0000</td>
      <td id="T_d65a6_row8_col4" class="data row8 col4" >0.0026</td>
      <td id="T_d65a6_row8_col5" class="data row8 col5" >0.0051</td>
      <td id="T_d65a6_row8_col6" class="data row8 col6" >0.0077</td>
      <td id="T_d65a6_row8_col7" class="data row8 col7" >1.0100</td>
      <td id="T_d65a6_row8_col8" class="data row8 col8" >5.8973</td>
      <td id="T_d65a6_row8_col9" class="data row8 col9" >35.7902</td>
      <td id="T_d65a6_row8_col10" class="data row8 col10" >0.0258</td>
    </tr>
    <tr>
      <th id="T_d65a6_level0_row9" class="row_heading level0 row9" >S_11</th>
      <td id="T_d65a6_row9_col0" class="data row9 col0" >5531451.0000</td>
      <td id="T_d65a6_row9_col1" class="data row9 col1" >0.3753</td>
      <td id="T_d65a6_row9_col2" class="data row9 col2" >0.1910</td>
      <td id="T_d65a6_row9_col3" class="data row9 col3" >-0.2000</td>
      <td id="T_d65a6_row9_col4" class="data row9 col4" >0.2824</td>
      <td id="T_d65a6_row9_col5" class="data row9 col5" >0.2897</td>
      <td id="T_d65a6_row9_col6" class="data row9 col6" >0.4488</td>
      <td id="T_d65a6_row9_col7" class="data row9 col7" >3.8014</td>
      <td id="T_d65a6_row9_col8" class="data row9 col8" >1.5557</td>
      <td id="T_d65a6_row9_col9" class="data row9 col9" >8.5943</td>
      <td id="T_d65a6_row9_col10" class="data row9 col10" >0.0365</td>
    </tr>
    <tr>
      <th id="T_d65a6_level0_row10" class="row_heading level0 row10" >S_16</th>
      <td id="T_d65a6_row10_col0" class="data row10 col0" >5531451.0000</td>
      <td id="T_d65a6_row10_col1" class="data row10 col1" >0.0508</td>
      <td id="T_d65a6_row10_col2" class="data row10 col2" >0.7725</td>
      <td id="T_d65a6_row10_col3" class="data row10 col3" >0.0000</td>
      <td id="T_d65a6_row10_col4" class="data row10 col4" >0.0026</td>
      <td id="T_d65a6_row10_col5" class="data row10 col5" >0.0051</td>
      <td id="T_d65a6_row10_col6" class="data row10 col6" >0.0077</td>
      <td id="T_d65a6_row10_col7" class="data row10 col7" >231.7589</td>
      <td id="T_d65a6_row10_col8" class="data row10 col8" >73.4635</td>
      <td id="T_d65a6_row10_col9" class="data row10 col9" >11487.5324</td>
      <td id="T_d65a6_row10_col10" class="data row10 col10" >0.5967</td>
    </tr>
    <tr>
      <th id="T_d65a6_level0_row11" class="row_heading level0 row11" >S_17</th>
      <td id="T_d65a6_row11_col0" class="data row11 col0" >5531451.0000</td>
      <td id="T_d65a6_row11_col1" class="data row11 col1" >0.0397</td>
      <td id="T_d65a6_row11_col2" class="data row11 col2" >0.2410</td>
      <td id="T_d65a6_row11_col3" class="data row11 col3" >0.0000</td>
      <td id="T_d65a6_row11_col4" class="data row11 col4" >0.0027</td>
      <td id="T_d65a6_row11_col5" class="data row11 col5" >0.0054</td>
      <td id="T_d65a6_row11_col6" class="data row11 col6" >0.0080</td>
      <td id="T_d65a6_row11_col7" class="data row11 col7" >4.0491</td>
      <td id="T_d65a6_row11_col8" class="data row11 col8" >10.8995</td>
      <td id="T_d65a6_row11_col9" class="data row11 col9" >143.0188</td>
      <td id="T_d65a6_row11_col10" class="data row11 col10" >0.0581</td>
    </tr>
    <tr>
      <th id="T_d65a6_level0_row12" class="row_heading level0 row12" >S_6</th>
      <td id="T_d65a6_row12_col0" class="data row12 col0" >5531451.0000</td>
      <td id="T_d65a6_row12_col1" class="data row12 col1" >0.2442</td>
      <td id="T_d65a6_row12_col2" class="data row12 col2" >0.4266</td>
      <td id="T_d65a6_row12_col3" class="data row12 col3" >0.0000</td>
      <td id="T_d65a6_row12_col4" class="data row12 col4" >0.0033</td>
      <td id="T_d65a6_row12_col5" class="data row12 col5" >0.0066</td>
      <td id="T_d65a6_row12_col6" class="data row12 col6" >0.0099</td>
      <td id="T_d65a6_row12_col7" class="data row12 col7" >1.0100</td>
      <td id="T_d65a6_row12_col8" class="data row12 col8" >1.2227</td>
      <td id="T_d65a6_row12_col9" class="data row12 col9" >2.4952</td>
      <td id="T_d65a6_row12_col10" class="data row12 col10" >0.1820</td>
    </tr>
    <tr>
      <th id="T_d65a6_level0_row13" class="row_heading level0 row13" >S_12</th>
      <td id="T_d65a6_row13_col0" class="data row13 col0" >5531451.0000</td>
      <td id="T_d65a6_row13_col1" class="data row13 col1" >0.2405</td>
      <td id="T_d65a6_row13_col2" class="data row13 col2" >0.2507</td>
      <td id="T_d65a6_row13_col3" class="data row13 col3" >-0.4041</td>
      <td id="T_d65a6_row13_col4" class="data row13 col4" >0.1869</td>
      <td id="T_d65a6_row13_col5" class="data row13 col5" >0.1908</td>
      <td id="T_d65a6_row13_col6" class="data row13 col6" >0.2089</td>
      <td id="T_d65a6_row13_col7" class="data row13 col7" >175.3314</td>
      <td id="T_d65a6_row13_col8" class="data row13 col8" >118.6076</td>
      <td id="T_d65a6_row13_col9" class="data row13 col9" >57725.2981</td>
      <td id="T_d65a6_row13_col10" class="data row13 col10" >0.0629</td>
    </tr>
    <tr>
      <th id="T_d65a6_level0_row14" class="row_heading level0 row14" >S_8</th>
      <td id="T_d65a6_row14_col0" class="data row14 col0" >5531451.0000</td>
      <td id="T_d65a6_row14_col1" class="data row14 col1" >0.3276</td>
      <td id="T_d65a6_row14_col2" class="data row14 col2" >0.3031</td>
      <td id="T_d65a6_row14_col3" class="data row14 col3" >0.0000</td>
      <td id="T_d65a6_row14_col4" class="data row14 col4" >0.0076</td>
      <td id="T_d65a6_row14_col5" class="data row14 col5" >0.3217</td>
      <td id="T_d65a6_row14_col6" class="data row14 col6" >0.4949</td>
      <td id="T_d65a6_row14_col7" class="data row14 col7" >1.2314</td>
      <td id="T_d65a6_row14_col8" class="data row14 col8" >0.5655</td>
      <td id="T_d65a6_row14_col9" class="data row14 col9" >2.2783</td>
      <td id="T_d65a6_row14_col10" class="data row14 col10" >0.0919</td>
    </tr>
    <tr>
      <th id="T_d65a6_level0_row15" class="row_heading level0 row15" >S_13</th>
      <td id="T_d65a6_row15_col0" class="data row15 col0" >5531451.0000</td>
      <td id="T_d65a6_row15_col1" class="data row15 col1" >0.2547</td>
      <td id="T_d65a6_row15_col2" class="data row15 col2" >0.2967</td>
      <td id="T_d65a6_row15_col3" class="data row15 col3" >0.0000</td>
      <td id="T_d65a6_row15_col4" class="data row15 col4" >0.0049</td>
      <td id="T_d65a6_row15_col5" class="data row15 col5" >0.0098</td>
      <td id="T_d65a6_row15_col6" class="data row15 col6" >0.4277</td>
      <td id="T_d65a6_row15_col7" class="data row15 col7" >1.0100</td>
      <td id="T_d65a6_row15_col8" class="data row15 col8" >0.8706</td>
      <td id="T_d65a6_row15_col9" class="data row15 col9" >2.7453</td>
      <td id="T_d65a6_row15_col10" class="data row15 col10" >0.0880</td>
    </tr>
    <tr>
      <th id="T_d65a6_level0_row16" class="row_heading level0 row16" >S_19</th>
      <td id="T_d65a6_row16_col0" class="data row16 col0" >5531451.0000</td>
      <td id="T_d65a6_row16_col1" class="data row16 col1" >0.0050</td>
      <td id="T_d65a6_row16_col2" class="data row16 col2" >0.0031</td>
      <td id="T_d65a6_row16_col3" class="data row16 col3" >0.0000</td>
      <td id="T_d65a6_row16_col4" class="data row16 col4" >0.0025</td>
      <td id="T_d65a6_row16_col5" class="data row16 col5" >0.0050</td>
      <td id="T_d65a6_row16_col6" class="data row16 col6" >0.0075</td>
      <td id="T_d65a6_row16_col7" class="data row16 col7" >1.0047</td>
      <td id="T_d65a6_row16_col8" class="data row16 col8" >9.8431</td>
      <td id="T_d65a6_row16_col9" class="data row16 col9" >2355.3255</td>
      <td id="T_d65a6_row16_col10" class="data row16 col10" >0.0000</td>
    </tr>
    <tr>
      <th id="T_d65a6_level0_row17" class="row_heading level0 row17" >S_20</th>
      <td id="T_d65a6_row17_col0" class="data row17 col0" >5531451.0000</td>
      <td id="T_d65a6_row17_col1" class="data row17 col1" >0.0175</td>
      <td id="T_d65a6_row17_col2" class="data row17 col2" >0.1111</td>
      <td id="T_d65a6_row17_col3" class="data row17 col3" >0.0000</td>
      <td id="T_d65a6_row17_col4" class="data row17 col4" >0.0025</td>
      <td id="T_d65a6_row17_col5" class="data row17 col5" >0.0051</td>
      <td id="T_d65a6_row17_col6" class="data row17 col6" >0.0076</td>
      <td id="T_d65a6_row17_col7" class="data row17 col7" >1.0100</td>
      <td id="T_d65a6_row17_col8" class="data row17 col8" >8.7712</td>
      <td id="T_d65a6_row17_col9" class="data row17 col9" >77.9879</td>
      <td id="T_d65a6_row17_col10" class="data row17 col10" >0.0123</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Distribución</span> <span class="pre">de</span> <span class="pre">los</span> <span class="pre">datos:</span></code> En la mayoría de los gráficos, los datos están altamente concentrados alrededor del rango intercuartílico (entre el percentil 25 y el 75), lo que significa que la mayoría de las observaciones se encuentran en este intervalo. Las líneas horizontales dentro de las cajas representan la mediana de cada variable.</p></li>
<li><p><code class="docutils literal notranslate"> <span class="pre">Valores</span> <span class="pre">atípicos</span> <span class="pre">(outliers):</span></code> Cada gráfico muestra puntos fuera de los “bigotes” del diagrama, que son posibles outliers. Esto es visible en todas las variables, lo que indica que existen valores extremos que están significativamente alejados de la mediana. En particular, variables como S_26, S_23, y S_9 muestran una gran cantidad de outliers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Simetría</span></code>: Algunas variables parecen estar distribuidas de manera más simétrica, mientras que otras, como S_23 y S_26, presentan una mayor asimetría, con valores más extendidos hacia los valores altos. Esta asimetría se refleja en la longitud de los bigotes, que no son simétricos con respecto a la mediana.</p></li>
</ol>
<p>4.<code class="docutils literal notranslate"> <span class="pre">Rangos</span> <span class="pre">extremos:</span></code> En variables como S_23 y S_26, los rangos son mucho más amplios en comparación con las otras variables, lo que indica que los datos tienen una dispersión mucho mayor en estas columnas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Seleccionar solo las columnas numéricas del DataFrame</span>
<span class="n">numerical_data</span> <span class="o">=</span> <span class="n">spend_imputed_filtered</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span>

<span class="c1"># Crear una figura con un layout de 3 filas y 3 columnas</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>  <span class="c1"># Ajustar el tamaño de la figura</span>

<span class="c1"># Aplanar los ejes para iterar fácilmente</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="c1"># Iterar sobre las primeras 9 columnas numéricas y crear un boxplot para cada una</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">numerical_data</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="mi">9</span><span class="p">]):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">numerical_data</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">)</span>  <span class="c1"># Boxplot de cada variable</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Diagrama de Cajas: </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># Título para cada gráfico</span>

<span class="c1"># Ajustar la distribución de los gráficos</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/40959f82bad2ae0f3532c828eeb14a1dfce891013c5a5019a6478c392bb205fc.png" src="_images/40959f82bad2ae0f3532c828eeb14a1dfce891013c5a5019a6478c392bb205fc.png" />
</div>
</div>
</section>
<section id="para-el-grupo-risk">
<h4>Para el grupo <code class="docutils literal notranslate"><span class="pre">Risk</span></code><a class="headerlink" href="#para-el-grupo-risk" title="Link to this heading">#</a></h4>
<p>La mayoría de los datos tienen un rango limitado con una alta concentración cerca del valor central (mediana) y pocos valores extremos. Las medidas de asimetría (Skewness) y curtosis (Kurtosis) revelan la naturaleza de las distribuciones:</p>
<ul class="simple">
<li><p>Asimetría: Varias variables muestran asimetría positiva o negativa. Por ejemplo, R_27 tiene una asimetría negativa (-2.46), lo que sugiere que la distribución tiene una cola hacia la izquierda, mientras que R_22 tiene una asimetría altamente positiva (7.55), indicando una fuerte acumulación en valores bajos con una cola hacia la derecha.</p></li>
<li><p>Curtosis: La curtosis es muy elevada en muchas variables, como R_7 (curtosis de 7409.44) y R_19 (curtosis de 1316.45), lo que indica distribuciones con colas largas o picos muy pronunciados, reflejando la presencia de valores atípicos extremos.</p></li>
<li><p>Desviación estándar: Las variables como R_7 y R_13 tienen una mayor desviación estándar (indicando mayor dispersión de los datos), mientras que variables como R_22 y R_16 tienen menor desviación, sugiriendo datos más concentrados alrededor de la media.</p></li>
<li><p>Varianza: La varianza varía entre las variables, con valores más altos en variables como R_7 (varianza de 2.40) y más bajos en R_16 (0.0042), lo que indica diferencias en la dispersión de los datos.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">skew</span><span class="p">,</span> <span class="n">kurtosis</span>

<span class="c1"># Seleccionar solo las columnas numéricas del DataFrame</span>
<span class="n">numerical_data</span> <span class="o">=</span> <span class="n">risk_imputed_filtered</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span>

<span class="c1"># Calcular estadísticas básicas</span>
<span class="n">basic_stats</span> <span class="o">=</span> <span class="n">numerical_data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># Transponer para mejor visualización</span>

<span class="c1"># Calcular la simetría (skewness) y curtosis</span>
<span class="n">basic_stats</span><span class="p">[</span><span class="s1">&#39;Skewness&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numerical_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">skew</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dropna</span><span class="p">()))</span>
<span class="n">basic_stats</span><span class="p">[</span><span class="s1">&#39;Kurtosis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numerical_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">kurtosis</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">fisher</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="c1"># Añadir la varianza</span>
<span class="n">basic_stats</span><span class="p">[</span><span class="s1">&#39;Variance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numerical_data</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
<span class="n">styled_basic_stats</span> <span class="o">=</span> <span class="n">basic_stats</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># Format to 2 decimal places</span>
<span class="n">display</span><span class="p">(</span><span class="n">styled_basic_stats</span><span class="p">)</span> <span class="c1"># Display using IPython&#39;s display function</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_843c3" class="dataframe">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_843c3_level0_col0" class="col_heading level0 col0" >count</th>
      <th id="T_843c3_level0_col1" class="col_heading level0 col1" >mean</th>
      <th id="T_843c3_level0_col2" class="col_heading level0 col2" >std</th>
      <th id="T_843c3_level0_col3" class="col_heading level0 col3" >min</th>
      <th id="T_843c3_level0_col4" class="col_heading level0 col4" >25%</th>
      <th id="T_843c3_level0_col5" class="col_heading level0 col5" >50%</th>
      <th id="T_843c3_level0_col6" class="col_heading level0 col6" >75%</th>
      <th id="T_843c3_level0_col7" class="col_heading level0 col7" >max</th>
      <th id="T_843c3_level0_col8" class="col_heading level0 col8" >Skewness</th>
      <th id="T_843c3_level0_col9" class="col_heading level0 col9" >Kurtosis</th>
      <th id="T_843c3_level0_col10" class="col_heading level0 col10" >Variance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_843c3_level0_row0" class="row_heading level0 row0" >R_27</th>
      <td id="T_843c3_row0_col0" class="data row0 col0" >5531451.0000</td>
      <td id="T_843c3_row0_col1" class="data row0 col1" >0.8929</td>
      <td id="T_843c3_row0_col2" class="data row0 col2" >0.3093</td>
      <td id="T_843c3_row0_col3" class="data row0 col3" >-1.5917</td>
      <td id="T_843c3_row0_col4" class="data row0 col4" >1.0013</td>
      <td id="T_843c3_row0_col5" class="data row0 col5" >1.0042</td>
      <td id="T_843c3_row0_col6" class="data row0 col6" >1.0071</td>
      <td id="T_843c3_row0_col7" class="data row0 col7" >2.3942</td>
      <td id="T_843c3_row0_col8" class="data row0 col8" >-2.4598</td>
      <td id="T_843c3_row0_col9" class="data row0 col9" >7.0939</td>
      <td id="T_843c3_row0_col10" class="data row0 col10" >0.0957</td>
    </tr>
    <tr>
      <th id="T_843c3_level0_row1" class="row_heading level0 row1" >R_20</th>
      <td id="T_843c3_row1_col0" class="data row1 col0" >5531451.0000</td>
      <td id="T_843c3_row1_col1" class="data row1 col1" >0.0369</td>
      <td id="T_843c3_row1_col2" class="data row1 col2" >0.3781</td>
      <td id="T_843c3_row1_col3" class="data row1 col3" >-0.0365</td>
      <td id="T_843c3_row1_col4" class="data row1 col4" >0.0025</td>
      <td id="T_843c3_row1_col5" class="data row1 col5" >0.0051</td>
      <td id="T_843c3_row1_col6" class="data row1 col6" >0.0076</td>
      <td id="T_843c3_row1_col7" class="data row1 col7" >45.0060</td>
      <td id="T_843c3_row1_col8" class="data row1 col8" >25.6217</td>
      <td id="T_843c3_row1_col9" class="data row1 col9" >1104.4660</td>
      <td id="T_843c3_row1_col10" class="data row1 col10" >0.1429</td>
    </tr>
    <tr>
      <th id="T_843c3_level0_row2" class="row_heading level0 row2" >R_7</th>
      <td id="T_843c3_row2_col0" class="data row2 col0" >5531451.0000</td>
      <td id="T_843c3_row2_col1" class="data row2 col1" >0.0881</td>
      <td id="T_843c3_row2_col2" class="data row2 col2" >1.5509</td>
      <td id="T_843c3_row2_col3" class="data row2 col3" >-0.0336</td>
      <td id="T_843c3_row2_col4" class="data row2 col4" >0.0026</td>
      <td id="T_843c3_row2_col5" class="data row2 col5" >0.0051</td>
      <td id="T_843c3_row2_col6" class="data row2 col6" >0.0077</td>
      <td id="T_843c3_row2_col7" class="data row2 col7" >449.9889</td>
      <td id="T_843c3_row2_col8" class="data row2 col8" >59.3149</td>
      <td id="T_843c3_row2_col9" class="data row2 col9" >7409.4368</td>
      <td id="T_843c3_row2_col10" class="data row2 col10" >2.4052</td>
    </tr>
    <tr>
      <th id="T_843c3_level0_row3" class="row_heading level0 row3" >R_14</th>
      <td id="T_843c3_row3_col0" class="data row3 col0" >5531451.0000</td>
      <td id="T_843c3_row3_col1" class="data row3 col1" >0.2414</td>
      <td id="T_843c3_row3_col2" class="data row3 col2" >8.3565</td>
      <td id="T_843c3_row3_col3" class="data row3 col3" >-0.0132</td>
      <td id="T_843c3_row3_col4" class="data row3 col4" >0.0025</td>
      <td id="T_843c3_row3_col5" class="data row3 col5" >0.0051</td>
      <td id="T_843c3_row3_col6" class="data row3 col6" >0.0076</td>
      <td id="T_843c3_row3_col7" class="data row3 col7" >4837.3049</td>
      <td id="T_843c3_row3_col8" class="data row3 col8" >135.1334</td>
      <td id="T_843c3_row3_col9" class="data row3 col9" >38611.4643</td>
      <td id="T_843c3_row3_col10" class="data row3 col10" >69.8303</td>
    </tr>
    <tr>
      <th id="T_843c3_level0_row4" class="row_heading level0 row4" >R_2</th>
      <td id="T_843c3_row4_col0" class="data row4 col0" >5531451.0000</td>
      <td id="T_843c3_row4_col1" class="data row4 col1" >0.0475</td>
      <td id="T_843c3_row4_col2" class="data row4 col2" >0.2018</td>
      <td id="T_843c3_row4_col3" class="data row4 col3" >0.0000</td>
      <td id="T_843c3_row4_col4" class="data row4 col4" >0.0026</td>
      <td id="T_843c3_row4_col5" class="data row4 col5" >0.0052</td>
      <td id="T_843c3_row4_col6" class="data row4 col6" >0.0078</td>
      <td id="T_843c3_row4_col7" class="data row4 col7" >1.0100</td>
      <td id="T_843c3_row4_col8" class="data row4 col8" >4.5334</td>
      <td id="T_843c3_row4_col9" class="data row4 col9" >21.5572</td>
      <td id="T_843c3_row4_col10" class="data row4 col10" >0.0407</td>
    </tr>
    <tr>
      <th id="T_843c3_level0_row5" class="row_heading level0 row5" >R_21</th>
      <td id="T_843c3_row5_col0" class="data row5 col0" >5531451.0000</td>
      <td id="T_843c3_row5_col1" class="data row5 col1" >0.0216</td>
      <td id="T_843c3_row5_col2" class="data row5 col2" >0.1278</td>
      <td id="T_843c3_row5_col3" class="data row5 col3" >0.0000</td>
      <td id="T_843c3_row5_col4" class="data row5 col4" >0.0025</td>
      <td id="T_843c3_row5_col5" class="data row5 col5" >0.0051</td>
      <td id="T_843c3_row5_col6" class="data row5 col6" >0.0076</td>
      <td id="T_843c3_row5_col7" class="data row5 col7" >1.0100</td>
      <td id="T_843c3_row5_col8" class="data row5 col8" >7.5580</td>
      <td id="T_843c3_row5_col9" class="data row5 col9" >58.1551</td>
      <td id="T_843c3_row5_col10" class="data row5 col10" >0.0163</td>
    </tr>
    <tr>
      <th id="T_843c3_level0_row6" class="row_heading level0 row6" >R_22</th>
      <td id="T_843c3_row6_col0" class="data row6 col0" >5531451.0000</td>
      <td id="T_843c3_row6_col1" class="data row6 col1" >0.0086</td>
      <td id="T_843c3_row6_col2" class="data row6 col2" >0.0600</td>
      <td id="T_843c3_row6_col3" class="data row6 col3" >0.0000</td>
      <td id="T_843c3_row6_col4" class="data row6 col4" >0.0025</td>
      <td id="T_843c3_row6_col5" class="data row6 col5" >0.0050</td>
      <td id="T_843c3_row6_col6" class="data row6 col6" >0.0075</td>
      <td id="T_843c3_row6_col7" class="data row6 col7" >1.0100</td>
      <td id="T_843c3_row6_col8" class="data row6 col8" >16.5062</td>
      <td id="T_843c3_row6_col9" class="data row6 col9" >274.0942</td>
      <td id="T_843c3_row6_col10" class="data row6 col10" >0.0036</td>
    </tr>
    <tr>
      <th id="T_843c3_level0_row7" class="row_heading level0 row7" >R_23</th>
      <td id="T_843c3_row7_col0" class="data row7 col0" >5531451.0000</td>
      <td id="T_843c3_row7_col1" class="data row7 col1" >0.0053</td>
      <td id="T_843c3_row7_col2" class="data row7 col2" >0.0174</td>
      <td id="T_843c3_row7_col3" class="data row7 col3" >0.0000</td>
      <td id="T_843c3_row7_col4" class="data row7 col4" >0.0025</td>
      <td id="T_843c3_row7_col5" class="data row7 col5" >0.0050</td>
      <td id="T_843c3_row7_col6" class="data row7 col6" >0.0075</td>
      <td id="T_843c3_row7_col7" class="data row7 col7" >1.0100</td>
      <td id="T_843c3_row7_col8" class="data row7 col8" >55.7497</td>
      <td id="T_843c3_row7_col9" class="data row7 col9" >3196.6688</td>
      <td id="T_843c3_row7_col10" class="data row7 col10" >0.0003</td>
    </tr>
    <tr>
      <th id="T_843c3_level0_row8" class="row_heading level0 row8" >R_24</th>
      <td id="T_843c3_row8_col0" class="data row8 col0" >5531451.0000</td>
      <td id="T_843c3_row8_col1" class="data row8 col1" >0.0189</td>
      <td id="T_843c3_row8_col2" class="data row8 col2" >0.1172</td>
      <td id="T_843c3_row8_col3" class="data row8 col3" >0.0000</td>
      <td id="T_843c3_row8_col4" class="data row8 col4" >0.0025</td>
      <td id="T_843c3_row8_col5" class="data row8 col5" >0.0051</td>
      <td id="T_843c3_row8_col6" class="data row8 col6" >0.0076</td>
      <td id="T_843c3_row8_col7" class="data row8 col7" >1.0100</td>
      <td id="T_843c3_row8_col8" class="data row8 col8" >8.2908</td>
      <td id="T_843c3_row8_col9" class="data row8 col9" >69.7822</td>
      <td id="T_843c3_row8_col10" class="data row8 col10" >0.0137</td>
    </tr>
    <tr>
      <th id="T_843c3_level0_row9" class="row_heading level0 row9" >R_25</th>
      <td id="T_843c3_row9_col0" class="data row9 col0" >5531451.0000</td>
      <td id="T_843c3_row9_col1" class="data row9 col1" >0.0082</td>
      <td id="T_843c3_row9_col2" class="data row9 col2" >0.0566</td>
      <td id="T_843c3_row9_col3" class="data row9 col3" >0.0000</td>
      <td id="T_843c3_row9_col4" class="data row9 col4" >0.0025</td>
      <td id="T_843c3_row9_col5" class="data row9 col5" >0.0050</td>
      <td id="T_843c3_row9_col6" class="data row9 col6" >0.0075</td>
      <td id="T_843c3_row9_col7" class="data row9 col7" >1.0100</td>
      <td id="T_843c3_row9_col8" class="data row9 col8" >17.5084</td>
      <td id="T_843c3_row9_col9" class="data row9 col9" >308.3552</td>
      <td id="T_843c3_row9_col10" class="data row9 col10" >0.0032</td>
    </tr>
    <tr>
      <th id="T_843c3_level0_row10" class="row_heading level0 row10" >R_17</th>
      <td id="T_843c3_row10_col0" class="data row10 col0" >5531451.0000</td>
      <td id="T_843c3_row10_col1" class="data row10 col1" >0.0053</td>
      <td id="T_843c3_row10_col2" class="data row10 col2" >0.0064</td>
      <td id="T_843c3_row10_col3" class="data row10 col3" >0.0000</td>
      <td id="T_843c3_row10_col4" class="data row10 col4" >0.0025</td>
      <td id="T_843c3_row10_col5" class="data row10 col5" >0.0050</td>
      <td id="T_843c3_row10_col6" class="data row10 col6" >0.0075</td>
      <td id="T_843c3_row10_col7" class="data row10 col7" >1.0015</td>
      <td id="T_843c3_row10_col8" class="data row10 col8" >26.0548</td>
      <td id="T_843c3_row10_col9" class="data row10 col9" >1356.1361</td>
      <td id="T_843c3_row10_col10" class="data row10 col10" >0.0000</td>
    </tr>
    <tr>
      <th id="T_843c3_level0_row11" class="row_heading level0 row11" >R_18</th>
      <td id="T_843c3_row11_col0" class="data row11 col0" >5531451.0000</td>
      <td id="T_843c3_row11_col1" class="data row11 col1" >0.0050</td>
      <td id="T_843c3_row11_col2" class="data row11 col2" >0.0032</td>
      <td id="T_843c3_row11_col3" class="data row11 col3" >0.0000</td>
      <td id="T_843c3_row11_col4" class="data row11 col4" >0.0025</td>
      <td id="T_843c3_row11_col5" class="data row11 col5" >0.0050</td>
      <td id="T_843c3_row11_col6" class="data row11 col6" >0.0075</td>
      <td id="T_843c3_row11_col7" class="data row11 col7" >1.0008</td>
      <td id="T_843c3_row11_col8" class="data row11 col8" >24.5295</td>
      <td id="T_843c3_row11_col9" class="data row11 col9" >4123.1591</td>
      <td id="T_843c3_row11_col10" class="data row11 col10" >0.0000</td>
    </tr>
    <tr>
      <th id="T_843c3_level0_row12" class="row_heading level0 row12" >R_13</th>
      <td id="T_843c3_row12_col0" class="data row12 col0" >5531451.0000</td>
      <td id="T_843c3_row12_col1" class="data row12 col1" >0.0055</td>
      <td id="T_843c3_row12_col2" class="data row12 col2" >0.0073</td>
      <td id="T_843c3_row12_col3" class="data row12 col3" >0.0000</td>
      <td id="T_843c3_row12_col4" class="data row12 col4" >0.0025</td>
      <td id="T_843c3_row12_col5" class="data row12 col5" >0.0050</td>
      <td id="T_843c3_row12_col6" class="data row12 col6" >0.0076</td>
      <td id="T_843c3_row12_col7" class="data row12 col7" >1.0053</td>
      <td id="T_843c3_row12_col8" class="data row12 col8" >21.9494</td>
      <td id="T_843c3_row12_col9" class="data row12 col9" >1009.3092</td>
      <td id="T_843c3_row12_col10" class="data row12 col10" >0.0001</td>
    </tr>
    <tr>
      <th id="T_843c3_level0_row13" class="row_heading level0 row13" >R_15</th>
      <td id="T_843c3_row13_col0" class="data row13 col0" >5531451.0000</td>
      <td id="T_843c3_row13_col1" class="data row13 col1" >0.0203</td>
      <td id="T_843c3_row13_col2" class="data row13 col2" >0.1227</td>
      <td id="T_843c3_row13_col3" class="data row13 col3" >0.0000</td>
      <td id="T_843c3_row13_col4" class="data row13 col4" >0.0025</td>
      <td id="T_843c3_row13_col5" class="data row13 col5" >0.0051</td>
      <td id="T_843c3_row13_col6" class="data row13 col6" >0.0076</td>
      <td id="T_843c3_row13_col7" class="data row13 col7" >1.0100</td>
      <td id="T_843c3_row13_col8" class="data row13 col8" >7.8960</td>
      <td id="T_843c3_row13_col9" class="data row13 col9" >63.3840</td>
      <td id="T_843c3_row13_col10" class="data row13 col10" >0.0151</td>
    </tr>
    <tr>
      <th id="T_843c3_level0_row14" class="row_heading level0 row14" >R_16</th>
      <td id="T_843c3_row14_col0" class="data row14 col0" >5531451.0000</td>
      <td id="T_843c3_row14_col1" class="data row14 col1" >0.0585</td>
      <td id="T_843c3_row14_col2" class="data row14 col2" >0.2392</td>
      <td id="T_843c3_row14_col3" class="data row14 col3" >0.0000</td>
      <td id="T_843c3_row14_col4" class="data row14 col4" >0.0027</td>
      <td id="T_843c3_row14_col5" class="data row14 col5" >0.0054</td>
      <td id="T_843c3_row14_col6" class="data row14 col6" >0.0081</td>
      <td id="T_843c3_row14_col7" class="data row14 col7" >18.5001</td>
      <td id="T_843c3_row14_col8" class="data row14 col8" >9.4485</td>
      <td id="T_843c3_row14_col9" class="data row14 col9" >185.8786</td>
      <td id="T_843c3_row14_col10" class="data row14 col10" >0.0572</td>
    </tr>
    <tr>
      <th id="T_843c3_level0_row15" class="row_heading level0 row15" >R_10</th>
      <td id="T_843c3_row15_col0" class="data row15 col0" >5531451.0000</td>
      <td id="T_843c3_row15_col1" class="data row15 col1" >0.0648</td>
      <td id="T_843c3_row15_col2" class="data row15 col2" >0.3057</td>
      <td id="T_843c3_row15_col3" class="data row15 col3" >0.0000</td>
      <td id="T_843c3_row15_col4" class="data row15 col4" >0.0026</td>
      <td id="T_843c3_row15_col5" class="data row15 col5" >0.0052</td>
      <td id="T_843c3_row15_col6" class="data row15 col6" >0.0079</td>
      <td id="T_843c3_row15_col7" class="data row15 col7" >21.0037</td>
      <td id="T_843c3_row15_col8" class="data row15 col8" >7.4535</td>
      <td id="T_843c3_row15_col9" class="data row15 col9" >93.3327</td>
      <td id="T_843c3_row15_col10" class="data row15 col10" >0.0934</td>
    </tr>
    <tr>
      <th id="T_843c3_level0_row16" class="row_heading level0 row16" >R_11</th>
      <td id="T_843c3_row16_col0" class="data row16 col0" >5531451.0000</td>
      <td id="T_843c3_row16_col1" class="data row16 col1" >0.0508</td>
      <td id="T_843c3_row16_col2" class="data row16 col2" >0.1756</td>
      <td id="T_843c3_row16_col3" class="data row16 col3" >0.0000</td>
      <td id="T_843c3_row16_col4" class="data row16 col4" >0.0027</td>
      <td id="T_843c3_row16_col5" class="data row16 col5" >0.0054</td>
      <td id="T_843c3_row16_col6" class="data row16 col6" >0.0081</td>
      <td id="T_843c3_row16_col7" class="data row16 col7" >12.5026</td>
      <td id="T_843c3_row16_col8" class="data row16 col8" >5.2691</td>
      <td id="T_843c3_row16_col9" class="data row16 col9" >55.4612</td>
      <td id="T_843c3_row16_col10" class="data row16 col10" >0.0308</td>
    </tr>
    <tr>
      <th id="T_843c3_level0_row17" class="row_heading level0 row17" >R_6</th>
      <td id="T_843c3_row17_col0" class="data row17 col0" >5531451.0000</td>
      <td id="T_843c3_row17_col1" class="data row17 col1" >0.0585</td>
      <td id="T_843c3_row17_col2" class="data row17 col2" >0.6416</td>
      <td id="T_843c3_row17_col3" class="data row17 col3" >0.0000</td>
      <td id="T_843c3_row17_col4" class="data row17 col4" >0.0026</td>
      <td id="T_843c3_row17_col5" class="data row17 col5" >0.0052</td>
      <td id="T_843c3_row17_col6" class="data row17 col6" >0.0078</td>
      <td id="T_843c3_row17_col7" class="data row17 col7" >14.4482</td>
      <td id="T_843c3_row17_col8" class="data row17 col8" >18.0332</td>
      <td id="T_843c3_row17_col9" class="data row17 col9" >363.6304</td>
      <td id="T_843c3_row17_col10" class="data row17 col10" >0.4116</td>
    </tr>
    <tr>
      <th id="T_843c3_level0_row18" class="row_heading level0 row18" >R_8</th>
      <td id="T_843c3_row18_col0" class="data row18 col0" >5531451.0000</td>
      <td id="T_843c3_row18_col1" class="data row18 col1" >0.0381</td>
      <td id="T_843c3_row18_col2" class="data row18 col2" >0.3036</td>
      <td id="T_843c3_row18_col3" class="data row18 col3" >0.0000</td>
      <td id="T_843c3_row18_col4" class="data row18 col4" >0.0026</td>
      <td id="T_843c3_row18_col5" class="data row18 col5" >0.0051</td>
      <td id="T_843c3_row18_col6" class="data row18 col6" >0.0077</td>
      <td id="T_843c3_row18_col7" class="data row18 col7" >38.0081</td>
      <td id="T_843c3_row18_col8" class="data row18 col8" >19.8524</td>
      <td id="T_843c3_row18_col9" class="data row18 col9" >767.8455</td>
      <td id="T_843c3_row18_col10" class="data row18 col10" >0.0922</td>
    </tr>
    <tr>
      <th id="T_843c3_level0_row19" class="row_heading level0 row19" >R_4</th>
      <td id="T_843c3_row19_col0" class="data row19 col0" >5531451.0000</td>
      <td id="T_843c3_row19_col1" class="data row19 col1" >0.0312</td>
      <td id="T_843c3_row19_col2" class="data row19 col2" >0.1598</td>
      <td id="T_843c3_row19_col3" class="data row19 col3" >0.0000</td>
      <td id="T_843c3_row19_col4" class="data row19 col4" >0.0026</td>
      <td id="T_843c3_row19_col5" class="data row19 col5" >0.0051</td>
      <td id="T_843c3_row19_col6" class="data row19 col6" >0.0077</td>
      <td id="T_843c3_row19_col7" class="data row19 col7" >1.0100</td>
      <td id="T_843c3_row19_col8" class="data row19 col8" >5.9290</td>
      <td id="T_843c3_row19_col9" class="data row19 col9" >36.1658</td>
      <td id="T_843c3_row19_col10" class="data row19 col10" >0.0255</td>
    </tr>
    <tr>
      <th id="T_843c3_level0_row20" class="row_heading level0 row20" >R_3</th>
      <td id="T_843c3_row20_col0" class="data row20 col0" >5531451.0000</td>
      <td id="T_843c3_row20_col1" class="data row20 col1" >0.1208</td>
      <td id="T_843c3_row20_col2" class="data row20 col2" >0.2105</td>
      <td id="T_843c3_row20_col3" class="data row20 col3" >0.0000</td>
      <td id="T_843c3_row20_col4" class="data row20 col4" >0.0047</td>
      <td id="T_843c3_row20_col5" class="data row20 col5" >0.0094</td>
      <td id="T_843c3_row20_col6" class="data row20 col6" >0.2003</td>
      <td id="T_843c3_row20_col7" class="data row20 col7" >11.6026</td>
      <td id="T_843c3_row20_col8" class="data row20 col8" >4.9505</td>
      <td id="T_843c3_row20_col9" class="data row20 col9" >62.8252</td>
      <td id="T_843c3_row20_col10" class="data row20 col10" >0.0443</td>
    </tr>
    <tr>
      <th id="T_843c3_level0_row21" class="row_heading level0 row21" >R_28</th>
      <td id="T_843c3_row21_col0" class="data row21 col0" >5531451.0000</td>
      <td id="T_843c3_row21_col1" class="data row21 col1" >0.0057</td>
      <td id="T_843c3_row21_col2" class="data row21 col2" >0.0274</td>
      <td id="T_843c3_row21_col3" class="data row21 col3" >0.0000</td>
      <td id="T_843c3_row21_col4" class="data row21 col4" >0.0025</td>
      <td id="T_843c3_row21_col5" class="data row21 col5" >0.0050</td>
      <td id="T_843c3_row21_col6" class="data row21 col6" >0.0075</td>
      <td id="T_843c3_row21_col7" class="data row21 col7" >1.0100</td>
      <td id="T_843c3_row21_col8" class="data row21 col8" >36.0664</td>
      <td id="T_843c3_row21_col9" class="data row21 col9" >1316.4533</td>
      <td id="T_843c3_row21_col10" class="data row21 col10" >0.0007</td>
    </tr>
    <tr>
      <th id="T_843c3_level0_row22" class="row_heading level0 row22" >R_19</th>
      <td id="T_843c3_row22_col0" class="data row22 col0" >5531451.0000</td>
      <td id="T_843c3_row22_col1" class="data row22 col1" >0.0227</td>
      <td id="T_843c3_row22_col2" class="data row22 col2" >0.1319</td>
      <td id="T_843c3_row22_col3" class="data row22 col3" >0.0000</td>
      <td id="T_843c3_row22_col4" class="data row22 col4" >0.0025</td>
      <td id="T_843c3_row22_col5" class="data row22 col5" >0.0051</td>
      <td id="T_843c3_row22_col6" class="data row22 col6" >0.0076</td>
      <td id="T_843c3_row22_col7" class="data row22 col7" >1.0100</td>
      <td id="T_843c3_row22_col8" class="data row22 col8" >7.3115</td>
      <td id="T_843c3_row22_col9" class="data row22 col9" >54.4858</td>
      <td id="T_843c3_row22_col10" class="data row22 col10" >0.0174</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Histogramas</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lista de las variables de Risk para las que quieres hacer histogramas</span>
<span class="n">risk_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;R_1&#39;</span><span class="p">,</span> <span class="s1">&#39;R_2&#39;</span><span class="p">,</span> <span class="s1">&#39;R_3&#39;</span><span class="p">,</span> <span class="s1">&#39;R_4&#39;</span><span class="p">]</span>  <span class="c1"># Cambia estas columnas según tu data</span>

<span class="c1"># Crear una figura con 2 filas y 2 columnas</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># Lista de los nombres de las variables para los títulos</span>
<span class="n">risk_titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;R_1&#39;</span><span class="p">,</span> <span class="s1">&#39;R_2&#39;</span><span class="p">,</span> <span class="s1">&#39;R_3&#39;</span><span class="p">,</span> <span class="s1">&#39;R_4&#39;</span><span class="p">]</span>

<span class="c1"># Iterar sobre las columnas y los ejes para crear los histogramas</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">risk_columns</span><span class="p">):</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">col_idx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">risk_imputed_filtered</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;skyblue&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Histograma: </span><span class="si">{</span><span class="n">risk_titles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Ajustar el layout</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Mostrar el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="para-el-grupo-balance">
<h4>Para el grupo <code class="docutils literal notranslate"><span class="pre">Balance</span></code><a class="headerlink" href="#para-el-grupo-balance" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>Distribución General:</p></li>
</ol>
<ul class="simple">
<li><p>La mayoría de las variables tienen medias muy bajas, lo que indica que están centradas alrededor de valores cercanos a cero.</p></li>
<li><p>Las variables como B_13 y B_9 muestran valores de skewness altamente positivos (178.58 y 16.58, respectivamente), lo que sugiere que sus distribuciones tienen colas largas hacia la derecha, con una concentración significativa de datos en valores bajos.</p></li>
<li><p>Por otro lado, variables como B_2 y B_5 tienen distribuciones relativamente más equilibradas, con valores de skewness más cercanos a cero (indicando simetría o una menor inclinación de la distribución).</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>Dispersión y Valores Extremos:</p></li>
</ol>
<ul class="simple">
<li><p>Las desviaciones estándar más altas se observan en variables como B_3 (2.5867) y B_8 (1.4798), lo que indica una mayor variabilidad de los datos en comparación con otras variables.</p></li>
<li><p>En cuanto a valores máximos, algunas variables presentan outliers significativos. Por ejemplo, B_13 tiene un valor máximo de 276.18, lo que resalta una gran diferencia en comparación con otras observaciones de la misma variable. Otros valores máximos inusualmente altos son observados en B_9 y B_4.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>Simetría y Curtosis:</p></li>
</ol>
<ul class="simple">
<li><p>Muchas de las variables muestran asimetría positiva (skewness), como en B_12 y B_14, lo que significa que tienen colas a la derecha, mientras que algunas, como B_5, tienen skewness negativo, lo que indica que los valores bajos son más frecuentes.</p></li>
<li><p>Las variables como B_13 y B_9 tienen curtosis extremadamente alta, lo que sugiere que tienen distribuciones leptocúrticas con picos pronunciados y colas largas, lo que indica la presencia de outliers.</p></li>
</ul>
<ol class="arabic simple" start="4">
<li><p>Varianza:</p></li>
</ol>
<ul class="simple">
<li><p>Las varianzas también muestran patrones interesantes, con algunas variables como B_8 presentando una varianza alta (2.1890), mientras que otras, como B_16, tienen una varianza muy baja (0.0861).</p></li>
<li><p>Las variables con mayor varianza tienden a estar más dispersas, mientras que las que tienen varianza baja están más concentradas alrededor de la media.</p></li>
</ul>
<ol class="arabic simple" start="5">
<li><p>Anomalías:</p></li>
</ol>
<ul class="simple">
<li><p>Variables como B_3 y B_9 tienen valores máximos muy superiores al percentil 75%, lo que indica la presencia de valores atípicos que podrían influir significativamente en el análisis.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Seleccionar solo las columnas numéricas del DataFrame</span>
<span class="n">numerical_data</span> <span class="o">=</span> <span class="n">balance_imputed_filtered</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span>

<span class="c1"># Calcular estadísticas básicas</span>
<span class="n">basic_stats</span> <span class="o">=</span> <span class="n">numerical_data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># Transponer para mejor visualización</span>

<span class="c1"># Calcular la simetría (skewness) y curtosis</span>
<span class="n">basic_stats</span><span class="p">[</span><span class="s1">&#39;Skewness&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numerical_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">skew</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dropna</span><span class="p">()))</span>
<span class="n">basic_stats</span><span class="p">[</span><span class="s1">&#39;Kurtosis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numerical_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">kurtosis</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">fisher</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="c1"># Añadir la varianza</span>
<span class="n">basic_stats</span><span class="p">[</span><span class="s1">&#39;Variance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numerical_data</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
<span class="n">styled_basic_stats</span> <span class="o">=</span> <span class="n">basic_stats</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># Format to 2 decimal places</span>
<span class="n">display</span><span class="p">(</span><span class="n">styled_basic_stats</span><span class="p">)</span> <span class="c1"># Display using IPython&#39;s display function</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_3da67" class="dataframe">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_3da67_level0_col0" class="col_heading level0 col0" >count</th>
      <th id="T_3da67_level0_col1" class="col_heading level0 col1" >mean</th>
      <th id="T_3da67_level0_col2" class="col_heading level0 col2" >std</th>
      <th id="T_3da67_level0_col3" class="col_heading level0 col3" >min</th>
      <th id="T_3da67_level0_col4" class="col_heading level0 col4" >25%</th>
      <th id="T_3da67_level0_col5" class="col_heading level0 col5" >50%</th>
      <th id="T_3da67_level0_col6" class="col_heading level0 col6" >75%</th>
      <th id="T_3da67_level0_col7" class="col_heading level0 col7" >max</th>
      <th id="T_3da67_level0_col8" class="col_heading level0 col8" >Skewness</th>
      <th id="T_3da67_level0_col9" class="col_heading level0 col9" >Kurtosis</th>
      <th id="T_3da67_level0_col10" class="col_heading level0 col10" >Variance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_3da67_level0_row0" class="row_heading level0 row0" >B_13</th>
      <td id="T_3da67_row0_col0" class="data row0 col0" >5531451.0000</td>
      <td id="T_3da67_row0_col1" class="data row0 col1" >0.1002</td>
      <td id="T_3da67_row0_col2" class="data row0 col2" >0.5569</td>
      <td id="T_3da67_row0_col3" class="data row0 col3" >-1.3979</td>
      <td id="T_3da67_row0_col4" class="data row0 col4" >0.0093</td>
      <td id="T_3da67_row0_col5" class="data row0 col5" >0.0295</td>
      <td id="T_3da67_row0_col6" class="data row0 col6" >0.0888</td>
      <td id="T_3da67_row0_col7" class="data row0 col7" >276.1778</td>
      <td id="T_3da67_row0_col8" class="data row0 col8" >178.5860</td>
      <td id="T_3da67_row0_col9" class="data row0 col9" >66860.9739</td>
      <td id="T_3da67_row0_col10" class="data row0 col10" >0.3101</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row1" class="row_heading level0 row1" >B_8</th>
      <td id="T_3da67_row1_col0" class="data row1 col0" >5531451.0000</td>
      <td id="T_3da67_row1_col1" class="data row1 col1" >0.4509</td>
      <td id="T_3da67_row1_col2" class="data row1 col2" >0.4962</td>
      <td id="T_3da67_row1_col3" class="data row1 col3" >-2.8878</td>
      <td id="T_3da67_row1_col4" class="data row1 col4" >0.0045</td>
      <td id="T_3da67_row1_col5" class="data row1 col5" >0.0091</td>
      <td id="T_3da67_row1_col6" class="data row1 col6" >1.0042</td>
      <td id="T_3da67_row1_col7" class="data row1 col7" >2.6499</td>
      <td id="T_3da67_row1_col8" class="data row1 col8" >0.2178</td>
      <td id="T_3da67_row1_col9" class="data row1 col9" >1.0513</td>
      <td id="T_3da67_row1_col10" class="data row1 col10" >0.2462</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row2" class="row_heading level0 row2" >B_25</th>
      <td id="T_3da67_row2_col0" class="data row2 col0" >5531451.0000</td>
      <td id="T_3da67_row2_col1" class="data row2 col1" >0.1038</td>
      <td id="T_3da67_row2_col2" class="data row2 col2" >0.2090</td>
      <td id="T_3da67_row2_col3" class="data row2 col3" >-11.2536</td>
      <td id="T_3da67_row2_col4" class="data row2 col4" >0.0060</td>
      <td id="T_3da67_row2_col5" class="data row2 col5" >0.0198</td>
      <td id="T_3da67_row2_col6" class="data row2 col6" >0.1061</td>
      <td id="T_3da67_row2_col7" class="data row2 col7" >15.6998</td>
      <td id="T_3da67_row2_col8" class="data row2 col8" >5.1892</td>
      <td id="T_3da67_row2_col9" class="data row2 col9" >81.7152</td>
      <td id="T_3da67_row2_col10" class="data row2 col10" >0.0437</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row3" class="row_heading level0 row3" >B_15</th>
      <td id="T_3da67_row3_col0" class="data row3 col0" >5531451.0000</td>
      <td id="T_3da67_row3_col1" class="data row3 col1" >0.0528</td>
      <td id="T_3da67_row3_col2" class="data row3 col2" >0.3004</td>
      <td id="T_3da67_row3_col3" class="data row3 col3" >-10.0080</td>
      <td id="T_3da67_row3_col4" class="data row3 col4" >0.0031</td>
      <td id="T_3da67_row3_col5" class="data row3 col5" >0.0062</td>
      <td id="T_3da67_row3_col6" class="data row3 col6" >0.0093</td>
      <td id="T_3da67_row3_col7" class="data row3 col7" >65.0374</td>
      <td id="T_3da67_row3_col8" class="data row3 col8" >38.5571</td>
      <td id="T_3da67_row3_col9" class="data row3 col9" >3574.6407</td>
      <td id="T_3da67_row3_col10" class="data row3 col10" >0.0902</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row4" class="row_heading level0 row4" >B_3</th>
      <td id="T_3da67_row4_col0" class="data row4 col0" >5531451.0000</td>
      <td id="T_3da67_row4_col1" class="data row4 col1" >0.1325</td>
      <td id="T_3da67_row4_col2" class="data row4 col2" >0.2350</td>
      <td id="T_3da67_row4_col3" class="data row4 col3" >0.0000</td>
      <td id="T_3da67_row4_col4" class="data row4 col4" >0.0052</td>
      <td id="T_3da67_row4_col5" class="data row4 col5" >0.0098</td>
      <td id="T_3da67_row4_col6" class="data row4 col6" >0.1551</td>
      <td id="T_3da67_row4_col7" class="data row4 col7" >1.6253</td>
      <td id="T_3da67_row4_col8" class="data row4 col8" >2.2186</td>
      <td id="T_3da67_row4_col9" class="data row4 col9" >7.5002</td>
      <td id="T_3da67_row4_col10" class="data row4 col10" >0.0552</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row5" class="row_heading level0 row5" >B_22</th>
      <td id="T_3da67_row5_col0" class="data row5 col0" >5531451.0000</td>
      <td id="T_3da67_row5_col1" class="data row5 col1" >0.1072</td>
      <td id="T_3da67_row5_col2" class="data row5 col2" >0.2232</td>
      <td id="T_3da67_row5_col3" class="data row5 col3" >0.0000</td>
      <td id="T_3da67_row5_col4" class="data row5 col4" >0.0031</td>
      <td id="T_3da67_row5_col5" class="data row5 col5" >0.0062</td>
      <td id="T_3da67_row5_col6" class="data row5 col6" >0.0092</td>
      <td id="T_3da67_row5_col7" class="data row5 col7" >3.5078</td>
      <td id="T_3da67_row5_col8" class="data row5 col8" >2.2443</td>
      <td id="T_3da67_row5_col9" class="data row5 col9" >8.9513</td>
      <td id="T_3da67_row5_col10" class="data row5 col10" >0.0498</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row6" class="row_heading level0 row6" >B_16</th>
      <td id="T_3da67_row6_col0" class="data row6 col0" >5531451.0000</td>
      <td id="T_3da67_row6_col1" class="data row6 col1" >0.3486</td>
      <td id="T_3da67_row6_col2" class="data row6 col2" >0.4023</td>
      <td id="T_3da67_row6_col3" class="data row6 col3" >-0.0367</td>
      <td id="T_3da67_row6_col4" class="data row6 col4" >0.0062</td>
      <td id="T_3da67_row6_col5" class="data row6 col5" >0.0918</td>
      <td id="T_3da67_row6_col6" class="data row6 col6" >0.7566</td>
      <td id="T_3da67_row6_col7" class="data row6 col7" >1.0100</td>
      <td id="T_3da67_row6_col8" class="data row6 col8" >0.6943</td>
      <td id="T_3da67_row6_col9" class="data row6 col9" >1.7644</td>
      <td id="T_3da67_row6_col10" class="data row6 col10" >0.1618</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row7" class="row_heading level0 row7" >B_20</th>
      <td id="T_3da67_row7_col0" class="data row7 col0" >5531451.0000</td>
      <td id="T_3da67_row7_col1" class="data row7 col1" >0.2363</td>
      <td id="T_3da67_row7_col2" class="data row7 col2" >0.3736</td>
      <td id="T_3da67_row7_col3" class="data row7 col3" >0.0000</td>
      <td id="T_3da67_row7_col4" class="data row7 col4" >0.0040</td>
      <td id="T_3da67_row7_col5" class="data row7 col5" >0.0081</td>
      <td id="T_3da67_row7_col6" class="data row7 col6" >0.3578</td>
      <td id="T_3da67_row7_col7" class="data row7 col7" >1.0100</td>
      <td id="T_3da67_row7_col8" class="data row7 col8" >1.3061</td>
      <td id="T_3da67_row7_col9" class="data row7 col9" >2.9935</td>
      <td id="T_3da67_row7_col10" class="data row7 col10" >0.1396</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row8" class="row_heading level0 row8" >B_19</th>
      <td id="T_3da67_row8_col0" class="data row8 col0" >5531451.0000</td>
      <td id="T_3da67_row8_col1" class="data row8 col1" >0.1502</td>
      <td id="T_3da67_row8_col2" class="data row8 col2" >0.2896</td>
      <td id="T_3da67_row8_col3" class="data row8 col3" >-1.0832</td>
      <td id="T_3da67_row8_col4" class="data row8 col4" >0.0035</td>
      <td id="T_3da67_row8_col5" class="data row8 col5" >0.0069</td>
      <td id="T_3da67_row8_col6" class="data row8 col6" >0.0958</td>
      <td id="T_3da67_row8_col7" class="data row8 col7" >1.0485</td>
      <td id="T_3da67_row8_col8" class="data row8 col8" >1.9224</td>
      <td id="T_3da67_row8_col9" class="data row8 col9" >5.2984</td>
      <td id="T_3da67_row8_col10" class="data row8 col10" >0.0839</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row9" class="row_heading level0 row9" >B_26</th>
      <td id="T_3da67_row9_col0" class="data row9 col0" >5531451.0000</td>
      <td id="T_3da67_row9_col1" class="data row9 col1" >0.0906</td>
      <td id="T_3da67_row9_col2" class="data row9 col2" >2.5877</td>
      <td id="T_3da67_row9_col3" class="data row9 col3" >-2.3525</td>
      <td id="T_3da67_row9_col4" class="data row9 col4" >0.0026</td>
      <td id="T_3da67_row9_col5" class="data row9 col5" >0.0052</td>
      <td id="T_3da67_row9_col6" class="data row9 col6" >0.0079</td>
      <td id="T_3da67_row9_col7" class="data row9 col7" >1499.2203</td>
      <td id="T_3da67_row9_col8" class="data row9 col8" >210.3830</td>
      <td id="T_3da67_row9_col9" class="data row9 col9" >83790.8698</td>
      <td id="T_3da67_row9_col10" class="data row9 col10" >6.6964</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row10" class="row_heading level0 row10" >B_33</th>
      <td id="T_3da67_row10_col0" class="data row10 col0" >5531451.0000</td>
      <td id="T_3da67_row10_col1" class="data row10 col1" >0.6122</td>
      <td id="T_3da67_row10_col2" class="data row10 col2" >0.4883</td>
      <td id="T_3da67_row10_col3" class="data row10 col3" >0.0000</td>
      <td id="T_3da67_row10_col4" class="data row10 col4" >0.0064</td>
      <td id="T_3da67_row10_col5" class="data row10 col5" >1.0018</td>
      <td id="T_3da67_row10_col6" class="data row10 col6" >1.0059</td>
      <td id="T_3da67_row10_col7" class="data row10 col7" >1.3743</td>
      <td id="T_3da67_row10_col8" class="data row10 col8" >-0.4393</td>
      <td id="T_3da67_row10_col9" class="data row10 col9" >1.1933</td>
      <td id="T_3da67_row10_col10" class="data row10 col10" >0.2384</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row11" class="row_heading level0 row11" >B_27</th>
      <td id="T_3da67_row11_col0" class="data row11 col0" >5531451.0000</td>
      <td id="T_3da67_row11_col1" class="data row11 col1" >0.0050</td>
      <td id="T_3da67_row11_col2" class="data row11 col2" >0.0030</td>
      <td id="T_3da67_row11_col3" class="data row11 col3" >0.0000</td>
      <td id="T_3da67_row11_col4" class="data row11 col4" >0.0025</td>
      <td id="T_3da67_row11_col5" class="data row11 col5" >0.0050</td>
      <td id="T_3da67_row11_col6" class="data row11 col6" >0.0075</td>
      <td id="T_3da67_row11_col7" class="data row11 col7" >1.0054</td>
      <td id="T_3da67_row11_col8" class="data row11 col8" >15.8944</td>
      <td id="T_3da67_row11_col9" class="data row11 col9" >4622.5426</td>
      <td id="T_3da67_row11_col10" class="data row11 col10" >0.0000</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row12" class="row_heading level0 row12" >B_41</th>
      <td id="T_3da67_row12_col0" class="data row12 col0" >5531451.0000</td>
      <td id="T_3da67_row12_col1" class="data row12 col1" >0.0323</td>
      <td id="T_3da67_row12_col2" class="data row12 col2" >0.2223</td>
      <td id="T_3da67_row12_col3" class="data row12 col3" >-0.1625</td>
      <td id="T_3da67_row12_col4" class="data row12 col4" >0.0026</td>
      <td id="T_3da67_row12_col5" class="data row12 col5" >0.0051</td>
      <td id="T_3da67_row12_col6" class="data row12 col6" >0.0077</td>
      <td id="T_3da67_row12_col7" class="data row12 col7" >22.0049</td>
      <td id="T_3da67_row12_col8" class="data row12 col8" >15.3011</td>
      <td id="T_3da67_row12_col9" class="data row12 col9" >486.0635</td>
      <td id="T_3da67_row12_col10" class="data row12 col10" >0.0494</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row13" class="row_heading level0 row13" >B_6</th>
      <td id="T_3da67_row13_col0" class="data row13 col0" >5531451.0000</td>
      <td id="T_3da67_row13_col1" class="data row13 col1" >0.1521</td>
      <td id="T_3da67_row13_col2" class="data row13 col2" >1.4767</td>
      <td id="T_3da67_row13_col3" class="data row13 col3" >-0.1768</td>
      <td id="T_3da67_row13_col4" class="data row13 col4" >0.0205</td>
      <td id="T_3da67_row13_col5" class="data row13 col5" >0.0834</td>
      <td id="T_3da67_row13_col6" class="data row13 col6" >0.1919</td>
      <td id="T_3da67_row13_col7" class="data row13 col7" >1214.5169</td>
      <td id="T_3da67_row13_col8" class="data row13 col8" >395.8284</td>
      <td id="T_3da67_row13_col9" class="data row13 col9" >236281.2604</td>
      <td id="T_3da67_row13_col10" class="data row13 col10" >2.1808</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row14" class="row_heading level0 row14" >B_40</th>
      <td id="T_3da67_row14_col0" class="data row14 col0" >5531451.0000</td>
      <td id="T_3da67_row14_col1" class="data row14 col1" >0.2033</td>
      <td id="T_3da67_row14_col2" class="data row14 col2" >8.0813</td>
      <td id="T_3da67_row14_col3" class="data row14 col3" >-0.3429</td>
      <td id="T_3da67_row14_col4" class="data row14 col4" >0.0174</td>
      <td id="T_3da67_row14_col5" class="data row14 col5" >0.0583</td>
      <td id="T_3da67_row14_col6" class="data row14 col6" >0.2452</td>
      <td id="T_3da67_row14_col7" class="data row14 col7" >5755.0760</td>
      <td id="T_3da67_row14_col8" class="data row14 col8" >475.8837</td>
      <td id="T_3da67_row14_col9" class="data row14 col9" >246293.1126</td>
      <td id="T_3da67_row14_col10" class="data row14 col10" >65.3075</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row15" class="row_heading level0 row15" >B_4</th>
      <td id="T_3da67_row15_col0" class="data row15 col0" >5531451.0000</td>
      <td id="T_3da67_row15_col1" class="data row15 col1" >0.1726</td>
      <td id="T_3da67_row15_col2" class="data row15 col2" >0.2224</td>
      <td id="T_3da67_row15_col3" class="data row15 col3" >0.0000</td>
      <td id="T_3da67_row15_col4" class="data row15 col4" >0.0275</td>
      <td id="T_3da67_row15_col5" class="data row15 col5" >0.0822</td>
      <td id="T_3da67_row15_col6" class="data row15 col6" >0.2389</td>
      <td id="T_3da67_row15_col7" class="data row15 col7" >19.8033</td>
      <td id="T_3da67_row15_col8" class="data row15 col8" >2.6073</td>
      <td id="T_3da67_row15_col9" class="data row15 col9" >23.6968</td>
      <td id="T_3da67_row15_col10" class="data row15 col10" >0.0495</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row16" class="row_heading level0 row16" >B_5</th>
      <td id="T_3da67_row16_col0" class="data row16 col0" >5531451.0000</td>
      <td id="T_3da67_row16_col1" class="data row16 col1" >0.0831</td>
      <td id="T_3da67_row16_col2" class="data row16 col2" >0.3970</td>
      <td id="T_3da67_row16_col3" class="data row16 col3" >0.0000</td>
      <td id="T_3da67_row16_col4" class="data row16 col4" >0.0073</td>
      <td id="T_3da67_row16_col5" class="data row16 col5" >0.0154</td>
      <td id="T_3da67_row16_col6" class="data row16 col6" >0.0537</td>
      <td id="T_3da67_row16_col7" class="data row16 col7" >144.2070</td>
      <td id="T_3da67_row16_col8" class="data row16 col8" >83.5776</td>
      <td id="T_3da67_row16_col9" class="data row16 col9" >18716.6490</td>
      <td id="T_3da67_row16_col10" class="data row16 col10" >0.1576</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row17" class="row_heading level0 row17" >B_10</th>
      <td id="T_3da67_row17_col0" class="data row17 col0" >5531451.0000</td>
      <td id="T_3da67_row17_col1" class="data row17 col1" >0.2316</td>
      <td id="T_3da67_row17_col2" class="data row17 col2" >4.7998</td>
      <td id="T_3da67_row17_col3" class="data row17 col3" >-0.0030</td>
      <td id="T_3da67_row17_col4" class="data row17 col4" >0.0290</td>
      <td id="T_3da67_row17_col5" class="data row17 col5" >0.1106</td>
      <td id="T_3da67_row17_col6" class="data row17 col6" >0.2955</td>
      <td id="T_3da67_row17_col7" class="data row17 col7" >4097.4407</td>
      <td id="T_3da67_row17_col8" class="data row17 col8" >376.0100</td>
      <td id="T_3da67_row17_col9" class="data row17 col9" >236698.4113</td>
      <td id="T_3da67_row17_col10" class="data row17 col10" >23.0385</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row18" class="row_heading level0 row18" >B_7</th>
      <td id="T_3da67_row18_col0" class="data row18 col0" >5531451.0000</td>
      <td id="T_3da67_row18_col1" class="data row18 col1" >0.1861</td>
      <td id="T_3da67_row18_col2" class="data row18 col2" >0.2304</td>
      <td id="T_3da67_row18_col3" class="data row18 col3" >-2.6527</td>
      <td id="T_3da67_row18_col4" class="data row18 col4" >0.0282</td>
      <td id="T_3da67_row18_col5" class="data row18 col5" >0.0757</td>
      <td id="T_3da67_row18_col6" class="data row18 col6" >0.2709</td>
      <td id="T_3da67_row18_col7" class="data row18 col7" >1.2528</td>
      <td id="T_3da67_row18_col8" class="data row18 col8" >1.7955</td>
      <td id="T_3da67_row18_col9" class="data row18 col9" >6.1669</td>
      <td id="T_3da67_row18_col10" class="data row18 col10" >0.0531</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row19" class="row_heading level0 row19" >B_28</th>
      <td id="T_3da67_row19_col0" class="data row19 col0" >5531451.0000</td>
      <td id="T_3da67_row19_col1" class="data row19 col1" >0.1545</td>
      <td id="T_3da67_row19_col2" class="data row19 col2" >0.2275</td>
      <td id="T_3da67_row19_col3" class="data row19 col3" >-0.0000</td>
      <td id="T_3da67_row19_col4" class="data row19 col4" >0.0275</td>
      <td id="T_3da67_row19_col5" class="data row19 col5" >0.0771</td>
      <td id="T_3da67_row19_col6" class="data row19 col6" >0.1944</td>
      <td id="T_3da67_row19_col7" class="data row19 col7" >25.5334</td>
      <td id="T_3da67_row19_col8" class="data row19 col8" >8.0255</td>
      <td id="T_3da67_row19_col9" class="data row19 col9" >291.9475</td>
      <td id="T_3da67_row19_col10" class="data row19 col10" >0.0518</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row20" class="row_heading level0 row20" >B_36</th>
      <td id="T_3da67_row20_col0" class="data row20 col0" >5531451.0000</td>
      <td id="T_3da67_row20_col1" class="data row20 col1" >0.0064</td>
      <td id="T_3da67_row20_col2" class="data row20 col2" >0.0212</td>
      <td id="T_3da67_row20_col3" class="data row20 col3" >0.0000</td>
      <td id="T_3da67_row20_col4" class="data row20 col4" >0.0025</td>
      <td id="T_3da67_row20_col5" class="data row20 col5" >0.0050</td>
      <td id="T_3da67_row20_col6" class="data row20 col6" >0.0075</td>
      <td id="T_3da67_row20_col7" class="data row20 col7" >1.0023</td>
      <td id="T_3da67_row20_col8" class="data row20 col8" >17.5471</td>
      <td id="T_3da67_row20_col9" class="data row20 col9" >343.7625</td>
      <td id="T_3da67_row20_col10" class="data row20 col10" >0.0005</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row21" class="row_heading level0 row21" >B_11</th>
      <td id="T_3da67_row21_col0" class="data row21 col0" >5531451.0000</td>
      <td id="T_3da67_row21_col1" class="data row21 col1" >0.1110</td>
      <td id="T_3da67_row21_col2" class="data row21 col2" >0.2083</td>
      <td id="T_3da67_row21_col3" class="data row21 col3" >0.0000</td>
      <td id="T_3da67_row21_col4" class="data row21 col4" >0.0066</td>
      <td id="T_3da67_row21_col5" class="data row21 col5" >0.0195</td>
      <td id="T_3da67_row21_col6" class="data row21 col6" >0.1020</td>
      <td id="T_3da67_row21_col7" class="data row21 col7" >1.9704</td>
      <td id="T_3da67_row21_col8" class="data row21 col8" >2.9299</td>
      <td id="T_3da67_row21_col9" class="data row21 col9" >12.5839</td>
      <td id="T_3da67_row21_col10" class="data row21 col10" >0.0434</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row22" class="row_heading level0 row22" >B_12</th>
      <td id="T_3da67_row22_col0" class="data row22 col0" >5531451.0000</td>
      <td id="T_3da67_row22_col1" class="data row22 col1" >0.0937</td>
      <td id="T_3da67_row22_col2" class="data row22 col2" >0.8204</td>
      <td id="T_3da67_row22_col3" class="data row22 col3" >0.0000</td>
      <td id="T_3da67_row22_col4" class="data row22 col4" >0.0109</td>
      <td id="T_3da67_row22_col5" class="data row22 col5" >0.0194</td>
      <td id="T_3da67_row22_col6" class="data row22 col6" >0.0691</td>
      <td id="T_3da67_row22_col7" class="data row22 col7" >420.7490</td>
      <td id="T_3da67_row22_col8" class="data row22 col8" >318.7442</td>
      <td id="T_3da67_row22_col9" class="data row22 col9" >147729.0142</td>
      <td id="T_3da67_row22_col10" class="data row22 col10" >0.6731</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row23" class="row_heading level0 row23" >B_9</th>
      <td id="T_3da67_row23_col0" class="data row23 col0" >5531451.0000</td>
      <td id="T_3da67_row23_col1" class="data row23 col1" >0.1895</td>
      <td id="T_3da67_row23_col2" class="data row23 col2" >0.2863</td>
      <td id="T_3da67_row23_col3" class="data row23 col3" >0.0000</td>
      <td id="T_3da67_row23_col4" class="data row23 col4" >0.0058</td>
      <td id="T_3da67_row23_col5" class="data row23 col5" >0.0259</td>
      <td id="T_3da67_row23_col6" class="data row23 col6" >0.3343</td>
      <td id="T_3da67_row23_col7" class="data row23 col7" >27.4249</td>
      <td id="T_3da67_row23_col8" class="data row23 col8" >5.1787</td>
      <td id="T_3da67_row23_col9" class="data row23 col9" >177.9623</td>
      <td id="T_3da67_row23_col10" class="data row23 col10" >0.0820</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row24" class="row_heading level0 row24" >B_24</th>
      <td id="T_3da67_row24_col0" class="data row24 col0" >5531451.0000</td>
      <td id="T_3da67_row24_col1" class="data row24 col1" >0.0397</td>
      <td id="T_3da67_row24_col2" class="data row24 col2" >0.3172</td>
      <td id="T_3da67_row24_col3" class="data row24 col3" >0.0000</td>
      <td id="T_3da67_row24_col4" class="data row24 col4" >0.0026</td>
      <td id="T_3da67_row24_col5" class="data row24 col5" >0.0052</td>
      <td id="T_3da67_row24_col6" class="data row24 col6" >0.0078</td>
      <td id="T_3da67_row24_col7" class="data row24 col7" >46.6066</td>
      <td id="T_3da67_row24_col8" class="data row24 col8" >22.2863</td>
      <td id="T_3da67_row24_col9" class="data row24 col9" >993.2236</td>
      <td id="T_3da67_row24_col10" class="data row24 col10" >0.1006</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row25" class="row_heading level0 row25" >B_21</th>
      <td id="T_3da67_row25_col0" class="data row25 col0" >5531451.0000</td>
      <td id="T_3da67_row25_col1" class="data row25 col1" >0.0532</td>
      <td id="T_3da67_row25_col2" class="data row25 col2" >0.7196</td>
      <td id="T_3da67_row25_col3" class="data row25 col3" >0.0000</td>
      <td id="T_3da67_row25_col4" class="data row25 col4" >0.0026</td>
      <td id="T_3da67_row25_col5" class="data row25 col5" >0.0051</td>
      <td id="T_3da67_row25_col6" class="data row25 col6" >0.0077</td>
      <td id="T_3da67_row25_col7" class="data row25 col7" >288.2943</td>
      <td id="T_3da67_row25_col8" class="data row25 col8" >56.6510</td>
      <td id="T_3da67_row25_col9" class="data row25 col9" >9433.7589</td>
      <td id="T_3da67_row25_col10" class="data row25 col10" >0.5179</td>
    </tr>
    <tr>
      <th id="T_3da67_level0_row26" class="row_heading level0 row26" >B_32</th>
      <td id="T_3da67_row26_col0" class="data row26 col0" >5531451.0000</td>
      <td id="T_3da67_row26_col1" class="data row26 col1" >0.0274</td>
      <td id="T_3da67_row26_col2" class="data row26 col2" >0.1481</td>
      <td id="T_3da67_row26_col3" class="data row26 col3" >0.0000</td>
      <td id="T_3da67_row26_col4" class="data row26 col4" >0.0026</td>
      <td id="T_3da67_row26_col5" class="data row26 col5" >0.0051</td>
      <td id="T_3da67_row26_col6" class="data row26 col6" >0.0077</td>
      <td id="T_3da67_row26_col7" class="data row26 col7" >1.0100</td>
      <td id="T_3da67_row26_col8" class="data row26 col8" >6.4489</td>
      <td id="T_3da67_row26_col9" class="data row26 col9" >42.6052</td>
      <td id="T_3da67_row26_col10" class="data row26 col10" >0.0219</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Regplot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Lista de las variables de Balance para las que quieres hacer regplots</span>
<span class="n">balance_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;B_3&#39;</span><span class="p">,</span> <span class="s1">&#39;B_4&#39;</span><span class="p">,</span> <span class="s1">&#39;B_5&#39;</span><span class="p">,</span> <span class="s1">&#39;B_6&#39;</span><span class="p">]</span>  <span class="c1"># Cambia estas columnas según tu data</span>

<span class="c1"># Crear una figura con 2 filas y 2 columnas</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># Lista de los nombres de las variables para los títulos</span>
<span class="n">balance_titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;B_3&#39;</span><span class="p">,</span> <span class="s1">&#39;B_4&#39;</span><span class="p">,</span> <span class="s1">&#39;B_5&#39;</span><span class="p">,</span> <span class="s1">&#39;B_6&#39;</span><span class="p">]</span>

<span class="c1"># Iterar sobre las columnas y los ejes para crear los gráficos de regplot</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">balance_columns</span><span class="p">):</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">col_idx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">balance_imputed_filtered</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">delinquency_imputed_pd</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Regplot: </span><span class="si">{</span><span class="n">balance_titles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1"> vs target&#39;</span><span class="p">)</span>

<span class="c1"># Ajustar el layout</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Mostrar el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-12-9683a6117c58&gt;</span> in <span class="ni">&lt;cell line: 14&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span>     <span class="n">row</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span>     <span class="n">col_idx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span>
<span class="ne">---&gt; </span><span class="mi">17</span>     <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">balance_imputed_filtered</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">delinquency_imputed_pd</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">])</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span>     <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Regplot: </span><span class="si">{</span><span class="n">balance_titles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1"> vs target&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">19</span> 

<span class="nn">/usr/local/lib/python3.10/dist-packages/seaborn/regression.py</span> in <span class="ni">regplot</span><span class="nt">(data, x, y, x_estimator, x_bins, x_ci, scatter, fit_reg, ci, n_boot, units, seed, order, logistic, lowess, robust, logx, x_partial, y_partial, truncate, dropna, x_jitter, y_jitter, label, color, marker, scatter_kws, line_kws, ax)</span>
<span class="g g-Whitespace">    </span><span class="mi">773</span>     <span class="n">scatter_kws</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">marker</span>
<span class="g g-Whitespace">    </span><span class="mi">774</span>     <span class="n">line_kws</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">line_kws</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">line_kws</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">775</span>     <span class="n">plotter</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">scatter_kws</span><span class="p">,</span> <span class="n">line_kws</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">776</span>     <span class="k">return</span> <span class="n">ax</span>
<span class="g g-Whitespace">    </span><span class="mi">777</span> 

<span class="nn">/usr/local/lib/python3.10/dist-packages/seaborn/regression.py</span> in <span class="ni">plot</span><span class="nt">(self, ax, scatter_kws, line_kws)</span>
<span class="g g-Whitespace">    </span><span class="mi">382</span> 
<span class="g g-Whitespace">    </span><span class="mi">383</span>         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_reg</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">384</span>             <span class="bp">self</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">line_kws</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">385</span> 
<span class="g g-Whitespace">    </span><span class="mi">386</span>         <span class="c1"># Label the axes</span>

<span class="nn">/usr/local/lib/python3.10/dist-packages/seaborn/regression.py</span> in <span class="ni">lineplot</span><span class="nt">(self, ax, kws)</span>
<span class="g g-Whitespace">    </span><span class="mi">427</span><span class="w">         </span><span class="sd">&quot;&quot;&quot;Draw the model.&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">428</span>         <span class="c1"># Fit the regression model</span>
<span class="ne">--&gt; </span><span class="mi">429</span>         <span class="n">grid</span><span class="p">,</span> <span class="n">yhat</span><span class="p">,</span> <span class="n">err_bands</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_regression</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">430</span>         <span class="n">edges</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">grid</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">431</span> 

<span class="nn">/usr/local/lib/python3.10/dist-packages/seaborn/regression.py</span> in <span class="ni">fit_regression</span><span class="nt">(self, ax, x_range, grid)</span>
<span class="g g-Whitespace">    </span><span class="mi">227</span>             <span class="n">yhat</span><span class="p">,</span> <span class="n">yhat_boots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_logx</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">228</span>         <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">229</span>             <span class="n">yhat</span><span class="p">,</span> <span class="n">yhat_boots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_fast</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">230</span> 
<span class="g g-Whitespace">    </span><span class="mi">231</span>         <span class="c1"># Compute the confidence interval at each grid point</span>

<span class="nn">/usr/local/lib/python3.10/dist-packages/seaborn/regression.py</span> in <span class="ni">fit_fast</span><span class="nt">(self, grid)</span>
<span class="g g-Whitespace">    </span><span class="mi">248</span>             <span class="k">return</span> <span class="n">yhat</span><span class="p">,</span> <span class="kc">None</span>
<span class="g g-Whitespace">    </span><span class="mi">249</span> 
<span class="ne">--&gt; </span><span class="mi">250</span>         <span class="n">beta_boots</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">bootstrap</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">251</span>                                     <span class="n">func</span><span class="o">=</span><span class="n">reg_func</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">252</span>                                     <span class="n">n_boot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_boot</span><span class="p">,</span>

<span class="nn">/usr/local/lib/python3.10/dist-packages/seaborn/algorithms.py</span> in <span class="ni">bootstrap</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">98</span>         <span class="n">resampler</span> <span class="o">=</span> <span class="n">integers</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span>  <span class="c1"># intp is indexing dtype</span>
<span class="g g-Whitespace">     </span><span class="mi">99</span>         <span class="n">sample</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">resampler</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
<span class="ne">--&gt; </span><span class="mi">100</span>         <span class="n">boot_dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">sample</span><span class="p">,</span> <span class="o">**</span><span class="n">func_kwargs</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">101</span>     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">boot_dist</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">102</span><span class="w"> </span>

<span class="nn">/usr/local/lib/python3.10/dist-packages/seaborn/regression.py</span> in <span class="ni">reg_func</span><span class="nt">(_x, _y)</span>
<span class="g g-Whitespace">    </span><span class="mi">240</span><span class="w">         </span><span class="sd">&quot;&quot;&quot;Low-level regression and prediction using linear algebra.&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">241</span>         <span class="k">def</span> <span class="nf">reg_func</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">_y</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">242</span>             <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">_x</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">_y</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">243</span> 
<span class="g g-Whitespace">    </span><span class="mi">244</span>         <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>

<span class="nn">/usr/local/lib/python3.10/dist-packages/numpy/linalg/linalg.py</span> in <span class="ni">pinv</span><span class="nt">(a, rcond, hermitian)</span>
<span class="g g-Whitespace">   </span><span class="mi">2020</span>         <span class="k">return</span> <span class="n">wrap</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2021</span>     <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span>
<span class="ne">-&gt; </span><span class="mi">2022</span>     <span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vt</span> <span class="o">=</span> <span class="n">svd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hermitian</span><span class="o">=</span><span class="n">hermitian</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2023</span> 
<span class="g g-Whitespace">   </span><span class="mi">2024</span>     <span class="c1"># discard small singular values</span>

<span class="nn">/usr/local/lib/python3.10/dist-packages/numpy/linalg/linalg.py</span> in <span class="ni">svd</span><span class="nt">(a, full_matrices, compute_uv, hermitian)</span>
<span class="g g-Whitespace">   </span><span class="mi">1679</span> 
<span class="g g-Whitespace">   </span><span class="mi">1680</span>         <span class="n">signature</span> <span class="o">=</span> <span class="s1">&#39;D-&gt;DdD&#39;</span> <span class="k">if</span> <span class="n">isComplexType</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;d-&gt;ddd&#39;</span>
<span class="ne">-&gt; </span><span class="mi">1681</span>         <span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vh</span> <span class="o">=</span> <span class="n">gufunc</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">signature</span><span class="o">=</span><span class="n">signature</span><span class="p">,</span> <span class="n">extobj</span><span class="o">=</span><span class="n">extobj</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1682</span>         <span class="n">u</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">result_t</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1683</span>         <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">_realType</span><span class="p">(</span><span class="n">result_t</span><span class="p">),</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
</section>
<section id="para-el-grupo-delinquency">
<h4>Para el grupo <code class="docutils literal notranslate"><span class="pre">Delinquency</span></code><a class="headerlink" href="#para-el-grupo-delinquency" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>Promedios y dispersión: Muchas variables tienen promedios cercanos a valores bajos (alrededor de 0.1 a 0.5), pero las desviaciones estándar varían significativamente entre las columnas, lo que sugiere niveles de dispersión diferentes en los datos. Algunas variables, como <code class="docutils literal notranslate"><span class="pre">D_61</span></code> y <code class="docutils literal notranslate"><span class="pre">D_65</span></code>, tienen desviaciones estándar extremadamente altas, lo que indica una gran variabilidad en esos campos.</p></li>
<li><p>Distribuciones asimétricas: Muchas de las variables presentan una alta asimetría (skewness), con valores de simetría que van desde positivos moderados hasta extremadamente altos, como en el caso de <code class="docutils literal notranslate"><span class="pre">D_65</span></code>, que muestra una asimetría de 259.7, lo que sugiere que los valores están concentrados en un extremo del rango. También hay variables con simetría negativa, como D_121, lo que indica una distribución asimétrica hacia el otro lado.</p></li>
<li><p>Curtosis elevada: La curtosis (kurtosis) es bastante alta en muchas variables, especialmente en <code class="docutils literal notranslate"><span class="pre">D_65</span></code> y <code class="docutils literal notranslate"><span class="pre">D_69</span></code>, que muestran valores extremadamente elevados (259.7 y 727.6 respectivamente), lo que sugiere la presencia de valores atípicos extremos o distribuciones con colas más pesadas.</p></li>
<li><p>Outliers: Los valores máximos en muchas de las variables son bastante grandes comparados con el percentil 75, lo que indica la presencia de valores atípicos significativos. Esto es especialmente evidente en <code class="docutils literal notranslate"><span class="pre">D_69</span></code> y D_65, que tienen máximos muy superiores a los valores típicos.</p></li>
<li><p>Varianza: La varianza es baja en muchas de las variables, lo que indica una baja dispersión de los datos. Sin embargo, algunas variables como D_61 y <code class="docutils literal notranslate"><span class="pre">D_69</span></code> muestran una varianza considerablemente alta, lo que coincide con la alta desviación estándar observada.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">skew</span><span class="p">,</span> <span class="n">kurtosis</span>

<span class="c1"># Seleccionar solo las columnas numéricas del DataFrame</span>
<span class="n">numerical_data</span> <span class="o">=</span> <span class="n">delinquency_imputed_pd</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span>

<span class="c1"># Calcular estadísticas básicas</span>
<span class="n">basic_stats</span> <span class="o">=</span> <span class="n">numerical_data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># Transponer para mejor visualización</span>

<span class="c1"># Calcular la simetría (skewness) y curtosis</span>
<span class="n">basic_stats</span><span class="p">[</span><span class="s1">&#39;Skewness&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numerical_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">skew</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dropna</span><span class="p">()))</span>
<span class="n">basic_stats</span><span class="p">[</span><span class="s1">&#39;Kurtosis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numerical_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">kurtosis</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">fisher</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="c1"># Añadir la varianza</span>
<span class="n">basic_stats</span><span class="p">[</span><span class="s1">&#39;Variance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numerical_data</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
<span class="n">styled_basic_stats</span> <span class="o">=</span> <span class="n">basic_stats</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># Format to 2 decimal places</span>
<span class="n">display</span><span class="p">(</span><span class="n">styled_basic_stats</span><span class="p">)</span> <span class="c1"># Display using IPython&#39;s display function</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_2c0a8" class="dataframe">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_2c0a8_level0_col0" class="col_heading level0 col0" >count</th>
      <th id="T_2c0a8_level0_col1" class="col_heading level0 col1" >mean</th>
      <th id="T_2c0a8_level0_col2" class="col_heading level0 col2" >std</th>
      <th id="T_2c0a8_level0_col3" class="col_heading level0 col3" >min</th>
      <th id="T_2c0a8_level0_col4" class="col_heading level0 col4" >25%</th>
      <th id="T_2c0a8_level0_col5" class="col_heading level0 col5" >50%</th>
      <th id="T_2c0a8_level0_col6" class="col_heading level0 col6" >75%</th>
      <th id="T_2c0a8_level0_col7" class="col_heading level0 col7" >max</th>
      <th id="T_2c0a8_level0_col8" class="col_heading level0 col8" >Skewness</th>
      <th id="T_2c0a8_level0_col9" class="col_heading level0 col9" >Kurtosis</th>
      <th id="T_2c0a8_level0_col10" class="col_heading level0 col10" >Variance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_2c0a8_level0_row0" class="row_heading level0 row0" >D_105</th>
      <td id="T_2c0a8_row0_col0" class="data row0 col0" >5531451.0000</td>
      <td id="T_2c0a8_row0_col1" class="data row0 col1" >0.3503</td>
      <td id="T_2c0a8_row0_col2" class="data row0 col2" >0.1697</td>
      <td id="T_2c0a8_row0_col3" class="data row0 col3" >-0.0264</td>
      <td id="T_2c0a8_row0_col4" class="data row0 col4" >0.3338</td>
      <td id="T_2c0a8_row0_col5" class="data row0 col5" >0.3338</td>
      <td id="T_2c0a8_row0_col6" class="data row0 col6" >0.3338</td>
      <td id="T_2c0a8_row0_col7" class="data row0 col7" >5.6317</td>
      <td id="T_2c0a8_row0_col8" class="data row0 col8" >1.7111</td>
      <td id="T_2c0a8_row0_col9" class="data row0 col9" >15.3702</td>
      <td id="T_2c0a8_row0_col10" class="data row0 col10" >0.0288</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row1" class="row_heading level0 row1" >D_56</th>
      <td id="T_2c0a8_row1_col0" class="data row1 col0" >5531451.0000</td>
      <td id="T_2c0a8_row1_col1" class="data row1 col1" >0.1744</td>
      <td id="T_2c0a8_row1_col2" class="data row1 col2" >0.1463</td>
      <td id="T_2c0a8_row1_col3" class="data row1 col3" >-0.0171</td>
      <td id="T_2c0a8_row1_col4" class="data row1 col4" >0.1494</td>
      <td id="T_2c0a8_row1_col5" class="data row1 col5" >0.1494</td>
      <td id="T_2c0a8_row1_col6" class="data row1 col6" >0.1494</td>
      <td id="T_2c0a8_row1_col7" class="data row1 col7" >10.9565</td>
      <td id="T_2c0a8_row1_col8" class="data row1 col8" >10.2488</td>
      <td id="T_2c0a8_row1_col9" class="data row1 col9" >327.6714</td>
      <td id="T_2c0a8_row1_col10" class="data row1 col10" >0.0214</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row2" class="row_heading level0 row2" >D_77</th>
      <td id="T_2c0a8_row2_col0" class="data row2 col0" >5531451.0000</td>
      <td id="T_2c0a8_row2_col1" class="data row2 col1" >0.2335</td>
      <td id="T_2c0a8_row2_col2" class="data row2 col2" >0.1737</td>
      <td id="T_2c0a8_row2_col3" class="data row2 col3" >0.0000</td>
      <td id="T_2c0a8_row2_col4" class="data row2 col4" >0.1901</td>
      <td id="T_2c0a8_row2_col5" class="data row2 col5" >0.2058</td>
      <td id="T_2c0a8_row2_col6" class="data row2 col6" >0.2255</td>
      <td id="T_2c0a8_row2_col7" class="data row2 col7" >10.2292</td>
      <td id="T_2c0a8_row2_col8" class="data row2 col8" >4.5103</td>
      <td id="T_2c0a8_row2_col9" class="data row2 col9" >98.7803</td>
      <td id="T_2c0a8_row2_col10" class="data row2 col10" >0.0302</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row3" class="row_heading level0 row3" >D_43</th>
      <td id="T_2c0a8_row3_col0" class="data row3 col0" >5531451.0000</td>
      <td id="T_2c0a8_row3_col1" class="data row3 col1" >0.1348</td>
      <td id="T_2c0a8_row3_col2" class="data row3 col2" >0.1811</td>
      <td id="T_2c0a8_row3_col3" class="data row3 col3" >0.0000</td>
      <td id="T_2c0a8_row3_col4" class="data row3 col4" >0.0590</td>
      <td id="T_2c0a8_row3_col5" class="data row3 col5" >0.0885</td>
      <td id="T_2c0a8_row3_col6" class="data row3 col6" >0.1323</td>
      <td id="T_2c0a8_row3_col7" class="data row3 col7" >10.1116</td>
      <td id="T_2c0a8_row3_col8" class="data row3 col8" >6.7743</td>
      <td id="T_2c0a8_row3_col9" class="data row3 col9" >107.1508</td>
      <td id="T_2c0a8_row3_col10" class="data row3 col10" >0.0328</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row4" class="row_heading level0 row4" >D_46</th>
      <td id="T_2c0a8_row4_col0" class="data row4 col0" >5531451.0000</td>
      <td id="T_2c0a8_row4_col1" class="data row4 col1" >0.4720</td>
      <td id="T_2c0a8_row4_col2" class="data row4 col2" >0.1503</td>
      <td id="T_2c0a8_row4_col3" class="data row4 col3" >-17.2893</td>
      <td id="T_2c0a8_row4_col4" class="data row4 col4" >0.4374</td>
      <td id="T_2c0a8_row4_col5" class="data row4 col5" >0.4597</td>
      <td id="T_2c0a8_row4_col6" class="data row4 col6" >0.4947</td>
      <td id="T_2c0a8_row4_col7" class="data row4 col7" >16.3199</td>
      <td id="T_2c0a8_row4_col8" class="data row4 col8" >0.8947</td>
      <td id="T_2c0a8_row4_col9" class="data row4 col9" >183.1399</td>
      <td id="T_2c0a8_row4_col10" class="data row4 col10" >0.0226</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row5" class="row_heading level0 row5" >D_62</th>
      <td id="T_2c0a8_row5_col0" class="data row5 col0" >5531451.0000</td>
      <td id="T_2c0a8_row5_col1" class="data row5 col1" >0.1775</td>
      <td id="T_2c0a8_row5_col2" class="data row5 col2" >0.2164</td>
      <td id="T_2c0a8_row5_col3" class="data row5 col3" >-0.0028</td>
      <td id="T_2c0a8_row5_col4" class="data row5 col4" >0.0373</td>
      <td id="T_2c0a8_row5_col5" class="data row5 col5" >0.0944</td>
      <td id="T_2c0a8_row5_col6" class="data row5 col6" >0.2418</td>
      <td id="T_2c0a8_row5_col7" class="data row5 col7" >11.1010</td>
      <td id="T_2c0a8_row5_col8" class="data row5 col8" >3.6786</td>
      <td id="T_2c0a8_row5_col9" class="data row5 col9" >61.3478</td>
      <td id="T_2c0a8_row5_col10" class="data row5 col10" >0.0468</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row6" class="row_heading level0 row6" >D_48</th>
      <td id="T_2c0a8_row6_col0" class="data row6 col0" >5531451.0000</td>
      <td id="T_2c0a8_row6_col1" class="data row6 col1" >0.3692</td>
      <td id="T_2c0a8_row6_col2" class="data row6 col2" >0.3062</td>
      <td id="T_2c0a8_row6_col3" class="data row6 col3" >-0.0096</td>
      <td id="T_2c0a8_row6_col4" class="data row6 col4" >0.0992</td>
      <td id="T_2c0a8_row6_col5" class="data row6 col5" >0.2862</td>
      <td id="T_2c0a8_row6_col6" class="data row6 col6" >0.6073</td>
      <td id="T_2c0a8_row6_col7" class="data row6 col7" >8.9714</td>
      <td id="T_2c0a8_row6_col8" class="data row6 col8" >0.7378</td>
      <td id="T_2c0a8_row6_col9" class="data row6 col9" >3.8186</td>
      <td id="T_2c0a8_row6_col10" class="data row6 col10" >0.0938</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row7" class="row_heading level0 row7" >D_61</th>
      <td id="T_2c0a8_row7_col0" class="data row7 col0" >5531451.0000</td>
      <td id="T_2c0a8_row7_col1" class="data row7 col1" >0.4234</td>
      <td id="T_2c0a8_row7_col2" class="data row7 col2" >0.4957</td>
      <td id="T_2c0a8_row7_col3" class="data row7 col3" >-0.0093</td>
      <td id="T_2c0a8_row7_col4" class="data row7 col4" >0.1114</td>
      <td id="T_2c0a8_row7_col5" class="data row7 col5" >0.3723</td>
      <td id="T_2c0a8_row7_col6" class="data row7 col6" >0.7353</td>
      <td id="T_2c0a8_row7_col7" class="data row7 col7" >868.5154</td>
      <td id="T_2c0a8_row7_col8" class="data row7 col8" >972.8685</td>
      <td id="T_2c0a8_row7_col9" class="data row7 col9" >1700776.7572</td>
      <td id="T_2c0a8_row7_col10" class="data row7 col10" >0.2457</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row8" class="row_heading level0 row8" >D_78</th>
      <td id="T_2c0a8_row8_col0" class="data row8 col0" >5531451.0000</td>
      <td id="T_2c0a8_row8_col1" class="data row8 col1" >0.0598</td>
      <td id="T_2c0a8_row8_col2" class="data row8 col2" >0.2531</td>
      <td id="T_2c0a8_row8_col3" class="data row8 col3" >0.0000</td>
      <td id="T_2c0a8_row8_col4" class="data row8 col4" >0.0028</td>
      <td id="T_2c0a8_row8_col5" class="data row8 col5" >0.0054</td>
      <td id="T_2c0a8_row8_col6" class="data row8 col6" >0.0080</td>
      <td id="T_2c0a8_row8_col7" class="data row8 col7" >16.0086</td>
      <td id="T_2c0a8_row8_col8" class="data row8 col8" >7.9309</td>
      <td id="T_2c0a8_row8_col9" class="data row8 col9" >103.3908</td>
      <td id="T_2c0a8_row8_col10" class="data row8 col10" >0.0641</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row9" class="row_heading level0 row9" >D_44</th>
      <td id="T_2c0a8_row9_col0" class="data row9 col0" >5531451.0000</td>
      <td id="T_2c0a8_row9_col1" class="data row9 col1" >0.1129</td>
      <td id="T_2c0a8_row9_col2" class="data row9 col2" >0.2171</td>
      <td id="T_2c0a8_row9_col3" class="data row9 col3" >0.0000</td>
      <td id="T_2c0a8_row9_col4" class="data row9 col4" >0.0040</td>
      <td id="T_2c0a8_row9_col5" class="data row9 col5" >0.0077</td>
      <td id="T_2c0a8_row9_col6" class="data row9 col6" >0.1310</td>
      <td id="T_2c0a8_row9_col7" class="data row9 col7" >5.6347</td>
      <td id="T_2c0a8_row9_col8" class="data row9 col8" >3.1445</td>
      <td id="T_2c0a8_row9_col9" class="data row9 col9" >17.4498</td>
      <td id="T_2c0a8_row9_col10" class="data row9 col10" >0.0471</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row10" class="row_heading level0 row10" >D_83</th>
      <td id="T_2c0a8_row10_col0" class="data row10 col0" >5531451.0000</td>
      <td id="T_2c0a8_row10_col1" class="data row10 col1" >0.0397</td>
      <td id="T_2c0a8_row10_col2" class="data row10 col2" >0.3006</td>
      <td id="T_2c0a8_row10_col3" class="data row10 col3" >0.0000</td>
      <td id="T_2c0a8_row10_col4" class="data row10 col4" >0.0027</td>
      <td id="T_2c0a8_row10_col5" class="data row10 col5" >0.0051</td>
      <td id="T_2c0a8_row10_col6" class="data row10 col6" >0.0076</td>
      <td id="T_2c0a8_row10_col7" class="data row10 col7" >38.0075</td>
      <td id="T_2c0a8_row10_col8" class="data row10 col8" >22.4792</td>
      <td id="T_2c0a8_row10_col9" class="data row10 col9" >1183.9706</td>
      <td id="T_2c0a8_row10_col10" class="data row10 col10" >0.0904</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row11" class="row_heading level0 row11" >D_69</th>
      <td id="T_2c0a8_row11_col0" class="data row11 col0" >5531451.0000</td>
      <td id="T_2c0a8_row11_col1" class="data row11 col1" >0.1488</td>
      <td id="T_2c0a8_row11_col2" class="data row11 col2" >15.7257</td>
      <td id="T_2c0a8_row11_col3" class="data row11 col3" >0.0000</td>
      <td id="T_2c0a8_row11_col4" class="data row11 col4" >0.0027</td>
      <td id="T_2c0a8_row11_col5" class="data row11 col5" >0.0052</td>
      <td id="T_2c0a8_row11_col6" class="data row11 col6" >0.0077</td>
      <td id="T_2c0a8_row11_col7" class="data row11 col7" >13000.9093</td>
      <td id="T_2c0a8_row11_col8" class="data row11 col8" >727.5641</td>
      <td id="T_2c0a8_row11_col9" class="data row11 col9" >593255.5620</td>
      <td id="T_2c0a8_row11_col10" class="data row11 col10" >247.2986</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row12" class="row_heading level0 row12" >D_55</th>
      <td id="T_2c0a8_row12_col0" class="data row12 col0" >5531451.0000</td>
      <td id="T_2c0a8_row12_col1" class="data row12 col1" >0.2942</td>
      <td id="T_2c0a8_row12_col2" class="data row12 col2" >0.2846</td>
      <td id="T_2c0a8_row12_col3" class="data row12 col3" >0.0000</td>
      <td id="T_2c0a8_row12_col4" class="data row12 col4" >0.0597</td>
      <td id="T_2c0a8_row12_col5" class="data row12 col5" >0.1817</td>
      <td id="T_2c0a8_row12_col6" class="data row12 col6" >0.4872</td>
      <td id="T_2c0a8_row12_col7" class="data row12 col7" >2.7678</td>
      <td id="T_2c0a8_row12_col8" class="data row12 col8" >0.9402</td>
      <td id="T_2c0a8_row12_col9" class="data row12 col9" >2.7235</td>
      <td id="T_2c0a8_row12_col10" class="data row12 col10" >0.0810</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row13" class="row_heading level0 row13" >D_124</th>
      <td id="T_2c0a8_row13_col0" class="data row13 col0" >5531451.0000</td>
      <td id="T_2c0a8_row13_col1" class="data row13 col1" >0.3045</td>
      <td id="T_2c0a8_row13_col2" class="data row13 col2" >0.2226</td>
      <td id="T_2c0a8_row13_col3" class="data row13 col3" >-0.0455</td>
      <td id="T_2c0a8_row13_col4" class="data row13 col4" >0.1414</td>
      <td id="T_2c0a8_row13_col5" class="data row13 col5" >0.2742</td>
      <td id="T_2c0a8_row13_col6" class="data row13 col6" >0.4151</td>
      <td id="T_2c0a8_row13_col7" class="data row13 col7" >9.0943</td>
      <td id="T_2c0a8_row13_col8" class="data row13 col8" >1.2830</td>
      <td id="T_2c0a8_row13_col9" class="data row13 col9" >6.8375</td>
      <td id="T_2c0a8_row13_col10" class="data row13 col10" >0.0495</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row14" class="row_heading level0 row14" >D_119</th>
      <td id="T_2c0a8_row14_col0" class="data row14 col0" >5531451.0000</td>
      <td id="T_2c0a8_row14_col1" class="data row14 col1" >0.2773</td>
      <td id="T_2c0a8_row14_col2" class="data row14 col2" >0.2526</td>
      <td id="T_2c0a8_row14_col3" class="data row14 col3" >0.0000</td>
      <td id="T_2c0a8_row14_col4" class="data row14 col4" >0.0617</td>
      <td id="T_2c0a8_row14_col5" class="data row14 col5" >0.2134</td>
      <td id="T_2c0a8_row14_col6" class="data row14 col6" >0.4286</td>
      <td id="T_2c0a8_row14_col7" class="data row14 col7" >1.9770</td>
      <td id="T_2c0a8_row14_col8" class="data row14 col8" >1.0599</td>
      <td id="T_2c0a8_row14_col9" class="data row14 col9" >3.7815</td>
      <td id="T_2c0a8_row14_col10" class="data row14 col10" >0.0638</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row15" class="row_heading level0 row15" >D_118</th>
      <td id="T_2c0a8_row15_col0" class="data row15 col0" >5531451.0000</td>
      <td id="T_2c0a8_row15_col1" class="data row15 col1" >0.2815</td>
      <td id="T_2c0a8_row15_col2" class="data row15 col2" >0.2521</td>
      <td id="T_2c0a8_row15_col3" class="data row15 col3" >0.0000</td>
      <td id="T_2c0a8_row15_col4" class="data row15 col4" >0.0659</td>
      <td id="T_2c0a8_row15_col5" class="data row15 col5" >0.2205</td>
      <td id="T_2c0a8_row15_col6" class="data row15 col6" >0.4333</td>
      <td id="T_2c0a8_row15_col7" class="data row15 col7" >1.9709</td>
      <td id="T_2c0a8_row15_col8" class="data row15 col8" >1.0382</td>
      <td id="T_2c0a8_row15_col9" class="data row15 col9" >3.7372</td>
      <td id="T_2c0a8_row15_col10" class="data row15 col10" >0.0635</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row16" class="row_heading level0 row16" >D_115</th>
      <td id="T_2c0a8_row16_col0" class="data row16 col0" >5531451.0000</td>
      <td id="T_2c0a8_row16_col1" class="data row16 col1" >0.2756</td>
      <td id="T_2c0a8_row16_col2" class="data row16 col2" >0.2525</td>
      <td id="T_2c0a8_row16_col3" class="data row16 col3" >0.0000</td>
      <td id="T_2c0a8_row16_col4" class="data row16 col4" >0.0655</td>
      <td id="T_2c0a8_row16_col5" class="data row16 col5" >0.1991</td>
      <td id="T_2c0a8_row16_col6" class="data row16 col6" >0.4251</td>
      <td id="T_2c0a8_row16_col7" class="data row16 col7" >1.9995</td>
      <td id="T_2c0a8_row16_col8" class="data row16 col8" >1.1191</td>
      <td id="T_2c0a8_row16_col9" class="data row16 col9" >3.8744</td>
      <td id="T_2c0a8_row16_col10" class="data row16 col10" >0.0637</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row17" class="row_heading level0 row17" >D_113</th>
      <td id="T_2c0a8_row17_col0" class="data row17 col0" >5531451.0000</td>
      <td id="T_2c0a8_row17_col1" class="data row17 col1" >0.1522</td>
      <td id="T_2c0a8_row17_col2" class="data row17 col2" >0.2245</td>
      <td id="T_2c0a8_row17_col3" class="data row17 col3" >0.0000</td>
      <td id="T_2c0a8_row17_col4" class="data row17 col4" >0.0045</td>
      <td id="T_2c0a8_row17_col5" class="data row17 col5" >0.0087</td>
      <td id="T_2c0a8_row17_col6" class="data row17 col6" >0.2074</td>
      <td id="T_2c0a8_row17_col7" class="data row17 col7" >25.0076</td>
      <td id="T_2c0a8_row17_col8" class="data row17 col8" >2.7008</td>
      <td id="T_2c0a8_row17_col9" class="data row17 col9" >91.8958</td>
      <td id="T_2c0a8_row17_col10" class="data row17 col10" >0.0504</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row18" class="row_heading level0 row18" >D_125</th>
      <td id="T_2c0a8_row18_col0" class="data row18 col0" >5531451.0000</td>
      <td id="T_2c0a8_row18_col1" class="data row18 col1" >0.0818</td>
      <td id="T_2c0a8_row18_col2" class="data row18 col2" >0.2879</td>
      <td id="T_2c0a8_row18_col3" class="data row18 col3" >0.0000</td>
      <td id="T_2c0a8_row18_col4" class="data row18 col4" >0.0028</td>
      <td id="T_2c0a8_row18_col5" class="data row18 col5" >0.0054</td>
      <td id="T_2c0a8_row18_col6" class="data row18 col6" >0.0080</td>
      <td id="T_2c0a8_row18_col7" class="data row18 col7" >14.0085</td>
      <td id="T_2c0a8_row18_col8" class="data row18 col8" >4.1383</td>
      <td id="T_2c0a8_row18_col9" class="data row18 col9" >26.8952</td>
      <td id="T_2c0a8_row18_col10" class="data row18 col10" >0.0829</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row19" class="row_heading level0 row19" >D_121</th>
      <td id="T_2c0a8_row19_col0" class="data row19 col0" >5531451.0000</td>
      <td id="T_2c0a8_row19_col1" class="data row19 col1" >0.5343</td>
      <td id="T_2c0a8_row19_col2" class="data row19 col2" >0.2303</td>
      <td id="T_2c0a8_row19_col3" class="data row19 col3" >-0.0321</td>
      <td id="T_2c0a8_row19_col4" class="data row19 col4" >0.3627</td>
      <td id="T_2c0a8_row19_col5" class="data row19 col5" >0.5954</td>
      <td id="T_2c0a8_row19_col6" class="data row19 col6" >0.7125</td>
      <td id="T_2c0a8_row19_col7" class="data row19 col7" >1.7911</td>
      <td id="T_2c0a8_row19_col8" class="data row19 col8" >-0.4200</td>
      <td id="T_2c0a8_row19_col9" class="data row19 col9" >2.7442</td>
      <td id="T_2c0a8_row19_col10" class="data row19 col10" >0.0530</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row20" class="row_heading level0 row20" >D_122</th>
      <td id="T_2c0a8_row20_col0" class="data row20 col0" >5531451.0000</td>
      <td id="T_2c0a8_row20_col1" class="data row20 col1" >0.4052</td>
      <td id="T_2c0a8_row20_col2" class="data row20 col2" >0.2331</td>
      <td id="T_2c0a8_row20_col3" class="data row20 col3" >0.0000</td>
      <td id="T_2c0a8_row20_col4" class="data row20 col4" >0.1518</td>
      <td id="T_2c0a8_row20_col5" class="data row20 col5" >0.4292</td>
      <td id="T_2c0a8_row20_col6" class="data row20 col6" >0.5756</td>
      <td id="T_2c0a8_row20_col7" class="data row20 col7" >2.0093</td>
      <td id="T_2c0a8_row20_col8" class="data row20 col8" >0.7153</td>
      <td id="T_2c0a8_row20_col9" class="data row20 col9" >3.2621</td>
      <td id="T_2c0a8_row20_col10" class="data row20 col10" >0.0544</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row21" class="row_heading level0 row21" >D_123</th>
      <td id="T_2c0a8_row21_col0" class="data row21 col0" >5531451.0000</td>
      <td id="T_2c0a8_row21_col1" class="data row21 col1" >0.0491</td>
      <td id="T_2c0a8_row21_col2" class="data row21 col2" >0.2418</td>
      <td id="T_2c0a8_row21_col3" class="data row21 col3" >0.0000</td>
      <td id="T_2c0a8_row21_col4" class="data row21 col4" >0.0027</td>
      <td id="T_2c0a8_row21_col5" class="data row21 col5" >0.0052</td>
      <td id="T_2c0a8_row21_col6" class="data row21 col6" >0.0078</td>
      <td id="T_2c0a8_row21_col7" class="data row21 col7" >104.0062</td>
      <td id="T_2c0a8_row21_col8" class="data row21 col8" >101.6785</td>
      <td id="T_2c0a8_row21_col9" class="data row21 col9" >38439.1430</td>
      <td id="T_2c0a8_row21_col10" class="data row21 col10" >0.0585</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row22" class="row_heading level0 row22" >D_91</th>
      <td id="T_2c0a8_row22_col0" class="data row22 col0" >5531451.0000</td>
      <td id="T_2c0a8_row22_col1" class="data row22 col1" >0.0606</td>
      <td id="T_2c0a8_row22_col2" class="data row22 col2" >0.1840</td>
      <td id="T_2c0a8_row22_col3" class="data row22 col3" >0.0000</td>
      <td id="T_2c0a8_row22_col4" class="data row22 col4" >0.0029</td>
      <td id="T_2c0a8_row22_col5" class="data row22 col5" >0.0055</td>
      <td id="T_2c0a8_row22_col6" class="data row22 col6" >0.0082</td>
      <td id="T_2c0a8_row22_col7" class="data row22 col7" >3.0097</td>
      <td id="T_2c0a8_row22_col8" class="data row22 col8" >3.8302</td>
      <td id="T_2c0a8_row22_col9" class="data row22 col9" >20.6877</td>
      <td id="T_2c0a8_row22_col10" class="data row22 col10" >0.0339</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row23" class="row_heading level0 row23" >D_59</th>
      <td id="T_2c0a8_row23_col0" class="data row23 col0" >5531451.0000</td>
      <td id="T_2c0a8_row23_col1" class="data row23 col1" >0.3627</td>
      <td id="T_2c0a8_row23_col2" class="data row23 col2" >0.1913</td>
      <td id="T_2c0a8_row23_col3" class="data row23 col3" >-0.1024</td>
      <td id="T_2c0a8_row23_col4" class="data row23 col4" >0.2361</td>
      <td id="T_2c0a8_row23_col5" class="data row23 col5" >0.3784</td>
      <td id="T_2c0a8_row23_col6" class="data row23 col6" >0.4672</td>
      <td id="T_2c0a8_row23_col7" class="data row23 col7" >2.1533</td>
      <td id="T_2c0a8_row23_col8" class="data row23 col8" >0.9144</td>
      <td id="T_2c0a8_row23_col9" class="data row23 col9" >6.4234</td>
      <td id="T_2c0a8_row23_col10" class="data row23 col10" >0.0366</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row24" class="row_heading level0 row24" >D_141</th>
      <td id="T_2c0a8_row24_col0" class="data row24 col0" >5531451.0000</td>
      <td id="T_2c0a8_row24_col1" class="data row24 col1" >0.1616</td>
      <td id="T_2c0a8_row24_col2" class="data row24 col2" >0.3457</td>
      <td id="T_2c0a8_row24_col3" class="data row24 col3" >0.0000</td>
      <td id="T_2c0a8_row24_col4" class="data row24 col4" >0.0031</td>
      <td id="T_2c0a8_row24_col5" class="data row24 col5" >0.0061</td>
      <td id="T_2c0a8_row24_col6" class="data row24 col6" >0.0090</td>
      <td id="T_2c0a8_row24_col7" class="data row24 col7" >1.3399</td>
      <td id="T_2c0a8_row24_col8" class="data row24 col8" >1.7643</td>
      <td id="T_2c0a8_row24_col9" class="data row24 col9" >4.1400</td>
      <td id="T_2c0a8_row24_col10" class="data row24 col10" >0.1195</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row25" class="row_heading level0 row25" >D_131</th>
      <td id="T_2c0a8_row25_col0" class="data row25 col0" >5531451.0000</td>
      <td id="T_2c0a8_row25_col1" class="data row25 col1" >0.1016</td>
      <td id="T_2c0a8_row25_col2" class="data row25 col2" >0.2929</td>
      <td id="T_2c0a8_row25_col3" class="data row25 col3" >0.0000</td>
      <td id="T_2c0a8_row25_col4" class="data row25 col4" >0.0028</td>
      <td id="T_2c0a8_row25_col5" class="data row25 col5" >0.0056</td>
      <td id="T_2c0a8_row25_col6" class="data row25 col6" >0.0083</td>
      <td id="T_2c0a8_row25_col7" class="data row25 col7" >1.4916</td>
      <td id="T_2c0a8_row25_col8" class="data row25 col8" >2.7046</td>
      <td id="T_2c0a8_row25_col9" class="data row25 col9" >8.3226</td>
      <td id="T_2c0a8_row25_col10" class="data row25 col10" >0.0858</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row26" class="row_heading level0 row26" >D_139</th>
      <td id="T_2c0a8_row26_col0" class="data row26 col0" >5531451.0000</td>
      <td id="T_2c0a8_row26_col1" class="data row26 col1" >0.1758</td>
      <td id="T_2c0a8_row26_col2" class="data row26 col2" >0.3763</td>
      <td id="T_2c0a8_row26_col3" class="data row26 col3" >0.0000</td>
      <td id="T_2c0a8_row26_col4" class="data row26 col4" >0.0031</td>
      <td id="T_2c0a8_row26_col5" class="data row26 col5" >0.0061</td>
      <td id="T_2c0a8_row26_col6" class="data row26 col6" >0.0090</td>
      <td id="T_2c0a8_row26_col7" class="data row26 col7" >1.0100</td>
      <td id="T_2c0a8_row26_col8" class="data row26 col8" >1.7500</td>
      <td id="T_2c0a8_row26_col9" class="data row26 col9" >4.0628</td>
      <td id="T_2c0a8_row26_col10" class="data row26 col10" >0.1416</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row27" class="row_heading level0 row27" >D_145</th>
      <td id="T_2c0a8_row27_col0" class="data row27 col0" >5531451.0000</td>
      <td id="T_2c0a8_row27_col1" class="data row27 col1" >0.0613</td>
      <td id="T_2c0a8_row27_col2" class="data row27 col2" >0.1919</td>
      <td id="T_2c0a8_row27_col3" class="data row27 col3" >0.0000</td>
      <td id="T_2c0a8_row27_col4" class="data row27 col4" >0.0031</td>
      <td id="T_2c0a8_row27_col5" class="data row27 col5" >0.0061</td>
      <td id="T_2c0a8_row27_col6" class="data row27 col6" >0.0090</td>
      <td id="T_2c0a8_row27_col7" class="data row27 col7" >4.8276</td>
      <td id="T_2c0a8_row27_col8" class="data row27 col8" >5.5938</td>
      <td id="T_2c0a8_row27_col9" class="data row27 col9" >45.7236</td>
      <td id="T_2c0a8_row27_col10" class="data row27 col10" >0.0368</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row28" class="row_heading level0 row28" >D_130</th>
      <td id="T_2c0a8_row28_col0" class="data row28 col0" >5531451.0000</td>
      <td id="T_2c0a8_row28_col1" class="data row28 col1" >0.1981</td>
      <td id="T_2c0a8_row28_col2" class="data row28 col2" >0.3947</td>
      <td id="T_2c0a8_row28_col3" class="data row28 col3" >0.0000</td>
      <td id="T_2c0a8_row28_col4" class="data row28 col4" >0.0032</td>
      <td id="T_2c0a8_row28_col5" class="data row28 col5" >0.0062</td>
      <td id="T_2c0a8_row28_col6" class="data row28 col6" >0.0093</td>
      <td id="T_2c0a8_row28_col7" class="data row28 col7" >1.0280</td>
      <td id="T_2c0a8_row28_col8" class="data row28 col8" >1.5553</td>
      <td id="T_2c0a8_row28_col9" class="data row28 col9" >3.4193</td>
      <td id="T_2c0a8_row28_col10" class="data row28 col10" >0.1558</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row29" class="row_heading level0 row29" >D_129</th>
      <td id="T_2c0a8_row29_col0" class="data row29 col0" >5531451.0000</td>
      <td id="T_2c0a8_row29_col1" class="data row29 col1" >0.4320</td>
      <td id="T_2c0a8_row29_col2" class="data row29 col2" >0.4946</td>
      <td id="T_2c0a8_row29_col3" class="data row29 col3" >0.0000</td>
      <td id="T_2c0a8_row29_col4" class="data row29 col4" >0.0045</td>
      <td id="T_2c0a8_row29_col5" class="data row29 col5" >0.0089</td>
      <td id="T_2c0a8_row29_col6" class="data row29 col6" >1.0041</td>
      <td id="T_2c0a8_row29_col7" class="data row29 col7" >1.0100</td>
      <td id="T_2c0a8_row29_col8" class="data row29 col8" >0.2953</td>
      <td id="T_2c0a8_row29_col9" class="data row29 col9" >1.0873</td>
      <td id="T_2c0a8_row29_col10" class="data row29 col10" >0.2446</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row30" class="row_heading level0 row30" >D_103</th>
      <td id="T_2c0a8_row30_col0" class="data row30 col0" >5531451.0000</td>
      <td id="T_2c0a8_row30_col1" class="data row30 col1" >0.4589</td>
      <td id="T_2c0a8_row30_col2" class="data row30 col2" >0.4978</td>
      <td id="T_2c0a8_row30_col3" class="data row30 col3" >0.0000</td>
      <td id="T_2c0a8_row30_col4" class="data row30 col4" >0.0047</td>
      <td id="T_2c0a8_row30_col5" class="data row30 col5" >0.0093</td>
      <td id="T_2c0a8_row30_col6" class="data row30 col6" >1.0045</td>
      <td id="T_2c0a8_row30_col7" class="data row30 col7" >1.0100</td>
      <td id="T_2c0a8_row30_col8" class="data row30 col8" >0.1857</td>
      <td id="T_2c0a8_row30_col9" class="data row30 col9" >1.0346</td>
      <td id="T_2c0a8_row30_col10" class="data row30 col10" >0.2478</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row31" class="row_heading level0 row31" >D_107</th>
      <td id="T_2c0a8_row31_col0" class="data row31 col0" >5531451.0000</td>
      <td id="T_2c0a8_row31_col1" class="data row31 col1" >0.2033</td>
      <td id="T_2c0a8_row31_col2" class="data row31 col2" >0.2563</td>
      <td id="T_2c0a8_row31_col3" class="data row31 col3" >0.0000</td>
      <td id="T_2c0a8_row31_col4" class="data row31 col4" >0.0047</td>
      <td id="T_2c0a8_row31_col5" class="data row31 col5" >0.0093</td>
      <td id="T_2c0a8_row31_col6" class="data row31 col6" >0.3393</td>
      <td id="T_2c0a8_row31_col7" class="data row31 col7" >7.0090</td>
      <td id="T_2c0a8_row31_col8" class="data row31 col8" >1.5006</td>
      <td id="T_2c0a8_row31_col9" class="data row31 col9" >8.0094</td>
      <td id="T_2c0a8_row31_col10" class="data row31 col10" >0.0657</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row32" class="row_heading level0 row32" >D_104</th>
      <td id="T_2c0a8_row32_col0" class="data row32 col0" >5531451.0000</td>
      <td id="T_2c0a8_row32_col1" class="data row32 col1" >0.4425</td>
      <td id="T_2c0a8_row32_col2" class="data row32 col2" >0.4800</td>
      <td id="T_2c0a8_row32_col3" class="data row32 col3" >0.0000</td>
      <td id="T_2c0a8_row32_col4" class="data row32 col4" >0.0047</td>
      <td id="T_2c0a8_row32_col5" class="data row32 col5" >0.0093</td>
      <td id="T_2c0a8_row32_col6" class="data row32 col6" >0.9641</td>
      <td id="T_2c0a8_row32_col7" class="data row32 col7" >1.3030</td>
      <td id="T_2c0a8_row32_col8" class="data row32 col8" >0.1870</td>
      <td id="T_2c0a8_row32_col9" class="data row32 col9" >1.0369</td>
      <td id="T_2c0a8_row32_col10" class="data row32 col10" >0.2304</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row33" class="row_heading level0 row33" >D_143</th>
      <td id="T_2c0a8_row33_col0" class="data row33 col0" >5531451.0000</td>
      <td id="T_2c0a8_row33_col1" class="data row33 col1" >0.1756</td>
      <td id="T_2c0a8_row33_col2" class="data row33 col2" >0.3762</td>
      <td id="T_2c0a8_row33_col3" class="data row33 col3" >0.0000</td>
      <td id="T_2c0a8_row33_col4" class="data row33 col4" >0.0031</td>
      <td id="T_2c0a8_row33_col5" class="data row33 col5" >0.0061</td>
      <td id="T_2c0a8_row33_col6" class="data row33 col6" >0.0090</td>
      <td id="T_2c0a8_row33_col7" class="data row33 col7" >1.0100</td>
      <td id="T_2c0a8_row33_col8" class="data row33 col8" >1.7511</td>
      <td id="T_2c0a8_row33_col9" class="data row33 col9" >4.0669</td>
      <td id="T_2c0a8_row33_col10" class="data row33 col10" >0.1415</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row34" class="row_heading level0 row34" >D_128</th>
      <td id="T_2c0a8_row34_col0" class="data row34 col0" >5531451.0000</td>
      <td id="T_2c0a8_row34_col1" class="data row34 col1" >0.5918</td>
      <td id="T_2c0a8_row34_col2" class="data row34 col2" >0.4918</td>
      <td id="T_2c0a8_row34_col3" class="data row34 col3" >0.0000</td>
      <td id="T_2c0a8_row34_col4" class="data row34 col4" >0.0061</td>
      <td id="T_2c0a8_row34_col5" class="data row34 col5" >1.0004</td>
      <td id="T_2c0a8_row34_col6" class="data row34 col6" >1.0047</td>
      <td id="T_2c0a8_row34_col7" class="data row34 col7" >1.0235</td>
      <td id="T_2c0a8_row34_col8" class="data row34 col8" >-0.3550</td>
      <td id="T_2c0a8_row34_col9" class="data row34 col9" >1.1262</td>
      <td id="T_2c0a8_row34_col10" class="data row34 col10" >0.2419</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row35" class="row_heading level0 row35" >D_70</th>
      <td id="T_2c0a8_row35_col0" class="data row35 col0" >5531451.0000</td>
      <td id="T_2c0a8_row35_col1" class="data row35 col1" >0.1088</td>
      <td id="T_2c0a8_row35_col2" class="data row35 col2" >0.2262</td>
      <td id="T_2c0a8_row35_col3" class="data row35 col3" >0.0000</td>
      <td id="T_2c0a8_row35_col4" class="data row35 col4" >0.0035</td>
      <td id="T_2c0a8_row35_col5" class="data row35 col5" >0.0068</td>
      <td id="T_2c0a8_row35_col6" class="data row35 col6" >0.2505</td>
      <td id="T_2c0a8_row35_col7" class="data row35 col7" >7.0046</td>
      <td id="T_2c0a8_row35_col8" class="data row35 col8" >3.6801</td>
      <td id="T_2c0a8_row35_col9" class="data row35 col9" >26.5606</td>
      <td id="T_2c0a8_row35_col10" class="data row35 col10" >0.0512</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row36" class="row_heading level0 row36" >D_79</th>
      <td id="T_2c0a8_row36_col0" class="data row36 col0" >5531451.0000</td>
      <td id="T_2c0a8_row36_col1" class="data row36 col1" >0.0683</td>
      <td id="T_2c0a8_row36_col2" class="data row36 col2" >0.2187</td>
      <td id="T_2c0a8_row36_col3" class="data row36 col3" >0.0000</td>
      <td id="T_2c0a8_row36_col4" class="data row36 col4" >0.0028</td>
      <td id="T_2c0a8_row36_col5" class="data row36 col5" >0.0056</td>
      <td id="T_2c0a8_row36_col6" class="data row36 col6" >0.0083</td>
      <td id="T_2c0a8_row36_col7" class="data row36 col7" >18.0069</td>
      <td id="T_2c0a8_row36_col8" class="data row36 col8" >5.5603</td>
      <td id="T_2c0a8_row36_col9" class="data row36 col9" >80.2889</td>
      <td id="T_2c0a8_row36_col10" class="data row36 col10" >0.0478</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row37" class="row_heading level0 row37" >D_133</th>
      <td id="T_2c0a8_row37_col0" class="data row37 col0" >5531451.0000</td>
      <td id="T_2c0a8_row37_col1" class="data row37 col1" >0.0458</td>
      <td id="T_2c0a8_row37_col2" class="data row37 col2" >0.1715</td>
      <td id="T_2c0a8_row37_col3" class="data row37 col3" >0.0000</td>
      <td id="T_2c0a8_row37_col4" class="data row37 col4" >0.0027</td>
      <td id="T_2c0a8_row37_col5" class="data row37 col5" >0.0054</td>
      <td id="T_2c0a8_row37_col6" class="data row37 col6" >0.0081</td>
      <td id="T_2c0a8_row37_col7" class="data row37 col7" >1.5100</td>
      <td id="T_2c0a8_row37_col8" class="data row37 col8" >5.1954</td>
      <td id="T_2c0a8_row37_col9" class="data row37 col9" >32.9145</td>
      <td id="T_2c0a8_row37_col10" class="data row37 col10" >0.0294</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row38" class="row_heading level0 row38" >D_144</th>
      <td id="T_2c0a8_row38_col0" class="data row38 col0" >5531451.0000</td>
      <td id="T_2c0a8_row38_col1" class="data row38 col1" >0.0520</td>
      <td id="T_2c0a8_row38_col2" class="data row38 col2" >0.1819</td>
      <td id="T_2c0a8_row38_col3" class="data row38 col3" >0.0000</td>
      <td id="T_2c0a8_row38_col4" class="data row38 col4" >0.0028</td>
      <td id="T_2c0a8_row38_col5" class="data row38 col5" >0.0055</td>
      <td id="T_2c0a8_row38_col6" class="data row38 col6" >0.0082</td>
      <td id="T_2c0a8_row38_col7" class="data row38 col7" >1.3433</td>
      <td id="T_2c0a8_row38_col8" class="data row38 col8" >4.4365</td>
      <td id="T_2c0a8_row38_col9" class="data row38 col9" >23.3052</td>
      <td id="T_2c0a8_row38_col10" class="data row38 col10" >0.0331</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row39" class="row_heading level0 row39" >D_102</th>
      <td id="T_2c0a8_row39_col0" class="data row39 col0" >5531451.0000</td>
      <td id="T_2c0a8_row39_col1" class="data row39 col1" >0.1885</td>
      <td id="T_2c0a8_row39_col2" class="data row39 col2" >0.2742</td>
      <td id="T_2c0a8_row39_col3" class="data row39 col3" >0.0000</td>
      <td id="T_2c0a8_row39_col4" class="data row39 col4" >0.0045</td>
      <td id="T_2c0a8_row39_col5" class="data row39 col5" >0.0089</td>
      <td id="T_2c0a8_row39_col6" class="data row39 col6" >0.3250</td>
      <td id="T_2c0a8_row39_col7" class="data row39 col7" >1.0900</td>
      <td id="T_2c0a8_row39_col8" class="data row39 col8" >1.4249</td>
      <td id="T_2c0a8_row39_col9" class="data row39 col9" >3.9545</td>
      <td id="T_2c0a8_row39_col10" class="data row39 col10" >0.0752</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row40" class="row_heading level0 row40" >D_140</th>
      <td id="T_2c0a8_row40_col0" class="data row40 col0" >5531451.0000</td>
      <td id="T_2c0a8_row40_col1" class="data row40 col1" >0.0265</td>
      <td id="T_2c0a8_row40_col2" class="data row40 col2" >0.1450</td>
      <td id="T_2c0a8_row40_col3" class="data row40 col3" >0.0000</td>
      <td id="T_2c0a8_row40_col4" class="data row40 col4" >0.0026</td>
      <td id="T_2c0a8_row40_col5" class="data row40 col5" >0.0051</td>
      <td id="T_2c0a8_row40_col6" class="data row40 col6" >0.0076</td>
      <td id="T_2c0a8_row40_col7" class="data row40 col7" >1.0100</td>
      <td id="T_2c0a8_row40_col8" class="data row40 col8" >6.5966</td>
      <td id="T_2c0a8_row40_col9" class="data row40 col9" >44.5335</td>
      <td id="T_2c0a8_row40_col10" class="data row40 col10" >0.0210</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row41" class="row_heading level0 row41" >D_84</th>
      <td id="T_2c0a8_row41_col0" class="data row41 col0" >5531451.0000</td>
      <td id="T_2c0a8_row41_col1" class="data row41 col1" >0.0445</td>
      <td id="T_2c0a8_row41_col2" class="data row41 col2" >0.2843</td>
      <td id="T_2c0a8_row41_col3" class="data row41 col3" >0.0000</td>
      <td id="T_2c0a8_row41_col4" class="data row41 col4" >0.0026</td>
      <td id="T_2c0a8_row41_col5" class="data row41 col5" >0.0052</td>
      <td id="T_2c0a8_row41_col6" class="data row41 col6" >0.0078</td>
      <td id="T_2c0a8_row41_col7" class="data row41 col7" >29.0056</td>
      <td id="T_2c0a8_row41_col8" class="data row41 col8" >14.5968</td>
      <td id="T_2c0a8_row41_col9" class="data row41 col9" >345.2075</td>
      <td id="T_2c0a8_row41_col10" class="data row41 col10" >0.0808</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row42" class="row_heading level0 row42" >D_89</th>
      <td id="T_2c0a8_row42_col0" class="data row42 col0" >5531451.0000</td>
      <td id="T_2c0a8_row42_col1" class="data row42 col1" >0.0064</td>
      <td id="T_2c0a8_row42_col2" class="data row42 col2" >0.0190</td>
      <td id="T_2c0a8_row42_col3" class="data row42 col3" >0.0000</td>
      <td id="T_2c0a8_row42_col4" class="data row42 col4" >0.0025</td>
      <td id="T_2c0a8_row42_col5" class="data row42 col5" >0.0050</td>
      <td id="T_2c0a8_row42_col6" class="data row42 col6" >0.0076</td>
      <td id="T_2c0a8_row42_col7" class="data row42 col7" >1.0100</td>
      <td id="T_2c0a8_row42_col8" class="data row42 col8" >21.2082</td>
      <td id="T_2c0a8_row42_col9" class="data row42 col9" >673.2204</td>
      <td id="T_2c0a8_row42_col10" class="data row42 col10" >0.0004</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row43" class="row_heading level0 row43" >D_52</th>
      <td id="T_2c0a8_row43_col0" class="data row43 col0" >5531451.0000</td>
      <td id="T_2c0a8_row43_col1" class="data row43 col1" >0.1799</td>
      <td id="T_2c0a8_row43_col2" class="data row43 col2" >0.1734</td>
      <td id="T_2c0a8_row43_col3" class="data row43 col3" >-0.0071</td>
      <td id="T_2c0a8_row43_col4" class="data row43 col4" >0.0742</td>
      <td id="T_2c0a8_row43_col5" class="data row43 col5" >0.1444</td>
      <td id="T_2c0a8_row43_col6" class="data row43 col6" >0.2323</td>
      <td id="T_2c0a8_row43_col7" class="data row43 col7" >1.0100</td>
      <td id="T_2c0a8_row43_col8" class="data row43 col8" >2.9124</td>
      <td id="T_2c0a8_row43_col9" class="data row43 col9" >13.8289</td>
      <td id="T_2c0a8_row43_col10" class="data row43 col10" >0.0301</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row44" class="row_heading level0 row44" >D_81</th>
      <td id="T_2c0a8_row44_col0" class="data row44 col0" >5531451.0000</td>
      <td id="T_2c0a8_row44_col1" class="data row44 col1" >0.0547</td>
      <td id="T_2c0a8_row44_col2" class="data row44 col2" >0.3392</td>
      <td id="T_2c0a8_row44_col3" class="data row44 col3" >0.0000</td>
      <td id="T_2c0a8_row44_col4" class="data row44 col4" >0.0026</td>
      <td id="T_2c0a8_row44_col5" class="data row44 col5" >0.0052</td>
      <td id="T_2c0a8_row44_col6" class="data row44 col6" >0.0077</td>
      <td id="T_2c0a8_row44_col7" class="data row44 col7" >8.0100</td>
      <td id="T_2c0a8_row44_col8" class="data row44 col8" >10.7255</td>
      <td id="T_2c0a8_row44_col9" class="data row44 col9" >156.8032</td>
      <td id="T_2c0a8_row44_col10" class="data row44 col10" >0.1151</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row45" class="row_heading level0 row45" >D_72</th>
      <td id="T_2c0a8_row45_col0" class="data row45 col0" >5531451.0000</td>
      <td id="T_2c0a8_row45_col1" class="data row45 col1" >0.0374</td>
      <td id="T_2c0a8_row45_col2" class="data row45 col2" >0.2025</td>
      <td id="T_2c0a8_row45_col3" class="data row45 col3" >0.0000</td>
      <td id="T_2c0a8_row45_col4" class="data row45 col4" >0.0026</td>
      <td id="T_2c0a8_row45_col5" class="data row45 col5" >0.0053</td>
      <td id="T_2c0a8_row45_col6" class="data row45 col6" >0.0079</td>
      <td id="T_2c0a8_row45_col7" class="data row45 col7" >3.0100</td>
      <td id="T_2c0a8_row45_col8" class="data row45 col8" >9.7497</td>
      <td id="T_2c0a8_row45_col9" class="data row45 col9" >117.3571</td>
      <td id="T_2c0a8_row45_col10" class="data row45 col10" >0.0410</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row46" class="row_heading level0 row46" >D_74</th>
      <td id="T_2c0a8_row46_col0" class="data row46 col0" >5531451.0000</td>
      <td id="T_2c0a8_row46_col1" class="data row46 col1" >0.1532</td>
      <td id="T_2c0a8_row46_col2" class="data row46 col2" >0.2188</td>
      <td id="T_2c0a8_row46_col3" class="data row46 col3" >0.0000</td>
      <td id="T_2c0a8_row46_col4" class="data row46 col4" >0.0059</td>
      <td id="T_2c0a8_row46_col5" class="data row46 col5" >0.0757</td>
      <td id="T_2c0a8_row46_col6" class="data row46 col6" >0.2193</td>
      <td id="T_2c0a8_row46_col7" class="data row46 col7" >4.5091</td>
      <td id="T_2c0a8_row46_col8" class="data row46 col8" >2.5869</td>
      <td id="T_2c0a8_row46_col9" class="data row46 col9" >13.4012</td>
      <td id="T_2c0a8_row46_col10" class="data row46 col10" >0.0479</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row47" class="row_heading level0 row47" >D_80</th>
      <td id="T_2c0a8_row47_col0" class="data row47 col0" >5531451.0000</td>
      <td id="T_2c0a8_row47_col1" class="data row47 col1" >0.1116</td>
      <td id="T_2c0a8_row47_col2" class="data row47 col2" >0.2144</td>
      <td id="T_2c0a8_row47_col3" class="data row47 col3" >0.0000</td>
      <td id="T_2c0a8_row47_col4" class="data row47 col4" >0.0036</td>
      <td id="T_2c0a8_row47_col5" class="data row47 col5" >0.0072</td>
      <td id="T_2c0a8_row47_col6" class="data row47 col6" >0.2031</td>
      <td id="T_2c0a8_row47_col7" class="data row47 col7" >8.0098</td>
      <td id="T_2c0a8_row47_col8" class="data row47 col8" >3.6885</td>
      <td id="T_2c0a8_row47_col9" class="data row47 col9" >29.4726</td>
      <td id="T_2c0a8_row47_col10" class="data row47 col10" >0.0460</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row48" class="row_heading level0 row48" >D_112</th>
      <td id="T_2c0a8_row48_col0" class="data row48 col0" >5531451.0000</td>
      <td id="T_2c0a8_row48_col1" class="data row48 col1" >0.8411</td>
      <td id="T_2c0a8_row48_col2" class="data row48 col2" >0.3693</td>
      <td id="T_2c0a8_row48_col3" class="data row48 col3" >0.0000</td>
      <td id="T_2c0a8_row48_col4" class="data row48 col4" >1.0010</td>
      <td id="T_2c0a8_row48_col5" class="data row48 col5" >1.0040</td>
      <td id="T_2c0a8_row48_col6" class="data row48 col6" >1.0070</td>
      <td id="T_2c0a8_row48_col7" class="data row48 col7" >1.0100</td>
      <td id="T_2c0a8_row48_col8" class="data row48 col8" >-1.8099</td>
      <td id="T_2c0a8_row48_col9" class="data row48 col9" >4.2762</td>
      <td id="T_2c0a8_row48_col10" class="data row48 col10" >0.1364</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row49" class="row_heading level0 row49" >D_45</th>
      <td id="T_2c0a8_row49_col0" class="data row49 col0" >5531451.0000</td>
      <td id="T_2c0a8_row49_col1" class="data row49 col1" >0.2522</td>
      <td id="T_2c0a8_row49_col2" class="data row49 col2" >0.2426</td>
      <td id="T_2c0a8_row49_col3" class="data row49 col3" >0.0000</td>
      <td id="T_2c0a8_row49_col4" class="data row49 col4" >0.0546</td>
      <td id="T_2c0a8_row49_col5" class="data row49 col5" >0.1808</td>
      <td id="T_2c0a8_row49_col6" class="data row49 col6" >0.3732</td>
      <td id="T_2c0a8_row49_col7" class="data row49 col7" >1.6100</td>
      <td id="T_2c0a8_row49_col8" class="data row49 col8" >1.3135</td>
      <td id="T_2c0a8_row49_col9" class="data row49 col9" >4.5956</td>
      <td id="T_2c0a8_row49_col10" class="data row49 col10" >0.0589</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row50" class="row_heading level0 row50" >D_54</th>
      <td id="T_2c0a8_row50_col0" class="data row50 col0" >5531451.0000</td>
      <td id="T_2c0a8_row50_col1" class="data row50 col1" >0.9846</td>
      <td id="T_2c0a8_row50_col2" class="data row50 col2" >0.1411</td>
      <td id="T_2c0a8_row50_col3" class="data row50 col3" >-0.0020</td>
      <td id="T_2c0a8_row50_col4" class="data row50 col4" >1.0023</td>
      <td id="T_2c0a8_row50_col5" class="data row50 col5" >1.0049</td>
      <td id="T_2c0a8_row50_col6" class="data row50 col6" >1.0074</td>
      <td id="T_2c0a8_row50_col7" class="data row50 col7" >1.0100</td>
      <td id="T_2c0a8_row50_col8" class="data row50 col8" >-6.7823</td>
      <td id="T_2c0a8_row50_col9" class="data row50 col9" >47.0222</td>
      <td id="T_2c0a8_row50_col10" class="data row50 col10" >0.0199</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row51" class="row_heading level0 row51" >D_41</th>
      <td id="T_2c0a8_row51_col0" class="data row51 col0" >5531451.0000</td>
      <td id="T_2c0a8_row51_col1" class="data row51 col1" >0.0598</td>
      <td id="T_2c0a8_row51_col2" class="data row51 col2" >0.2025</td>
      <td id="T_2c0a8_row51_col3" class="data row51 col3" >0.0000</td>
      <td id="T_2c0a8_row51_col4" class="data row51 col4" >0.0029</td>
      <td id="T_2c0a8_row51_col5" class="data row51 col5" >0.0057</td>
      <td id="T_2c0a8_row51_col6" class="data row51 col6" >0.0086</td>
      <td id="T_2c0a8_row51_col7" class="data row51 col7" >8.9888</td>
      <td id="T_2c0a8_row51_col8" class="data row51 col8" >6.5896</td>
      <td id="T_2c0a8_row51_col9" class="data row51 col9" >72.1184</td>
      <td id="T_2c0a8_row51_col10" class="data row51 col10" >0.0410</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row52" class="row_heading level0 row52" >D_109</th>
      <td id="T_2c0a8_row52_col0" class="data row52 col0" >5531451.0000</td>
      <td id="T_2c0a8_row52_col1" class="data row52 col1" >0.0067</td>
      <td id="T_2c0a8_row52_col2" class="data row52 col2" >0.0408</td>
      <td id="T_2c0a8_row52_col3" class="data row52 col3" >0.0000</td>
      <td id="T_2c0a8_row52_col4" class="data row52 col4" >0.0025</td>
      <td id="T_2c0a8_row52_col5" class="data row52 col5" >0.0050</td>
      <td id="T_2c0a8_row52_col6" class="data row52 col6" >0.0075</td>
      <td id="T_2c0a8_row52_col7" class="data row52 col7" >1.0100</td>
      <td id="T_2c0a8_row52_col8" class="data row52 col8" >24.3062</td>
      <td id="T_2c0a8_row52_col9" class="data row52 col9" >594.7845</td>
      <td id="T_2c0a8_row52_col10" class="data row52 col10" >0.0017</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row53" class="row_heading level0 row53" >D_47</th>
      <td id="T_2c0a8_row53_col0" class="data row53 col0" >5531451.0000</td>
      <td id="T_2c0a8_row53_col1" class="data row53 col1" >0.4071</td>
      <td id="T_2c0a8_row53_col2" class="data row53 col2" >0.2348</td>
      <td id="T_2c0a8_row53_col3" class="data row53 col3" >-0.0266</td>
      <td id="T_2c0a8_row53_col4" class="data row53 col4" >0.2324</td>
      <td id="T_2c0a8_row53_col5" class="data row53 col5" >0.3832</td>
      <td id="T_2c0a8_row53_col6" class="data row53 col6" >0.5615</td>
      <td id="T_2c0a8_row53_col7" class="data row53 col7" >1.6431</td>
      <td id="T_2c0a8_row53_col8" class="data row53 col8" >0.4818</td>
      <td id="T_2c0a8_row53_col9" class="data row53 col9" >2.8152</td>
      <td id="T_2c0a8_row53_col10" class="data row53 col10" >0.0551</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row54" class="row_heading level0 row54" >D_127</th>
      <td id="T_2c0a8_row54_col0" class="data row54 col0" >5531451.0000</td>
      <td id="T_2c0a8_row54_col1" class="data row54 col1" >0.1075</td>
      <td id="T_2c0a8_row54_col2" class="data row54 col2" >0.3034</td>
      <td id="T_2c0a8_row54_col3" class="data row54 col3" >0.0000</td>
      <td id="T_2c0a8_row54_col4" class="data row54 col4" >0.0028</td>
      <td id="T_2c0a8_row54_col5" class="data row54 col5" >0.0056</td>
      <td id="T_2c0a8_row54_col6" class="data row54 col6" >0.0084</td>
      <td id="T_2c0a8_row54_col7" class="data row54 col7" >1.0100</td>
      <td id="T_2c0a8_row54_col8" class="data row54 col8" >2.6199</td>
      <td id="T_2c0a8_row54_col9" class="data row54 col9" >7.8650</td>
      <td id="T_2c0a8_row54_col10" class="data row54 col10" >0.0920</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row55" class="row_heading level0 row55" >D_92</th>
      <td id="T_2c0a8_row55_col0" class="data row55 col0" >5531451.0000</td>
      <td id="T_2c0a8_row55_col1" class="data row55 col1" >0.0910</td>
      <td id="T_2c0a8_row55_col2" class="data row55 col2" >0.2936</td>
      <td id="T_2c0a8_row55_col3" class="data row55 col3" >0.0000</td>
      <td id="T_2c0a8_row55_col4" class="data row55 col4" >0.0027</td>
      <td id="T_2c0a8_row55_col5" class="data row55 col5" >0.0054</td>
      <td id="T_2c0a8_row55_col6" class="data row55 col6" >0.0082</td>
      <td id="T_2c0a8_row55_col7" class="data row55 col7" >2.0100</td>
      <td id="T_2c0a8_row55_col8" class="data row55 col8" >3.3930</td>
      <td id="T_2c0a8_row55_col9" class="data row55 col9" >14.2183</td>
      <td id="T_2c0a8_row55_col10" class="data row55 col10" >0.0862</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row56" class="row_heading level0 row56" >D_93</th>
      <td id="T_2c0a8_row56_col0" class="data row56 col0" >5531451.0000</td>
      <td id="T_2c0a8_row56_col1" class="data row56 col1" >0.0151</td>
      <td id="T_2c0a8_row56_col2" class="data row56 col2" >0.1001</td>
      <td id="T_2c0a8_row56_col3" class="data row56 col3" >0.0000</td>
      <td id="T_2c0a8_row56_col4" class="data row56 col4" >0.0025</td>
      <td id="T_2c0a8_row56_col5" class="data row56 col5" >0.0051</td>
      <td id="T_2c0a8_row56_col6" class="data row56 col6" >0.0076</td>
      <td id="T_2c0a8_row56_col7" class="data row56 col7" >1.0100</td>
      <td id="T_2c0a8_row56_col8" class="data row56 col8" >9.7840</td>
      <td id="T_2c0a8_row56_col9" class="data row56 col9" >96.8100</td>
      <td id="T_2c0a8_row56_col10" class="data row56 col10" >0.0100</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row57" class="row_heading level0 row57" >D_94</th>
      <td id="T_2c0a8_row57_col0" class="data row57 col0" >5531451.0000</td>
      <td id="T_2c0a8_row57_col1" class="data row57 col1" >0.0223</td>
      <td id="T_2c0a8_row57_col2" class="data row57 col2" >0.1303</td>
      <td id="T_2c0a8_row57_col3" class="data row57 col3" >0.0000</td>
      <td id="T_2c0a8_row57_col4" class="data row57 col4" >0.0025</td>
      <td id="T_2c0a8_row57_col5" class="data row57 col5" >0.0051</td>
      <td id="T_2c0a8_row57_col6" class="data row57 col6" >0.0076</td>
      <td id="T_2c0a8_row57_col7" class="data row57 col7" >1.0100</td>
      <td id="T_2c0a8_row57_col8" class="data row57 col8" >7.4050</td>
      <td id="T_2c0a8_row57_col9" class="data row57 col9" >55.8630</td>
      <td id="T_2c0a8_row57_col10" class="data row57 col10" >0.0170</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row58" class="row_heading level0 row58" >D_65</th>
      <td id="T_2c0a8_row58_col0" class="data row58 col0" >5531451.0000</td>
      <td id="T_2c0a8_row58_col1" class="data row58 col1" >0.0398</td>
      <td id="T_2c0a8_row58_col2" class="data row58 col2" >0.4731</td>
      <td id="T_2c0a8_row58_col3" class="data row58 col3" >0.0000</td>
      <td id="T_2c0a8_row58_col4" class="data row58 col4" >0.0026</td>
      <td id="T_2c0a8_row58_col5" class="data row58 col5" >0.0052</td>
      <td id="T_2c0a8_row58_col6" class="data row58 col6" >0.0078</td>
      <td id="T_2c0a8_row58_col7" class="data row58 col7" >385.9016</td>
      <td id="T_2c0a8_row58_col8" class="data row58 col8" >259.7272</td>
      <td id="T_2c0a8_row58_col9" class="data row58 col9" >152078.2734</td>
      <td id="T_2c0a8_row58_col10" class="data row58 col10" >0.2238</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row59" class="row_heading level0 row59" >D_86</th>
      <td id="T_2c0a8_row59_col0" class="data row59 col0" >5531451.0000</td>
      <td id="T_2c0a8_row59_col1" class="data row59 col1" >0.0375</td>
      <td id="T_2c0a8_row59_col2" class="data row59 col2" >0.1773</td>
      <td id="T_2c0a8_row59_col3" class="data row59 col3" >0.0000</td>
      <td id="T_2c0a8_row59_col4" class="data row59 col4" >0.0026</td>
      <td id="T_2c0a8_row59_col5" class="data row59 col5" >0.0052</td>
      <td id="T_2c0a8_row59_col6" class="data row59 col6" >0.0078</td>
      <td id="T_2c0a8_row59_col7" class="data row59 col7" >1.0100</td>
      <td id="T_2c0a8_row59_col8" class="data row59 col8" >5.2709</td>
      <td id="T_2c0a8_row59_col9" class="data row59 col9" >28.7912</td>
      <td id="T_2c0a8_row59_col10" class="data row59 col10" >0.0314</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row60" class="row_heading level0 row60" >D_96</th>
      <td id="T_2c0a8_row60_col0" class="data row60 col0" >5531451.0000</td>
      <td id="T_2c0a8_row60_col1" class="data row60 col1" >0.0357</td>
      <td id="T_2c0a8_row60_col2" class="data row60 col2" >0.1726</td>
      <td id="T_2c0a8_row60_col3" class="data row60 col3" >0.0000</td>
      <td id="T_2c0a8_row60_col4" class="data row60 col4" >0.0026</td>
      <td id="T_2c0a8_row60_col5" class="data row60 col5" >0.0052</td>
      <td id="T_2c0a8_row60_col6" class="data row60 col6" >0.0077</td>
      <td id="T_2c0a8_row60_col7" class="data row60 col7" >1.0100</td>
      <td id="T_2c0a8_row60_col8" class="data row60 col8" >5.4368</td>
      <td id="T_2c0a8_row60_col9" class="data row60 col9" >30.5682</td>
      <td id="T_2c0a8_row60_col10" class="data row60 col10" >0.0298</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row61" class="row_heading level0 row61" >D_58</th>
      <td id="T_2c0a8_row61_col0" class="data row61 col0" >5531451.0000</td>
      <td id="T_2c0a8_row61_col1" class="data row61 col1" >0.2155</td>
      <td id="T_2c0a8_row61_col2" class="data row61 col2" >0.2604</td>
      <td id="T_2c0a8_row61_col3" class="data row61 col3" >0.0000</td>
      <td id="T_2c0a8_row61_col4" class="data row61 col4" >0.0059</td>
      <td id="T_2c0a8_row61_col5" class="data row61 col5" >0.1066</td>
      <td id="T_2c0a8_row61_col6" class="data row61 col6" >0.3727</td>
      <td id="T_2c0a8_row61_col7" class="data row61 col7" >1.2619</td>
      <td id="T_2c0a8_row61_col8" class="data row61 col8" >1.2248</td>
      <td id="T_2c0a8_row61_col9" class="data row61 col9" >3.7605</td>
      <td id="T_2c0a8_row61_col10" class="data row61 col10" >0.0678</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row62" class="row_heading level0 row62" >D_60</th>
      <td id="T_2c0a8_row62_col0" class="data row62 col0" >5531451.0000</td>
      <td id="T_2c0a8_row62_col1" class="data row62 col1" >0.3762</td>
      <td id="T_2c0a8_row62_col2" class="data row62 col2" >0.3718</td>
      <td id="T_2c0a8_row62_col3" class="data row62 col3" >0.0000</td>
      <td id="T_2c0a8_row62_col4" class="data row62 col4" >0.0323</td>
      <td id="T_2c0a8_row62_col5" class="data row62 col5" >0.2353</td>
      <td id="T_2c0a8_row62_col6" class="data row62 col6" >0.7037</td>
      <td id="T_2c0a8_row62_col7" class="data row62 col7" >1.0100</td>
      <td id="T_2c0a8_row62_col8" class="data row62 col8" >0.6203</td>
      <td id="T_2c0a8_row62_col9" class="data row62 col9" >1.8410</td>
      <td id="T_2c0a8_row62_col10" class="data row62 col10" >0.1383</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row63" class="row_heading level0 row63" >D_51</th>
      <td id="T_2c0a8_row63_col0" class="data row63 col0" >5531451.0000</td>
      <td id="T_2c0a8_row63_col1" class="data row63 col1" >0.1451</td>
      <td id="T_2c0a8_row63_col2" class="data row63 col2" >0.2423</td>
      <td id="T_2c0a8_row63_col3" class="data row63 col3" >0.0000</td>
      <td id="T_2c0a8_row63_col4" class="data row63 col4" >0.0036</td>
      <td id="T_2c0a8_row63_col5" class="data row63 col5" >0.0073</td>
      <td id="T_2c0a8_row63_col6" class="data row63 col6" >0.3360</td>
      <td id="T_2c0a8_row63_col7" class="data row63 col7" >2.6766</td>
      <td id="T_2c0a8_row63_col8" class="data row63 col8" >2.0831</td>
      <td id="T_2c0a8_row63_col9" class="data row63 col9" >8.3845</td>
      <td id="T_2c0a8_row63_col10" class="data row63 col10" >0.0587</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row64" class="row_heading level0 row64" >D_75</th>
      <td id="T_2c0a8_row64_col0" class="data row64 col0" >5531451.0000</td>
      <td id="T_2c0a8_row64_col1" class="data row64 col1" >0.1712</td>
      <td id="T_2c0a8_row64_col2" class="data row64 col2" >0.2242</td>
      <td id="T_2c0a8_row64_col3" class="data row64 col3" >0.0000</td>
      <td id="T_2c0a8_row64_col4" class="data row64 col4" >0.0067</td>
      <td id="T_2c0a8_row64_col5" class="data row64 col5" >0.0744</td>
      <td id="T_2c0a8_row64_col6" class="data row64 col6" >0.2689</td>
      <td id="T_2c0a8_row64_col7" class="data row64 col7" >4.2751</td>
      <td id="T_2c0a8_row64_col8" class="data row64 col8" >2.2848</td>
      <td id="T_2c0a8_row64_col9" class="data row64 col9" >11.1243</td>
      <td id="T_2c0a8_row64_col10" class="data row64 col10" >0.0503</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row65" class="row_heading level0 row65" >D_71</th>
      <td id="T_2c0a8_row65_col0" class="data row65 col0" >5531451.0000</td>
      <td id="T_2c0a8_row65_col1" class="data row65 col1" >0.0708</td>
      <td id="T_2c0a8_row65_col2" class="data row65 col2" >0.3260</td>
      <td id="T_2c0a8_row65_col3" class="data row65 col3" >0.0000</td>
      <td id="T_2c0a8_row65_col4" class="data row65 col4" >0.0086</td>
      <td id="T_2c0a8_row65_col5" class="data row65 col5" >0.0128</td>
      <td id="T_2c0a8_row65_col6" class="data row65 col6" >0.0312</td>
      <td id="T_2c0a8_row65_col7" class="data row65 col7" >67.0323</td>
      <td id="T_2c0a8_row65_col8" class="data row65 col8" >46.8523</td>
      <td id="T_2c0a8_row65_col9" class="data row65 col9" >5460.5231</td>
      <td id="T_2c0a8_row65_col10" class="data row65 col10" >0.1063</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row66" class="row_heading level0 row66" >D_39</th>
      <td id="T_2c0a8_row66_col0" class="data row66 col0" >5531451.0000</td>
      <td id="T_2c0a8_row66_col1" class="data row66 col1" >0.1531</td>
      <td id="T_2c0a8_row66_col2" class="data row66 col2" >0.2701</td>
      <td id="T_2c0a8_row66_col3" class="data row66 col3" >0.0000</td>
      <td id="T_2c0a8_row66_col4" class="data row66 col4" >0.0045</td>
      <td id="T_2c0a8_row66_col5" class="data row66 col5" >0.0091</td>
      <td id="T_2c0a8_row66_col6" class="data row66 col6" >0.2366</td>
      <td id="T_2c0a8_row66_col7" class="data row66 col7" >5.3896</td>
      <td id="T_2c0a8_row66_col8" class="data row66 col8" >3.3737</td>
      <td id="T_2c0a8_row66_col9" class="data row66 col9" >24.4374</td>
      <td id="T_2c0a8_row66_col10" class="data row66 col10" >0.0729</td>
    </tr>
    <tr>
      <th id="T_2c0a8_level0_row67" class="row_heading level0 row67" >target</th>
      <td id="T_2c0a8_row67_col0" class="data row67 col0" >5531451.0000</td>
      <td id="T_2c0a8_row67_col1" class="data row67 col1" >0.2491</td>
      <td id="T_2c0a8_row67_col2" class="data row67 col2" >0.4325</td>
      <td id="T_2c0a8_row67_col3" class="data row67 col3" >0.0000</td>
      <td id="T_2c0a8_row67_col4" class="data row67 col4" >0.0000</td>
      <td id="T_2c0a8_row67_col5" class="data row67 col5" >0.0000</td>
      <td id="T_2c0a8_row67_col6" class="data row67 col6" >0.0000</td>
      <td id="T_2c0a8_row67_col7" class="data row67 col7" >1.0000</td>
      <td id="T_2c0a8_row67_col8" class="data row67 col8" >1.1603</td>
      <td id="T_2c0a8_row67_col9" class="data row67 col9" >2.3462</td>
      <td id="T_2c0a8_row67_col10" class="data row67 col10" >0.1870</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>ScatterPlot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Lista de las variables de Delinquency para las que quieres hacer scatterplots</span>
<span class="n">delinquency_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;D_1&#39;</span><span class="p">,</span> <span class="s1">&#39;D_2&#39;</span><span class="p">,</span> <span class="s1">&#39;D_3&#39;</span><span class="p">,</span> <span class="s1">&#39;D_4&#39;</span><span class="p">]</span>  <span class="c1"># Cambia estas columnas según tu data</span>

<span class="c1"># Crear una figura con 2 filas y 2 columnas</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># Lista de los nombres de las variables para los títulos</span>
<span class="n">delinquency_titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;D_1&#39;</span><span class="p">,</span> <span class="s1">&#39;D_2&#39;</span><span class="p">,</span> <span class="s1">&#39;D_3&#39;</span><span class="p">,</span> <span class="s1">&#39;D_4&#39;</span><span class="p">]</span>

<span class="c1"># Iterar sobre las columnas y los ejes para crear los scatterplots</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">delinquency_columns</span><span class="p">):</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">col_idx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">delinquency_imputed_pd</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">delinquency_imputed_pd</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Scatterplot: </span><span class="si">{</span><span class="n">delinquency_titles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1"> vs target&#39;</span><span class="p">)</span>

<span class="c1"># Ajustar el layout</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Mostrar el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="windspeedEDA.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Velocidad del viento</p>
      </div>
    </a>
    <a class="right-next"
       href="Ejercicio3.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Ejercicio 3</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Parcial práctico 2 Machine Learning</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#henry-saenz-kelly-beltran">Henry Saenz &amp; Kelly Beltrán</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-descriptivo-de-default-probability-prediction">Análisis descriptivo de <code class="docutils literal notranslate"><span class="pre">Default</span> <span class="pre">Probability</span> <span class="pre">Prediction</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importacion-de-librerias">Importación de librerías</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#carga-de-archivos">Carga de archivos</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-exploratorio-de-los-datos-eda">Análisis Exploratorio de los Datos (EDA)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cambiar-nombre">Cambiar nombre</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#concatenar-conjuntos-de-datos">Concatenar conjuntos de datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-datos-faltantes">Anàlisis de datos faltantes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#identificar-variables-con-ausencia-de-datos-superior-a-50">Identificar variables con ausencia de datos superior a 50%</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matriz-de-datos-faltantes-por-grupo">Matriz de datos faltantes por grupo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#top-10-variables-faltantes-por-grupo">Top 10 Variables faltantes por grupo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-dentro-del-grupo">Comparación dentro del grupo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-de-normalidad">Prueba de normalidad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-entre-grupos">Comparación entre grupos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#test-de-kruskal-wallis-para-diferencia-entre-grupos"><strong>Test de Kruskal-Wallis para diferencia entre grupos</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tratamiento-de-datos-faltantes-por-grupo">Tratamiento de datos faltantes por grupo</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imputacion-de-datos-faltantes">Imputaciòn de datos faltantes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#identificar-variables-categoricas-previo-a-la-imputacion-de-datos">Identificar variables categóricas previo a la imputación de datos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#imputacion-de-datos-categoricos">Imputacion de datos categoricos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#imputacion-de-variables-numericas">Imputación de variables numéricas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inputacion-de-datos-numericos">Inputacion de datos numericos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verificacion-de-multicolinealidad"><strong>Verificación de multicolinealidad</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#correlaciones-entre-variables"><em><strong>Correlaciones entre variables</strong></em></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#correlaciones-numericas">Correlaciones numéricas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#vif-factor-de-inflacion-de-la-varianza">VIF - Factor de inflación de la varianza</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Verificación de multicolinealidad</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-exploratorio-de-los-datos">Análisis Exploratorio de los datos</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-descriptiva">Visualización descriptiva</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variable-objetivo">Variable Objetivo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-predictoras-numericas">Variables predictoras numéricas</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#para-el-grupo-payment">Para el grupo <code class="docutils literal notranslate"><span class="pre">Payment</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#para-el-grupo-spend">Para el grupo <code class="docutils literal notranslate"><span class="pre">spend</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#para-el-grupo-risk">Para el grupo <code class="docutils literal notranslate"><span class="pre">Risk</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#para-el-grupo-balance">Para el grupo <code class="docutils literal notranslate"><span class="pre">Balance</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#para-el-grupo-delinquency">Para el grupo <code class="docutils literal notranslate"><span class="pre">Delinquency</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kelly Beltran y Henry Saenz
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>